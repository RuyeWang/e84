\documentstyle[12pt]{article}
\usepackage{html}
\textwidth 6.0in
\topmargin -0.5in
\oddsidemargin -0in
\evensidemargin -0.5in
% \usepackage{graphics}  
\begin{document}


Given 
\begin{equation}
  \frac{1}{\infty}=0
\end{equation}
prove
\begin{equation}
  \frac{1}{0}=\infty
\end{equation}
{\bf Proof:}
\begin{enumerate}
\item Rotate counterclockwise both sides of Eq. (1) by $90^\circ$
  to get $-18=0$.
\item Add $8$ on both sides to get $-10=8$.
\item Rotate clockwise both sides by $90^\circ$ to get Eq. (2)
\end{enumerate}
Q.E.D.

\section*{Chapter 3: AC Circuit Analysis}

\subsection*{Sinusoidal Functions}

Sinusoidal variables are of special importance in electrical and 
electronic systems, not only because they occur frequently in such 
systems, but also because any periodical signal can be represented 
as a linear combination of a set of sinusoidal signals of different 
frequencies, amplitudes, and phase angles (Fourier transform theory).

A sinusoidal variable (voltage or current) can be written as
\[
x(t)=A\;\cos(\omega t + \phi),\;\;\;\mbox{or}\;\;\;
x(t)=A\;\sin(\omega t+\phi+\pi/2) 
\]
The three parameters $A$, $\omega$ and $\phi$ represent three 
important elements:
\begin{itemize}
\item {\em $A$: amplitude or peak value}
\item {\em $\phi$: phase angle $0 \le \phi \le 2\pi$ in radians or
	$0^\circ \le \phi \le 360^\circ$ in degrees.}
\item {\em $\omega=2\pi f=2\pi/T$: angular frequency in radians per 
  second}, where $f=1/T$ is the frequency measured by cycles per
  second (in Hertz, Hz), and $T$ is cycle time or period (in second).
  \[
  \omega=2\pi f=2\pi/T,\;\;\;\;f=1/T=\omega/2\pi,\;\;\;T=1/f=2\pi/\omega 
  \]
\end{itemize}

Sinusoidal functions are closely related to complex exponentials due
to Euler's formula:
\[
\left\{ \begin{array}{l}
  e^{ j\theta}=\cos\theta+j\,\sin\theta\\
  e^{-j\theta}=\cos\theta-j\,\sin\theta \end{array} \right.
\;\;\;\;\;\;
\left\{ \begin{array}{l}
  \cos\theta=(e^{j\theta}+e^{-j\theta})/2\\
  \sin\theta=(e^{j\theta}-e^{-j\theta})/2j 
\end{array} \right.  
\]
As exponential functions can be much more conveniently manipulated 
than sinusoidal functions, a sinusoidal function is often considered
as the real or imaginary part of the corresponding complex variable:
\[
A\;\cos(\omega t+\phi)=Re[A\;e^{j\omega t+\phi}],\;\;\;\;
A\;\sin(\omega t+\phi)=Im[A\;e^{j\omega t+\phi}]	
\]


{\bf Example:} (Homework)

A sinusoidal current with a frequency of 60 Hz reaches a positive
maximum of 20A at $t=2 \; ms$. Give the expression of this current 
as a function of time $i(t)$.

\htmladdnormallink{Answer}{../ch1_sub0/index.html}

{\bf Average Value} 

The average of a time varying current $i(t)$ is the steady or DC 
(direct current) value of current $I_{av}$ that in period $T$ would 
transfer the same charge $Q$:
\[	
I_{av}T=Q=\int_0^T i(t) dt,\;\;\;\;\mbox{i.e.}\;\;\;\;
I_{av}=\frac{1}{T}\int_0^T i(t) dt	
\]
Similarly, the average voltage is defined as:
\[
V_{av}=\frac{1}{T}\int_0^T v(t) dt	
\]
If the current/voltage is periodic, i.e., it repeats itself every 
time cycle $T$, then $i(t)=i(t+T)$ and $v(t)=v(t+T)$. The reciprocal 
of $T$ is called the {\em fundamental frequency}. In particular, for 
a sinusoidal current 
\[
i(t)=I_p\,\sin(\omega t)=I_p\,\sin(2\pi ft)=I_P\,\sin(2\pi t/T)
\]
the average over the complete cycle $T=1/f$ is always zero (the charge
transferred during the first half is the opposite to that transferred
in the second). However, we can consider the half-cycle average over 
$T/2$:
\begin{eqnarray} 
  I_{av}&=&\frac{1}{T/2}\int_0^{T/2} i(t)\; dt
  =\frac{2}{T}\int_0^{T/2} \;I_P\,\sin(2\pi t/T)\;dt	
  =-\frac{2}{T}\frac{TI_P}{2\pi} \cos(2\pi t/T)\bigg|_0^{T/2}
  \nonumber \\
  &=& \frac{1}{\pi}\left[\cos(0)-\cos(\pi)\right]I_P
  =\frac{2}{\pi}I_P\;=0.637\,I_P
  \nonumber
\end{eqnarray}

{\bf Effective or RMS Value}

The effective value of a time-varying current $i(t)$ or voltage is the 
constant value of current $I_{rms}$ or voltage $V_{rms}$ that in period $T$ 
would transfer the same amount of energy:
\begin{eqnarray}
  W=\int_0^T p(t) dt&=&R\int_0^T i^2(t) dt
  =R I^2_{rms}T
  \nonumber \\
  &=&\frac{1}{R}\int_0^T v^2(t) dt=\frac{1}{R}V^2_{rms}T
  \nonumber
\end{eqnarray}
i.e.,
\[ 
I_{rms}=\sqrt{\frac{1}{T}\int_0^T i^2(t) dt},\;\;\;\;\;\;\;\mbox{or}\;\;\;\;\;\;
V_{rms}=\sqrt{\frac{1}{T}\int_0^T v^2(t) dt}	
\]
As $I_{rms}$ or $V_{rms}$ is the ``square root of the mean of the squared value'',
it is also called the {\em root-mean-square (rms)} current or voltage.

For a sinusoidal variable $i(t)=I_p\,\cos(\omega t)$, we have
($\cos^2\alpha=[1+\cos(2\alpha)]/2$) 
\[ 
I^2_{rms} = \frac{1}{T}\int_0^T i^2(t) dt
= \frac{I^2_p}{T}\int_0^T \cos^2(2\pi t/T) dt
= \frac{I^2_p}{2T}\int_0^T [1+\cos(4\pi t/T)]\; dt=\frac{I^2_p}{2} 
\]
i.e.,
\[
I_{rms}=\frac{I_p}{\sqrt{2}}=I_p\;0.707
\]
Similarly, for $v(t)=V_p\,\cos(\omega t)$, we also have 
\[
V_{rms}=\frac{1}{\sqrt{2}}=V_p\;0.707
\]

\subsection*{Phasor Representation of Sinusoidal Variables}

In the following discussion about AC circuit analysis, all sinusoidal
variables (currents and voltages) are assumed to be of the same 
frequency. In general, arithmetic operations of sinusoidal functions 
are not convenient as they will involve using trigonometric identities.
However, we can consider such sinusoidal functions as real (or imaginary)
parts of some rotating vectors in the complex plane, and their arithmetic
operations (addition, multiplication, etc.) can be more conveniently
carried out (\htmladdnormallink{review of complex arithmetic}{http://fourier.eng.hmc.edu/e84/lectures/ch3/node22.html}).

However, we can consider the {\em phasor} 

\htmladdimg{../figures/RotatingVectors.gif}

The sum of the two sinusoidal function can now be found as the real part of
the rotating vector sum:
\begin{eqnarray}
  x(t)+y(t)&=&A\cos(\omega t+\phi)+B\cos(\omega t+\psi)
  \nonumber\\
  &=&Re[\dot{X}e^{j\omega t}]+Re[\dot{Y}e^{j\omega t}]
  =Re[(\dot{X}+\dot{Y})e^{j\omega t}]
  \nonumber
\end{eqnarray}
The addition can be more easily carried out in the phasor form as vectors 
in the complex plane, than in the time domain.

%\htmladdimg{../figures/PhasorAddition3.png}

\htmladdimg{../figures/phasors.png}

Specifically, consider two sinusoidal functions 
\[
\left\{ \begin{array}{l}
  x(t)=A\cos(\omega t+\phi)=Re[A e^{j\phi}e^{j\omega t}]=Re[\dot{X}e^{j\omega t}]\\
  y(t)=B\cos(\omega t+\psi)=Re[B e^{j\psi}e^{j\omega t}]=Re[\dot{Y}e^{j\omega t}]
\end{array} \right. 
\]
where $\dot{X}=A e^{j\phi}$ and $\dot{Y} e^{j\psi}$ are two vectors in 
the complex plane with different magnitudes and initial phases called 
{\em phasors} 
\[
\dot{X}=Ae^{j\phi}=A\;\angle\phi,
\;\;\;\;\;\;\;\;\;\;\;\dot{Y}=Be^{j\psi}=B\;\angle\psi
\]
When multiplied by $e^{j\omega t}$, these vectors start rotating CCW in the
complex plane. As the two sinusoidal functions have the same frequency, 
the two vectors are rotating at the same rate. If observed in a reference
frame rotating at the same rate, these vectors become standing still, 
i.e., we can simply drop the time-varying component $e^{j\omega t}$, and 
represent the functions in terms of their phasors representing their
amplitudes and phases only.

On the other hand, given such a phasor representation, we can get the 
real sinusoidal function back by first multiplying $e^{j\omega t}$ and then
taking the real part:
\[
x(t)=Re[\dot{X} e^{j\omega t}]=Re[A e^{j\phi} e^{j\omega t}]=A\cos(\omega t+\phi)
\]
A phasor may be represented simply by a capital letter (e.g., $X$, 
$V$ or $I$) if no confusion will be caused. Sometimes the RMS value
$A_{rms}=A/\sqrt{2}$, instead of the peak value $A$, is used in phasor.


{\bf Example} 

Consider three sinusoidal voltage sources $v_1(t)=6\sqrt{2}\;\sin(\omega t)$,
$v_2(t)=12\sqrt{2}\;\sin(\omega t+\pi/2)$ and 
$v_3(t)=4\sqrt{2}\;\sin(\omega t-\pi/2)$ in series. According to the KVL, the 
overall voltage will be the algebraic sum of the three:
\[ 	v(t)=v_1(t)+v_2(t)+v_3(t)
	=6\sqrt{2}\;\sin(\omega t)+12\sqrt{2}\;\sin(\omega t+\pi/2)
	+4\sqrt{2}\;\sin(\omega t-\pi/2)	\]

\htmladdimg{../figures/sinusoidalsum.gif}

While the addition of these sinusoidal functions is not easy to carry out
(still remember all the trigonometric identities?), it is quite straight 
forward to find the vector sum if the voltages are represented as phasors:
\begin{eqnarray}
  \dot{V}&=&\dot{V}_1+\dot{V}_2+\dot{V}_3
  =\sqrt{2}(6\angle 0^\circ+12\angle 90^\circ+4\angle -90^\circ)
  \nonumber \\
  &=&\sqrt{2}(6+j8)=10\sqrt{2} \angle \left[\tan^{-1}(8/6)\right]
  =10\sqrt{2}\angle\; 53.1^\circ	
  \nonumber 
\end{eqnarray}
The resulting voltage is $v(t)=10\sqrt{2}\;sin(\omega t+53.1^\circ)$

\htmladdimg{../figures/vectorsum.gif}

\htmladdimg{../figures/sinusoidalsum1.gif}


{\bf Phasor and the Fourier transform}

A sinusoidal function $x(t)=A\cos(\omega t+\phi)$ can be expressed in
either Fourier transform (Fourier series) or phasor representation:
\begin{eqnarray}
  x(t)&=&A\cos(\omega t+\phi)=Re[Ae^{j\phi}\;e^{j\omega t}]=Re[\dot{X} e^{j\omega t}]
  \;\;\;\;\;\mbox{(phasor)}
  \nonumber \\
  &=&\left(\frac{A}{2}e^{j\phi}\right)e^{j\omega t}
  +\left(\frac{A}{2}e^{-j\phi}\right)e^{-j\omega t}
  =X_1 e^{j\omega t}+X_{-1}e^{-j\omega t}\;\;\;\;\;\mbox{(Fourier coefficients)}
\nonumber 
\end{eqnarray}
We see that the phasor and the Fourier coefficients are essentially 
the same, in the sense that they are both coefficients representing the 
amplitude and phase of the complex exponential function $e^{j\omega t}$:
\[
\dot{X}=Ae^{j\phi},\;\;\;\;\;\;\;\;\;\;\;\;\;\;
X_1=\frac{A}{2}e^{j\phi},\;\;\;X_1=\frac{A}{2}e^{-j\phi}
\]
In both cases the real time function can be obtained (inverse Fourier
transform) by either adding the two complex vectors $X_1e^{j\omega t}$ and 
$X_{-1}e^{-j\omega t}$ rotating in opposite directions (CCW and CW), or simply
taking the real part of the complex variable $\dot{X}e^{j\omega t}$

\begin{comment}
According to the Fourier theory, any time function (satisfying certain 
mathematical conditions) $x(t)$ can be decomposed into a linear combination
of sinusoidal (complex exponential) components:
\begin{itemize}
\item If $x(t)=x(t+T)$ is periodical with period $T$, it can be Fourier
  expanded into
  \[
  x_T(t)=\sum_{k=-\infty}^\infty X[k] e^{jk\omega_0t},\;\;\;\;\;\;(\omega_0=2\pi/T)
  \]
  where $X[k]$ is the complex coefficient of the kth frequency component
  \[
  X[k]=\frac{1}{T}\int_T x_T(t)e^{-jk\omega_0t}
  \]
  When $x_T(t)$ is real, the above becomes:
  \[
  x_T(t)=X[0]+2\sum_{k=1}^\infty |X[k]|\cos(k\omega_0 t+\angle X[k])
  \]
\item If $x(t)$ is not periodical, i.e., $T=\infty$, it can be expressed as
  \[
  x(t)=\frac{1}{2\pi} \int X(\omega) e^{j\omega t} d\omega
  \]
  where $X(\omega)$ is the {\em Fourier spectrum} of the signal representing
  how the signal energy is distributed as a function of continuous frequency:
  \[
  X(\omega)=\int_{-\infty}^\infty x(t) e^{-j\omega t}\;dt
  \]
\end{itemize}
\end{comment}


{\bf Generalized Ohm's law and Kirchhoff's Laws}

In general, all methods such as Ohm's law and Kirchhoff's Laws used for DC 
circuits composed of resistors can be generalized to AC circuits composed 
of capacitors, inductors, as well as resistors, all represented by their
impedances. Also, if we assume all voltages and currents in a circuit are 
sinusoids of same frequency $\omega$, they can be represented as complex 
phasors.

The Ohm's law can be generalized to become:
\[ Z=\frac{\dot{V}}{\dot{I}},\;\;\;\;\;\;\dot{I}=\frac{\dot{V}}{Z},
\;\;\;\;\;\dot{V}=Z\dot{I} \]
and the Kirchhoff's laws can now be stated as:
\begin{itemize}
\item {\bf Current Law (KCL):} The vector sum of the currents into a node
  is zero $\sum_k \dot{I}_k=0$.
\item {\bf Voltage Law (KVL):} The vector sum of the voltages around a loop 
  is zero $\sum_k \dot{V}_k=0$.
\end{itemize}


{\bf Solving AC circuit by phasor method}

If only the steady state solutions of the DE describing an AC circuit is of 
interest, the phasor method can be used to solve the problem algebraically 
without solving the DEs. Specifically, all sinusoidal variables are represented 
as phasors in terms of their amplitudes and phases, and all components in the 
circuit (L and C, as well as R) are represented by their impedances, so that 
all the laws (Ohm's law, KCL and KVL, current and voltage dividers, parallel 
and series combinations of components) and methods (loop current and node 
voltage methods, Thevenin's and Norton's theorems, etc.) discussed for DC 
circuit can be applied.

\htmladdimg{../figures/phasordiagram.gif}

Operations on sinusoidal variables based on the trigonometric identities
are in general lengthy and tedious. The phasor method can convert such 
sinusoidal variables to vectors in complex plane and thereby simplify the 
operations. 

The phasor represents the amplitude (effective or RMS value) and phase of a 
sinusoidal function, but leaves out its frequency as it is known to be the
same for all sinusoidal variables in the system.

Specifically here are the three steps of the phasor method for arithmetic 
operation of two sinusoidal functions $x(t)=A\cos(\omega t+\phi)$ and 
$y(t)=B\cos(\omega t+\psi)$ of the same frequency:
\begin{itemize}
\item Represent each sinusoidal function as a phasor:
  \[ x(t)=A\;\cos(\omega t+\phi)=Re[A\,e^{j(\omega t+\phi)}]
  =Re[A e^{j\phi} e^{j\omega t}] =Re[\dot{X} e^{j\omega t}] 
  \]
  where $\dot{X}=A e^{j\phi}=A e^{j\phi}$ is the phasor of $x(t)$. 
  Similarly we also get $\dot{Y}=B e^{j\psi}$.
\item Carry out any arithmetic operation (represented by *) on the phasors:
  \[ \dot{Z}=\dot{X}\;*\;\dot{Y}=A e^{j\phi} \;*\; B e^{j\psi} \]
\item Convert resulting phasor back to a time function:
  \[ z(t)=x(t)\;*\;y(t)=Re[\dot{Z} e^{j\omega t}]  \]
\end{itemize}

\htmladdimg{../figures/PhasorBlockDiagram1.png}

The operations on the original sinusoidal variables require solving 
differential equations, while the operations on their phasors only require 
solving algebraic equations. This is the main advantage of the phasor method.



\subsection{Impedance and Generalized Ohm's Law}

{\bf Impedance of Basic Components}

The relationship between the sinusoidal current $i(t)$ through and 
the sinusoidal voltage $v(t)$ across a capacitor or an inductor in 
an AC circuit is described by a differential equation in time domain.
However, if we treat such a sinusoidal variable as the projection of 
a complex exponential, a vector rotating counter-clock wise, onto the 
real axis:
\[
v(t)=V_p\cos(\omega t+\phi)=Re[ V_p e^{j(\omega t+\phi)} ],
\;\;\;\;\;\;\;\;
i(t)=I_p\cos(\omega t+\psi)=Re[ I_p e^{j(\omega t+\psi)} ]
\]
then the relationship between the voltage and current can be 
described by an algebraic equation. We define the {\em impedance} 
of a component (R, C, and L) as the ratio of the complex exponential
forms of the voltage and the current associated with the component
\[
\mbox{Impedance}=Z=\frac{V_pe^{j(\omega t+\phi)}}{I_pe^{j(\omega t+\psi)}}
  =\frac{V_pe^{j\phi}}{I_pe^{j\psi}}=\frac{\dot{V}}{\dot{I}}
  =\frac{\mbox{Phasor of voltage}}{\mbox{Phasor of current}}
\]
This is the generalized version of the Ohm's law for AC circuits.

\htmladdimg{../figures/ImpedanceFT.png}


\begin{itemize}
\item {\bf Resistor:} 
  \[ 
  V_pe^{j(\omega t+\phi)}=R I_pe^{j(\omega t+\psi)}
  \]
  The impedance of a resistor is the ratio of the phasor representations 
  of the voltage and current. As the current through and voltage across
  a resistor are always in phase, i.e., $\psi=\phi$, we have
  \[
  Z_R=\frac{V_p\,e^{j\phi}}{I_p\,e^{j\psi}}
  =\frac{V_p}{I_p}=R, \;\;\;\;\; |Z_R|=R,\;\;\;\;\;\angle Z_R=0
  \]
  The magnitude and phase of the current and voltage are related by:
  \[ 
  V_p=|Z_R|\,I_p,\;\;\;\;\;\; \angle\dot{V}=\angle\dot{I}
  \]
  The resistor introduces no phase shift between the voltage and current,
  i.e., they are in phase.
  
\item {\bf Capacitor:} 
  \[ 
    I_pe^{j(\omega t+\psi)}=C\frac{d}{dt}[V_p e^{j(\omega t+\phi)}]
    =j\omega C V_p e^{j(\omega t+\phi)}
  \]
  The impedance of a capacitor is the ratio of the phasor representations 
  of the voltage and current:
  \[
  Z_C=\frac{V_pe^{j\phi}}{I_pe^{j\psi}}=\frac{1}{j\omega C}=\frac{-j}{\omega C},
  \;\;\;\;\;\;|Z_C|=\frac{1}{\omega C},\;\;\;\;\;\;\angle Z_C=-\frac{\pi}{2}
  \]
  The magnitude and phase of the current and voltage are related by:
  \[
  \dot{V}=Z_C\dot{I}=-j\dot{I}/\omega C,\;\;\;\;\;
  V_p=I_p/\omega C,\;\;\;\;\;\; \angle\dot{V}=\angle\dot{I}-\frac{\pi}{2}
  \]
  The phase shift introduced by a capacitor is $\angle Z_C=-\pi/2=-90^\circ$,
  i.e., the voltage lags behind the current by $90^\circ$, or the current 
  leads the voltage by $90^\circ$ (``ICE'').
  

\item {\bf Inductor:}
  \[
    V_pe^{j(\omega t+\phi)}=L\frac{d}{dt}[I_p e^{j(\omega t+\psi)}]
    =j\omega L I_p e^{j(\omega t+\psi)}
  \]
  The impedance of an inductor is the ratio of the phasor representations 
  of the voltage and current:
  \[ 
  Z_L =\frac{V_pe^{j\phi}}{I_pe^{j\psi}} =j\omega L,
  \;\;\;\;|Z_L|=\omega L,\;\;\;\angle Z_L=\frac{\pi}{2}	
  \]
  The magnitude and phase of the current and voltage are related by:
  \[
  \dot{V}=Z_L\dot{I}=j\omega L\dot{I},\;\;\;\;\;
  V_p=\omega LI_p,\;\;\;\;\;\; \angle\dot{V}=\angle\dot{I}+\frac{\pi}{2}
  \]
  The phase shift introduced by a inductor is $\angle Z_L=\pi/2=90^\circ$,
  i.e., the voltage leads the current by $90^\circ$ (``ELI''). 
\end{itemize}
One way to remember the phase between the voltage $E$ and current $I$ 
associated with capacitor $C$ and inductor $L$ is ``ELI the ICE man''. 
Also, consider two extreme cases:
\begin{itemize}
\item When $\omega=0$, $Z_C\rightarrow \infty$ and the capacitor has zero 
  conductivity due to the insulation between its two plates (open circuit),
  and $Z_L=0$ as there is no flux change in the inductor and the resistance 
  of the coil is ideally zero.
\item When $\omega\rightarrow \infty$, $Z_C\rightarrow 0$ and the capacitor 
  becomes highly conductive, and $Z_L\rightarrow \infty$ as the self-induced
  voltage in the coil always acts against any change in the input (Lenz's Law).
\end{itemize}




\begin{itemize}
  \item {\bf Impedance}

    As a complex variable, the impedance $Z$ can be written in either
    Cartesian or polar form:
    \[	
    Z=R+jX=|Z|e^{j\angle Z}=|Z|\angle Z	
    \]
    \begin{itemize}
    \item The real part of impedance $Re[Z]=R$ is called {\bf resistance}. 
    \item The imaginary part of impedance  $Im[Z]=X$ is called {\bf reactance}. 
    \end{itemize}
    Impedance, resistance, and reactance are all measured by the same unit 
    Ohm ($\Omega$). 

    The magnitude and phase angle of $Z$ are:
    \[
    |Z|=\sqrt{R^2+X^2},\;\;\;\;\angle Z=tan^{-1}\left(\frac{X}{R}\right)	
    \]
    The impedances $Z_C=1/j\omega C=-j/\omega C$ associated with $C$ and 
    $Z_L=j\omega L$ are both purely imaginary, i.e., they are both reactance,
    indicating these components are reactive and consume no energy.

\item {\bf Admittance}

  The reciprocal of the impedance $Z$ is called {\bf admittance}:
  \[
  Y=\frac{1}{Z}=\frac{1}{R+jX}=\frac{R-jX}{R^2+X^2}
  =\frac{R}{R^2+X^2}+j\frac{-X}{R^2+X^2}=G+jB	
  \]
  \begin{itemize}
  \item The real part of admittance is called {\bf conductance}:
    \[	G=Re[Y]=\frac{R}{R^2+X^2}	\]
  \item The imaginary part of admittance is called {\bf susceptance}:
    \[	B=Im[Y]=\frac{-X}{R^2+X^2}	\]
  \end{itemize}
  Admittance, conductance and susceptance are all measured by the same 
  unit Siemens ($S$). 

  The magnitude and phase of complex admittance are
  \[
  |Y|=\sqrt{G^2+B^2}=\frac{1}{\sqrt{R^2+X^2}},\;\;\;\;\;
  \angle Y=\tan^{-1} \left(\frac{B}{G}\right)=\tan^{-1} \left(\frac{-X}{R}\right)
  =-\angle Z	
  \]
\end{itemize}

\[
\left\{\begin{array}{rcl}
 \mbox{Impedance} &=& \mbox{Resistance} + j \;\mbox{Reactance} \\
 \mbox{Admittance} &=& \mbox{Conductance} + j\; \mbox{Susceptance} \\
 \mbox{Admittance}&=&1/\mbox{Impedance}\\
 \end{array}\right.
\]

Impedance $Z$ and admittance $Y=1/Z$ are both complex variables. The 
real parts $Re[Z]=R$ and $Re[Y]=G$ are always positive, but the imaginary 
parts $Im[Z]=X$ and $Im[Y]=B$ can be either positive or negative. Therefore
$Z$ and $Y$ can only be in the 1st or the 4th quadrants of the complex plane.

In particular, the admittances of the three types of elements R, L
and C are
\[ Y_R=\frac{1}{R},\;\;\;\;
Y_L=\frac{1}{Z_L}=\frac{1}{j\omega L}=\frac{-j}{\omega L},\;\;\;\;
Y_C=\frac{1}{Z_C}=\frac{1}{1/j\omega C}=j\omega C	\]

Ohm's law can also be expressed in terms of admittance as well as 
impedance. Sometimes it is more convenient in circuit analysis to use 
admittance instead of impedance.
\begin{itemize}
\item Components parallel:
  \[ Z_{total}=\frac{Z_1\;Z_2}{Z_1+Z_2},\;\;\;\;Y_{total}=Y_1+Y_2 \]
\item Components in series:
  \[ Z_{total}=Z_1+Z_2,\;\;\;\;Y_{total}=\frac{Y_1\;Y_2}{Y_1+Y_2}\]
\end{itemize}

Here is a 
\htmladdnormallink{review of complex arithmetic}{http://fourier.eng.hmc.edu/e84/lectures/ch3/node22.html}.


{\bf Example 1:} 

Solve the circuit below. The voltage from the generator is 
$v(t)=28.3\;\cos(5000t+45^\circ)\;V=20\sqrt{2}\;\cos(5000t+45^\circ)$.

\htmladdimg{../figures/phasorexample.gif}

The given voltage $v(t)=28.3\;\cos(5000t+45^\circ)\;V$ can be expressed
in phasor form as $\dot{V}=28.3\;\angle{45^\circ}$.

First find the impedances and admittances of the components and the 
two branches. As $\omega=5000$, we get
\begin{itemize}
\item $Y_C=j\omega C=j\;5000\times 10^{-5}=j0.05=0.05\angle{90^\circ}$,

	$Z_C=1/Y_C=1/j0.05=-j20=20\angle{-90^\circ}$
\item $Z_L=j\omega L=j5000\times 4\times 10^{-3}=0+j20=20\angle{90^\circ}$,

	$Y_L=1/Z_L=-j0.05=0.05\angle{-90^\circ}$
\item $Z_R=R=20+j0=20\angle{0^\circ}$

\item $Z_{RL}=Z_R+Z_L=20+j20=20\sqrt{2}\angle{45^\circ}$,
	$Y_{RL}=1/Z_{RL}=1/20\sqrt{2}\angle{45^\circ}
	=0.025\sqrt{2}\angle{-45^\circ}=0.025-j0.025$

\item $Y_{load}=Y_C+Y_{RL}=0.025+j0.025=0.025\sqrt{2}\angle{45^\circ}$
\end{itemize}
Next find all currents in phasor form:
\begin{itemize}
\item $\dot{I}_{load}=Y_{load}\dot{V}=(28.3\angle{45^\circ})\;
  (0.025\sqrt{2}\angle{45^\circ})=1\,\angle{90^\circ}$,

  $i_{load}(t)=Re[\dot{I} e^{j5000t}]=Re[(1\,e^{j\,90^\circ}) e^{j5000t}]
  =\cos(5000t+90^\circ)$
\item $\dot{I}_C=\dot{V}Y_C=(0.05\angle{90^\circ})(28.3\angle{45^\circ})
  =1.41\angle{135^\circ}=-1+j$,  

  $i_C(t)=Re[ (1.41 e^{j 135^\circ}) e^{j5000t}]=1.41\;\cos(5000t+135^\circ)$

\item $\dot{I}_{RL}=Y_{RL}\dot{V}=(0.025\sqrt{2}\angle{-45^\circ})(28.3\angle{45^\circ})
  =0.707\;\angle{0^\circ}=0.707$,

  $i_{RL}(t)=Re[ (0.707\,e^{j0}) e^{j5000t} ]=0.707\,\cos(5000t)$

\item $\dot{V}_R=Z_R\dot{I}_{RL}=(20\angle{0^\circ})(1\;\angle{0^\circ})
  =20\;\angle{0^\circ}=20+j0$,
        
  $i_R(t)=20\;\cos(5000t)$

\item $\dot{V}_L=Z_L\dot{I}_{RL}=(20\angle{90^\circ})(1\;\angle{0^\circ})
  =20\;\angle{90^\circ}=0+j20$

  $v_L(t)=20\;\cos(5000t+90^\circ)$.
\end{itemize}
Verify: 
\begin{itemize}
\item $\dot{V}_R+\dot{V}_L=10\sqrt{2}+j10\sqrt{2}=20\angle{45^\circ}
	=\dot{V}$
\item $\dot{I}_C+\dot{I}_{RL}=0.5\sqrt{2}-0.5\sqrt{2}+j0.5\sqrt{2}
	=0.5\sqrt{2}\angle{90^\circ}=\dot{I}_{load}$
\end{itemize}

\htmladdimg{../../lectures/figures/VectorPlots.png}

{\bf Example 2:} 

A current $i(t)=17\;\cos(1000t+90^\circ)=12\sqrt{2}\cos(1000t+90^\circ)$ 
flows through a circuit composed of a resistor $R=18\Omega$, a capacitor
$C=83.3\mu F=83.3\times 10^{-6}F$, and an inductor $L=30 mH=30\times 
10^{-3}H$ connected in series. Find the resulting voltage across all 
three elements.

\begin{itemize}
\item Express $i(t)$ in phasor: $\dot{I}=12\sqrt{2}\;\angle{90^\circ}
  =j\;12\sqrt{2}$.
\item Find impedance for each element ($\omega=1000$):
  \[
  Z_R=R=18,\;\;\;\;Z_C=1/j\omega C=12\angle{-90^\circ}=0-j12,\;\;\;\;
  Z_L=j\omega L=30\angle{90^\circ}=0+j30	
  \]
\item Find overall impedance:
  \[ 
  Z_{total}=Z_R+Z_C+Z_L=18+j(-12+30)=18+j18=18\sqrt{2}\angle{45^\circ} 
  \]
\item Find voltage across all three elements:
  \[
  \dot{V}_{total}=\dot{I}Z_{total}=(12\sqrt{2}\;\angle{90^\circ})\;(18\sqrt{2}\angle{45^\circ})
  =432\;\angle{135^\circ}	
  \]
  \[
  v(t)=432\;\cos(1000t+135^\circ)
  \]
\end{itemize}
Alternatively, we can find voltage across each of the elements:
\begin{eqnarray}
  \dot{V}_R&=&\dot{I}Z_R=216\sqrt{2}\;j=305.5\;\angle{90^\circ}
  \nonumber\\
  \dot{V}_C&=&\dot{I}Z_C=144\sqrt{2}\;\angle{0^\circ}=203.6
  \nonumber\\
  \dot{V}_L&=&\dot{I}Z_L=360\sqrt{2}\;j=509\;\angle{180^\circ}
  \nonumber
\end{eqnarray}
or in time domain:
\begin{eqnarray}
  v_R(t)&=&305.5 \cos(1000t+\pi/2)
  \nonumber\\
  v_C(t)&=&203.6 \cos(1000t)
  \nonumber\\
  v_L(t)&=&509 \cos(1000t+\pi) 
  \nonumber
\end{eqnarray}
Adding $\dot{V}_R$, $\dot{V}_C$, and $\dot{V}_L$, we get the total voltage
which is the same as what we got above:
\[ 
\dot{V}_{total}=\dot{V}_R+\dot{V}_C+\dot{V}_L
=216\sqrt{2}\angle{90^\circ}+216\sqrt{2}\angle{180^\circ}=432 \angle{135^\circ}	
\]

{\bf Example 3:} 

In the circuit below, $v_S(t)=A\cos(\omega t)=A\cos(10^6 t)$
with some unknown peak value $A$, $R_1=R_2=R_3=R=10\Omega$, and 
$L=10\,\mu H$. The RMS value of $v_2$ across $R_2$ is 10 V. It 
is also known that $v_s(t)$ and $i_s(t)$ are in phase. 
\begin{itemize}
\item Find $C$.
\item Find the RMS values of $v_C(t)$ and $v_L(t)$.
\item Find the RMS values of $v_{cd}=v_{RC}=V_{RL}$ and $v_{ab}$.
\item Find the peak value $A$ of $v_s(t)$.
\end{itemize}

\htmladdimg{../../lectures/figures/Problems9.png}

{\bf Solution} 

\htmladdimg{../../lectures/figures/Problems8.png}

We first note that $\dot{V}_C$ is behind $\dot{V}_2=\dot{I}_2R_2$ 
by $\pi/2$, and $\dot{V}_L$ is ahead of $\dot{V}_3=\dot{I}_3R_3$ by 
$\pi/2$ (``ELI the ICE man''). Also, as $v_s(t)$ and $i_s(t)$ are 
in phase, the parallel combination of the RL and RC branches must
introducing no phase shift, i.e., its impedance shown below must be 
real:
\[
Z_{RL}(\omega)||Z_{RC}(\omega)
=\frac{Z_LZ_C}{Z_L+Z_C}=\frac{(R+jX_L)(R+jX_C)}{R+jX_L+R+jX_C}
=\frac{R^2-X_LX_C+j(X_L+X_C)}{2R+j(X_L+X_C)}
\]
i.e., $X_C+X_L=0$. We therefore get $-1/j\omega C=j\omega L=j 10$
and $C=10^{-7}=0.1\mu F$, $Z_{RL}=10+j\,10$, $Z_{RC}=10-j\,10$, 
$|Z_{RL}|=|Z_{RC}|=\sqrt{10^2+10^2}=10\sqrt{2}$, i.e.,
\[
Z_{RL}(\omega)||Z_{RC}(\omega)=\frac{(10+j10)(10-j10)}{10+j10+10-j10}=10
\]
As $|R_2|=|Z_C|=10 \Omega$, $|\dot{V}_C|=|\dot{V}_R|=10V$.
But as they are $\pi/2$ apart in phase, we have 
$|\dot{V}_{cd}|=|\dot{V}_{RC}|=|\dot{V}_{RL}|=10\sqrt{2}$, and from the
vector diagram $|\dot{V}_{ab}|=10\sqrt{2}$. We also get the currents 
through RC and RL branches are:
\[
|\dot{I}_{RC}|=\frac{|\dot{V}_{RC}|}{|Z_{RC}|}=\frac{10}{10}=1,
\;\;\;\;\;\;
|\dot{I}_{RL}|=\frac{|\dot{V}_{RL}|}{|Z_{RL}|}=\frac{10}{10}=1
\]
But their phase difference is $\pi/2$, we have
\[
|\dot{I}_s|=|\dot{I}_{RL}+\dot{I}_{RC}|=\sqrt{2}
\]
The voltage across $R_1$ is $V_1=RI_s=10\sqrt{2}$, and
\[
\dot{V}_s=\dot{V}_1+\dot{V}_{cd}=10\sqrt{2}+10\sqrt{2}=20\sqrt{2}
\]
The peak value is therefore $A=\sqrt{2} V_s=40\,V$
  
  

\subsection*{First Order Systems}

If we need to find out the transient response of an AC circuit to a certain 
input applied at time moment $t=0$, such as a unit step input 
\[
u(t)=\left\{\begin{array}{ll}0&t<0\\1&t\ge 0\end{array}\right.
\]
or a constant voltage source which is connected to the circuit through a
switch which is closed at time moment $t=0$, then the phasor method discussed
above is no longer sufficient. Now the DE describing the circuit will have 
to be solved to obtain the complete solution including both the homogeneous 
(transient) solution as well as the particular (steady state) solution. 

As a simple example, the RC circuit shown below is composed of a resistor
$R$ and capacitor $C$ in series with an external voltage input $v(t)$, which 
is turned on at $t=0$, either by a switch or a step voltage $v(t)$. We also
assume the initial condition that the voltage across $C$ is $v_C(0)=V_0$ at
$t=0$. Any of the variables $v_R(t)$, $v_C(t)$, and $i(t)$ can be considered 
as the circuit's response to this input.

\htmladdimg{../figures/RL_RCcircuit.png}

\begin{itemize}
\item The RC circuit can be described by the KVL:
  \[ 
  v_R(t)+v_C(t)=R\;i(t)+v_C(t)=RC\frac{d}{dt} v_c(t)+v_c(t)
  =\tau \frac{d}{dt} v_C(t)+v_C(t)=v(t) 
  \]
  where $\tau=RC$ is the time constant of the system with the dimension of time:
  \[
    [RC]=\frac{[V]}{[I]}\frac{[Q]}{[V]}=\frac{[Q]}{[I]}=[T]	
  \]
\item Similarly, for the RL circuit we have:
  \[
  v_R(t)+v_L(t)=R\; i(t)+L\frac{d}{dt} i(t)=v(t)\;\;\;\;\mbox{or}\;\;\;\;\;
  \tau \frac{d}{dt} i(t)+i(t)=\frac{v(t)}{R}	
  \]
  where $\tau=L/R$ is the time constant with the dimension of time:
  \[
    \frac{[L]}{[R]}=\frac{[V][T]}{[I]}\frac{1}{[R]}=\frac{[R][T]}{[R]}=[T]	
  \]
\end{itemize}
In both cases, the polarity of $v_R$ is positive on top, and the polarities of
$v_C$ and $v_R$ are positive on the left.

In general, a first-order linear system with input $x(t)$ and output
$y(t)$ can be described by a first-order linear-constant coefficient 
differential equation (LCCDE) in the canonic form:
\[
\tau\frac{d}{dt}y(t)+y(t)=x(t)
\]
in terms of a single parameter, the {\em time constant} $\tau$.

While DC circuit analysis is carried out by solving {\em algebraic} 
equations, the analysis of AC circuits composed of capacitors, inductors 
as well as resistors will require solving differential equations. The 
solution of a DE represents the response (or output) of the circuit to 
both the {\em external input} and the {\em initial state}, and is composed 
of two parts:
\begin{itemize}
\item {\em Homogeneous solution} representing the {\em natural response} or
  {\em transient response} caused by the initial condition,
\item {\em Particular solutions} representing the {\em forced response} or
  {\em steady state response} caused by the external input.
\end{itemize} 

\subsubsection*{Homogeneous Solution}


Consider an RC circuit consisted of a resistor and a capacitor in series 
connected to an AC voltage source $v(t)=\cos(\omega t)$, find the voltage
$v_C(t)$ across $C$. The governing DE describing the circuit can be obtained 
based on KVL:
\[
\tau\frac{d}{dt}v_C(t)+v_C(t)=v_s(t)
=\left\{\begin{array}{c}0\\1\\\cos(\omega t)\end{array}\right.
\]
When the external input is zero $v_s(t)=0$, the DE is homogeneous (zero 
on the right-hand side):
\[
\tau\frac{d}{dt}v_C(t)+v_C(t)=0,\;\;\;\;\;v_C(0)=V_0
\]
The non-trivial solution of this homogeneous equation is due to some 
non-zero initial value, the voltage $v_C(0)=V_0\ne 0$ across the capacitor
before $t=0$. The homogeneous solution needs to be a function whose 
derivative takes the same form as the function itself, an exponential
function:
\[
v_C(t)=A e^{st},\;\;\;\;\mbox{and}\;\;\;\;\;\;\;\frac{d}{dt}v_C(t)=s A e^{st}
\]
Substituting them into the DE, we get
\[
\tau sA e^{st} + Ae^{st}=(\tau s+1) Ae^{st}=0 
\]
As we are not interested in the trivial solution $Ae^{st}=0$, we must 
have
\[ 
\tau s+1=0,\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;\;s=-\frac{1}{\tau} 
\]
Now we get $v_C(t)=Ae^{-t/\tau}$ for $t\ge 0$. The constant coefficient 
$A$ can be obtained by the initial condition $v_C(0)=V_0$:
\[ 
v_C(0)=A e^{-t/\tau}\bigg|_{t=0}=A e^{0}=V_0,
\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;A=V_0	
\]
Now the homogeneous solution is found to be
\[
v_C(t)=V_0 e^{-t/\tau}		
\]
which decays to zero as $t\rightarrow\infty$:
\[
\lim_{t\rightarrow\infty} V_0 e^{-t/\tau}=0
\]
The same result can also be obtained by the
\htmladdnormallink{Laplace transform method}{../ch3_sub0/index.html}.

The current through $R$ and $C$ is
\[
i(t)=C\frac{d}{dt}\;v_C(t)=C\frac{d}{dt}\left(V_0 e^{-t/\tau}\right)
=-V_0 \frac{C}{\tau} e^{-t/\tau}=-\frac{V_0}{R} e^{-t/\tau}	
\]
The voltage across $R$ is 
\[
v_R(t)=i(t)R=-V_0 e^{-t/\tau}=-v_C(t)	
\]
This result can be verified by KVL: $v_C(t)+v_R(t)=v_s(t)=0$.

The time constant $\tau$ can be identified on the time plot of the general
first order response $v(t)=V_0 e^{-t/\tau}=e^{-t\tau}$ with $V_0=1$. Specifically
consider the derivative of $v(t)$ evaluated at $t=0$:
\[
\frac{d}{dt}v(t)\big|_{t=0}=-\frac{1}{\tau}e^{-t/\tau}\bigg|_{t=0}=-\frac{1}{\tau}
\]
This is the slope of the tangent line of $v(t)$ at $t=0$, and $\tau$ is its
intersection with the horizontal axis.

\htmladdimg{../figures/FirstOrderTau1.png}


\subsubsection*{Particular Solution}

{\bf RC circuit:}

When the input to the system represented by the term on the right-hand 
side of the DE is non-zero, the DE can be solved to find its particular 
or steady state solution. We first a constant input:
\[	
\tau\dot{v}_C(t)+v_C(t)=v_s(t)=V_S
\]
We assume $v_C(t)=c$ is a constant, and the DE becomes $c=V_s$, i.e.,
the solution is trivially $v_C(t)=V_s$. 

We then consider an complex exponential input:
\[	
\tau\dot{v}_C(t)+v_C(t)=v_s(t)=e^{j\omega t}=\cos(\omega t)+j\sin(\omega t)
\]
We assume
\[ 
v_C(t)=A\;e^{j\omega t},\;\;\;\;\;\frac{d}{dt}v_C(t)=j\omega A\;e^{j\omega t} 
\]
and substitute them back into the DE to get
\[
j\omega \tau A e^{j\omega t}+A e^{j\omega t}
=(j\omega \tau+1)A\; e^{j\omega t}=e^{j\omega t} 
\]
i.e.
\[
A=\frac{1}{j\omega\tau+1}=|A|e^{-j\phi},\;\;\;\;\mbox{where}
\;\;\;\;\;\;|A|=\frac{1}{\sqrt{\omega^2 \tau^2+1}},\;\;\;\;\;
\phi=\angle A=tan^{-1}\omega\tau
\]
and the solution is:
\[
A\;e^{j\omega t}=\frac{1}{\sqrt{\omega^2 \tau^2+1}} e^{j(\omega t-\phi)} 
\]
If the input is sinusoidal $v_s(t)=\cos(\omega t)=Re(e^{j\omega t})$,
then the solution of the DE can be found by taking the real part 
of the solution above, due to the linearity of the system
(superposition):
\[
v_C(t)=Re\left[\frac{1}{\sqrt{\omega^2 \tau^2+1}} e^{j(\omega t-\phi)}\right]
=\frac{1}{\sqrt{\omega^2 \tau^2+1}} \cos(\omega t-\phi)
\]

Alternatively, this RC circuit can also be solved more conveniently by
the phasor method, if only the steady state solution (the particular
solution) is of interest. The phasor of the input voltage 
$v(t)=\cos(\omega t)$ is simply 1, and the phasor of the voltage across
$C$ can be found by voltage divider:
\[
V_C=V\frac{Z_C}{Z_R+Z_C}=\frac{1/j\omega C}{R+1/j\omega C}
=\frac{1}{j\omega RC+1}=\frac{1}{j\omega \tau+1}
=\frac{1}{\sqrt{\omega^2\tau^2+1}} e^{-j\phi}
\]
where $\phi=\tan^{-1}\omega\tau$. Converting this into time domain
we get
\[
v_C(t)=Re[V_Ce^{j\omega t}]
=Re\left[\frac{1}{\sqrt{\omega^2\tau^2+1}}e^{j(\omega t-\phi)}\right]
=\frac{1}{\sqrt{\omega^2\tau^2+1}}\cos(\omega t-\phi)
\]

{\bf RL circuit:}

Given an RL circuit consisted of a resistor and an inductor in 
series connected to an AC voltage source $v(t)=\cos(\omega t)$, we
want to find the current $i(t)$. The governing DE describing the 
circuit can be obtained based on KVL:
\[
v_L(t)+v_R(t)=L\frac{d}{dt}i(t)+R\;i(t)=v(t)=\cos(\omega t)
\]
We first consider an complex exponential input:
\[	
L\frac{d}{dt}i(t)+Ri(t)=e^{j\omega t}
\]
We assume
\[ 
i(t)=A\;e^{j\omega t},\;\;\;\;\;\frac{d}{dt}i(t)=j\omega A\;e^{j\omega t} 
\]
and substitute them back into the DE to get
\[
j\omega L A e^{j\omega t}+RA e^{j\omega t}
=(R+j\omega L)A\; e^{j\omega t}=e^{j\omega t} 
\]
i.e.
\[
A=\frac{1}{R+j\omega L}=|A|e^{-j\phi},\;\;\;\;\mbox{where}
\;\;\;\;\;\;|A|=\frac{1}{\sqrt{R^2+\omega^2 L^2}},\;\;\;\;\;
\phi=\angle A=tan^{-1}\left(\frac{\omega L}{R}\right)	
\]
and the solution is:
\[
A\;e^{j\omega t}=\frac{1}{\sqrt{R^2+\omega^2 L^2}} e^{j(\omega t-\phi)} 
\]
The solution for the DE with input $v(t)=\cos \omega t$ is
\[
i(t)=Re\left[\frac{1}{\sqrt{R^2+\omega^2 L^2}} e^{j(\omega t-\phi)}\right]
=\frac{1}{\sqrt{R^2+\omega^2 L^2}} \cos(\omega t-\phi)
\]

Alternatively, this RL circuit can also be resolved by the phasor
method. Now the current $i(t)$ can be much more easily found by 
generalized Ohm's law. The phasor representation of the input voltage 
$v(t)=\cos(\omega t)$ is simply 1, and the overall complex impedance 
of the two elements in series is:
\[
Z=Z_R+Z_L=R+j\omega L=|Z| e^{j\angle Z}=\sqrt{R^2+\omega^2L^2}\;e^{j \phi} 
\]
where $\phi=tan^{-1}(\omega L/R)$. By generalized Ohm's law, 
the phasor representation of the current can be found as
\[
I=\frac{1}{\sqrt{R^2+\omega^2L^2}\;e^{j\phi}}
  =\frac{1}{\sqrt{R^2+\omega^2L^2}} e^{-j\phi}	
\]
and the real current is
\[
i(t)=Re\left[\frac{1}{\sqrt{R^2+\omega^2 L^2}}e^{-j\phi)}e^{j\omega t}\right]
=\frac{1}{\sqrt{R^2+\omega^2 L^2}}\cos(\omega t-\phi)	
\]
Note that in general, the {\em frequency response function (FRF)} of 
the system is defined as the ratio of the output to the input of the
system, both represented as complex exponentials. In this specific case,
we have
\[
H=\frac{{\bf I}}{{\bf V}}=\frac{1}{Z} 
\]
with 
\[
|H|=\frac{1}{\sqrt{R^2+\omega^2L^2}},\;\;\;\;\;\angle H=-\phi 
\]
Therefore the steady state output can be found to be:
\[
i(t)=|H| \cos(\omega t+\angle H)
=\frac{1}{\sqrt{R^2+\omega^2 L^2}}\cos(\omega t-\phi)	
\]
The second method, much easier than the first one, is actually a short 
cut representation of the first DE method. This is the justification of
the complex variable or phasor method for analyzing AC circuits. However,
note that the phasor method can only find the steady state solution. The
homogeneous differential equation will have to be solved to obtain the
transient solution.

\htmladdimg{../figures/phasorfigure.gif}


\subsubsection*{Complete Response I -- Constant Input}

The complete response of a non-homogeneous linear system due to both
the external input and the initial condition can be found as the sum of 
the homogeneous and particular solutions of the non-homogeneous DE with 
a non-zero right-hand side for the external input:
\[
\mbox{Complete Solution}=\mbox{Homogeneous Solution}+\mbox{Particular Solution}
\]
Specifically in the RC circuit, we have
\[
\tau\frac{d}{dt} v_c(t)+v_c(t)=v_s(t)=V_s
\]
We want to solve the DE for $v_C(t)$ as the circuit's complete response to the
input $v(t)\ne 0$ as well as the initial condition $v_C(0)=V_0\ne 0$, after a 
switch is closed at time moment $t=0$. 


\htmladdimg{../figures/RCcircuit.png}

Given an RC circuit shown above where the switch is closed at $t=0$,
we want to find the voltage $v_C(t)$ across $C$ and voltage $v_R(t)$ 
across $R$ as a function of time for $t>0$. 

First we consider a constant (DC) input $v(t)=V_s$ applied to the circuit 
at $t=0$, i.e., a step input 
\[
v(t)=V_s u(t) =\left\{ \begin{array}{ll}V_s & t\ge 0\\0 & t<0\end{array}\right. 
\]
The solution of this inhomogeneous DE is composed of two parts, 
\begin{itemize}
\item {\em Particular solution (forced response) }
  $v'_C(t)=v_C(t)|_{t\rightarrow \infty}=V_s$ due to the DC input $V_s$;
\item {\em Homogeneous solution (natural response) }: 
  $v''_C(t)=A e^{-t/\tau}$ due to the initial condition
  $v_C(t)\big|_{t=0}=v_C(0)=V_0$.
\end{itemize}
The complete solution is
\[
v_C(t)=v'_C(t)+v''_C(t)=V_s+A e^{-t/\tau}	
\]
The constant $A$ can be determined from the initial condition $v_C(0)=V_0$:
\[
v_C(0)=V_0=v_C(t)\big|_{t=0}=V_s+Ae^{0}=V_s+A,
\;\;\;\;\;\mbox{i.e.,}\;\;\;\;A=V_0-V_s	
\]
and the complete solution is
\[
v_C(t)=V_s+A e^{-t/\tau}=V_s+(V_0-V_s) e^{-t/\tau}	
\]
The same result can also be obtained using the 
\htmladdnormallink{Laplace transform method}{../ch3_sub0/index.html}.

In particular, if $v_C(0)=V_0=0$, the solution is
\[
v_C(t)=V_s+(-V_s) e^{-t/\tau}=V_s(1-e^{-t/\tau})		
\]

The current through $C$ is
\[
i(t)=C\frac{d}{dt}\,v_C(t)=-\frac{C}{\tau}(V_0-V_s)e^{-t/\tau}
=\frac{V_s-V_0}{R}e^{-t/\tau} 
\]
The voltage across $R$ is
\[ 
v_R(t)=R\; i(t)=(V_s-V_0) e^{-t/\tau} 
\]
We can further verify that
\[
v_C(t)+v_R(t)=V_s+(V_0-V_s) e^{-t/\tau}+(V_s-V_0) e^{-t/\tau} =V_s	
\]

The plots below show $v_C(t)$ (red) and $v_R(t)$ (green) under different
initial conditions (purple) and inputs (blue).

\begin{itemize}
\item $V_0=2$, $V_s=1$, i.e., $V_0>V_s$

  %\htmladdimg{../figures/first_order_response1.gif}
  \htmladdimg{../figures/FirstOrderResponse1.png}
\item $V_0=1$, $V_s=2$, i.e., $V_0<V_s$

  %\htmladdimg{../figures/first_order_response2.gif}
  \htmladdimg{../figures/FirstOrderResponse2.png}
\end{itemize}

Note that in the first case, after the switch is closed at $t=0$, 

\begin{itemize}
\item $v_R(t)$ takes a negative value if $v_C(0)=V_0>V_s$ for $t>0$, although
  the voltage source $V_s>0$ is positive (both measured with respective to 
  the bottom wire treated as the ground). This is because right after the
  switch is closed, the voltage on the left side of $C$ drops from 
  $V_0=2V$ to $V_s=1V$, causing the voltage on its right side to also drop 
  from $0$ to $-1V$, lower than the ground level of $0V$.
\item Voltages on both sides of $C$ go through a discontinuous transition to
  drop (case 1) or jump (case 2) by $V_S-V_0$, however, the voltage $v_C(t)$ 
  remains the same, as the voltage across $C$ does not change instantaneously. 
  $v_R(t)$ drops from $v_R(t)=0$ for $t<0$ to $v_R(t)=V_s-v_c(0)=V_s-V_0$ at 
  $t=0^+$, while $v_C(t)+v_R(t)$ (left side of $C$) drops from $V_0$ to $V_S$.
\end{itemize}

In general, neither the voltage across a capacitor nor the current through
an inductor can be changed instantaneously as it takes time for them to 
build up:
\[
v_C(t)=\frac{1}{C}\int i(t) dt,\;\;\;\;\;\;\;i_C(t)=\frac{1}{L}\int v(t) dtt
\]
Therefore the capacitor can behave like a temporary voltage source, and,
similarly, an inductor can behave like a temporary current source.


{\bf A Shortcut Method:}

Observing the complete solution $v_C(t)=V_s+(V_0-V_s) e^{-t/\tau}$ obtained
above, we see that
\begin{itemize}
\item When $t=0$, $v_C(t)=v_C(0)=V_0$ is the initial condition
\item When $t\rightarrow \infty$, $v_C(t)=v_C(\infty)=V_s$ is the steady 
  state response.
\end{itemize}

We can therefore generalize the complete solution obtained above to all 
first-order systems, i.e., their responses to a step input, a constant input 
that is turned on at moment $t=0$, always take the same form: 
\[
f(t)=f(\infty)+[f(0)-f(\infty)] e^{-t/\tau}	
\]
in terms of three essential components of the system's response:
\begin{itemize}
\item The steady state response $f(\infty)$: as discussed in previous 
  section for steady state response.
\item The initial value $f(0)$: 
  Denote the value of $f(t)$ immediately before and after the moment
  $t=0$ by $f(0_-)$ and $f(0_+)$, respectively. If $f(0_-)\ne f(0_+)$, 
  then use $f(0_+)$ for $f(0)$;
\item the time constant of the system $\tau$: When there is only one 
  resistor in the circuit, the time constant is $\tau=RC$ or $\tau=L/R$.
  When there are multiple resistors, the time constant can be found by:
  \begin{itemize}
  \item Remove $C$ or $L$ so that the rest of the circuit ($t>0$) is a 
    one port network.
  \item Find the equivalent resistance $R$ of the network by turning off 
    all energy sources (short-circuit for voltage source, open-circuit 
    for current source).
  \item Find time constant $\tau=RC$ or $\tau=L/R$.
  \end{itemize}
\end{itemize}

In particular, note that
\begin{itemize}
  \item when $t=0$, $f(t)=f(\infty)+f(0)-f(\infty)=f(0)$ the initial condition;
  \item when $t\rightarrow \infty$, $f(t)=f(\infty)$ the {\em steady state response};
  \item when $0 < t < \infty$, the difference $f(0)-f(\infty)$ between the initial 
    and the steady state values of the response decays exponentially. This term is 
    the {\em transient response} of the system.
\end{itemize}


{\bf Example 1:} $V_{in}=2\,V$, $R_1=R_2=2\,k\Omega$, $C=10^{-6}\,F=1\,\mu F$.
Find $v_C(t)$.

\htmladdimg{../figures/1stOrderRCa.png}


\begin{itemize}
\item Find initial value $v_C(0)=0$. 

\item Find steady state value $v_C(\infty)$:
  \[	
  v_C(\infty)=V_s\frac{R_2}{R_1+R_2}=\frac{V_s}{2} =1\,V
  \]
\item Find equivalent resistance $R$:
  \[
  R=R_1 || R_2=\frac{R_1 R_2}{R_1+R_2}=1\;k\Omega	
  \]
\item Find time constant 
  \[
  \tau=RC=1000\times 10^{-6}= 10^{-3}\,sec     
  \]
\item Find the complete response
  \[
  v_C(t)=v_C(\infty)+[v_C(0)-v_C(\infty)]e^{-t/\tau}
  =1+(0-1)e^{-t/10^{-3}}=1-e^{-1000\,t}
  \]
  In particular,
  \[
  v_C(0)=\left[1-e^{-1000\,t}\right]_{t=0}=0,\;\;\;\;\;
  v_C(\infty)=\left[1-e^{-1000\,t}\right]_{t=\infty}=1
  \]
\end{itemize}

{\bf Example 2:}

In the circuit below, $V_0=10V$, $R_1=R_2=2K\Omega$, $R_3=5K\Omega$, 
$C=0.5\mu F$, the circuit was in steady state at $t=0$. Find $v_C(t)$ 
after the switch is closed at $t=0$.

\htmladdimg{../figures/BridgeCapacitor.png}

\htmladdnormallink{\bf Solution}{../ch3_sub2/index.html}

{\bf Example 3:}

Resolve the circuit above using the short-cut method:
\begin{itemize}
\item Find initial value $v_C(0)$. As the circuit has been in steady 
  state before $t=0$, $v_C(0_-)=-5V$. Also, as voltage across $C$ 
  cannot change instantaneously (unless $R=0$ therefore $\tau=RC=0$), 
  we have $v_C(0_+)=v_C(0_-)=-5\,V$.

  At $t=0_+$, $V_d$ drops from $10\,V$ to $0\,V$, $V_c$ also drops 
  from $5\,V$ to $-5\,V$.
  
\item Find steady state value $v_C(\infty)$:
  \[
  v_C(\infty)=V_{R_2}=V_0\frac{R_2}{R_1+R_2}=\frac{V_0}{2}=5V	
  \]
\item Find equivalent resistance $R$:
  \[
  R=R_1 || R_2=\frac{R_1 R_2}{R_1+R_2}=1\;k\Omega	
  \]
\item Find time constant 
  \[
  \tau=RC=1000\times 0.5\times 10^{-6}=5\times 10^{-4}     
  \]
\item Find the complete response
  \[
  v_C(t)=v_C(\infty)+[v_C(0)-v_C(\infty)]e^{-t/\tau}
  =5+(-5-5) e^{-t/0.0005}=5-10 e^{-2000t}\;(V)	
  \]
  In particular,
  \[
  v_C(0)=\left[5-10 e^{-2000t}\right]_{t=0}=-5,\;\;\;\;\;
  v_C(\infty)=\left[5-10 e^{-2000t}\right]_{t=\infty}=5
  \]

\item Find current $i_C(t)$ through $C$:
  \begin{eqnarray}
    i_C(t)&=&C\frac{dv_C(t)}{dt}=C\frac{d}{dt}(5-10 e^{-t/\tau})
    =C\,\frac{10 e^{-t/\tau}}{\tau}=10 e^{-2000 t}\;(mA)	
    \nonumber \\
    &=&\frac{10 e^{-t/\tau}}{R}=10 e^{-2000 t}\;(mA)	
    \nonumber
  \end{eqnarray}
\item Find voltages $v_1(t)$ and $v_2(t)$ across $R_1$ and $R_2$,
  respectively:
  \[ 
  v_2(t)=v_C(t)=5-10 e^{-2000t}\;(V)	
  \]
  \[ 
  v_1(t)=V_0-v_C(t)=10-(5-10 e^{-2000t})=5+10 e^{-2000t} 
  \]
\item Find currents $i_1(t)$ and $i_2(t)$ through $R_1$ and $R_2$, 
  respectively:
  \[
  i_1(t)=\frac{v_1(t)}{R_1}=2.5+5 e^{-2000t} \; (mA)	
  \]
  \[
  i_2(t)=\frac{v_C(t)}{R_2}=2.5-5 e^{-2000t}\; (mA)	
  \]
\item Verify current $i_C(t)$:
  \[
  i_C(t)=i_1(t)-i_2(t)=10 e^{-2000t} \; (mA)	
  \]
\end{itemize}

%\htmladdimg{../figures/completeresponse.gif}

{\bf Example 4:}

In the same circuit above, find the voltages $v_1(t)$ and $v_2(t)$ 
across and currents $i_1(t)$ and $i_2(t)$ through $R_1$ and $R_2$, 
respectively.

\htmladdimg{../figures/BridgeCapacitor.png}

\begin{itemize}
\item Find $v_1(\infty)=v_2(\infty)=5\;V$
\item Find $v_1(0_+)$ and $v_2(0_+)$. Before $t=0$, the circuit is in
	steady state, i.e., $v_1(0_-)=v_2(0_-)=5\;V$. However, after
	the switch closes at $t=0$, the voltage at node d drops from 
	10V to 0V (with respect to node b as ground), and the voltage 
        at node c drops from 5V to -5V (voltage across a capacitor 
        cannot change instantaneously), i.e., $v_1(0_+)=15V$ and 
        $v_2(0_+)=-5V$; 
\item Find $\tau=RC=5\times 10^{-4}$ (same as before);
\item Find $v_1(t)$ and $v_2(t)$:
  \[	v_1(t)=v_1(\infty)+[v_1(0_+)-v_1(\infty)]e^{-t/\tau}
	=5+(15-5)e^{-t/\tau}=5+10e^{-t/\tau}\;V	\]
  \[	v_2(t)=v_2(\infty)+[v_2(0_+)-v_2(\infty)]e^{-t/\tau}
	=5+(-5-5)e^{-t/\tau}=5-10e^{-t/\tau}\;V	\]
	We see that $v_1(t)+v_2(t)=V_0=10V$.
\item Find $i_1(t)$ and $i_2(t)$ through $R_1$ and $R_2$:
  \[	i_1(t)=\frac{v_1(t)}{R_1}=2.5+5e^{-t/\tau}\;mA	\]
  \[	i_2(t)=\frac{v_2(t)}{R_2}=2.5-5e^{-t/\tau}\;mA	\]
\item Find current $i_C(t)$ through capacitor $C$:
  \[    i_C(t)=i_1(t)-i_2(t)=10 e^{-t/\tau}\; mA  \]
\end{itemize}
Note that when $t=0_+$, $v_2(t)=V_c=-5V$, lower than ground voltage $V_b$!

\htmladdimg{../figures/transientDCexample.gif}

\begin{comment}

{\bf Example 2}

In the circuit below, $V_0=10\,V$, $R_1=R_2=2\,k\Omega$, $R_3=1\,k\Omega$,
$L=1\,mH$, the circuit was in steady state at $t=0$. Find $i_L(t)$ and 
$v_L(t)$ after the switch is closed at $t=0$.

\htmladdimg{../figures/BridgeL1.png}

\begin{itemize}
\item Find $i_L(0_-)=i_L(0_+)$ (current through an inductor cannot be 
  changed instantaneously):
  \[
  i_L(0_-)=\frac{1}{2}\frac{V_0}{R_1||R_2+R_3}=\frac{10}{2\times2}=2.5\,mA
  \]
\item Find $i_L(\infty)$:
  \[
  i_L(\infty)=-\frac{V_0}{R_2}=-5\,mA
  \]
\item Find $\tau$:
  \[
  R=R_2||R_3=2||1=\frac{2}{3}\;k\Omega,\;\;\;\;\;\;\;\;
  \tau=\frac{L}{R}=\frac{3\times 10^{-3}}{2\times 10^3}
  =1.5\times 10^{-6}
  \]
\end{itemize}
\[
i_L(t)=i_L(\infty)+[i_L(0)-i_L(\infty)]e^{-t/\tau}=-5+7.5e^{-t/\tau}\;mA
\]
and
\[
v_L(t)=L\frac{di_L(t)}{dt}=-\frac{L}{L/R}7.5e^{-t/\tau}=-R\,7.5e^{-t/\tau}
=-\frac{2}{3}7.5e^{-t/\tau}=-5e^{-t/\tau}\;V
\]
In particular, $v_L(0)=-5\,V$ (note the polarity!)

Also, the currents through $R_1$, $R_2$, and $R_3$ are respectively:
\begin{itemize}
\item $i_1(0_+)=5$, $i_1(\infty)=5$, $i_1(t)=5$
\item $i_2(0_+)=2.5$, $i_2(\infty)=5$, $i_2(t)=5+(2.5-5)e^{-t/\tau}=5-2.5e^{-t/\tau}$
\item $i_3(0_+)=5$, $i_3(\infty)=0$, $i_3(t)=5e^{-t/\tau}$
\end{itemize}
Alternatively we can find
\[
i_3(t)=i_2(t)+i_L(t)=5-2.5e^{-t/\tau}-5+7.5e^{-t/\tau}=5e^{-t/\tau}
\]

\htmladdimg{../figures/transientDCexample2.png}


{\bf Example 3}

In the circuit below, $V=10\,V$, $R=1\,k\Omega$, $C=1\,\mu F$. The
voltage across $C$ is $v_C(t)=0$ for $t<0$. Switch $S_1$ is closed at $t=0$ 
and switch $S_2$ is closed at $t=1\,ms$. Find $v_C(t)$ for $t>0$.

\htmladdimg{../figures/RC2Switch.png}

\begin{itemize}
\item For $0<t<1\,ms$, $v_C(0)=0$, $v_C(\infty)=10\,V$, and
  $\tau_1=RC=10^{-3}\,sec$, and we get
  \[ 
  v_C(t)=V\,(1-e^{-t/\tau_1})=10(1-e^{-1000\,t})
  \]
  In particular, at $t=1\,ms$, $v_C(10^{-3})=10(1-e^{-1})=6.321$
\item For $1\,ms<t$, $v_C(10^{-1})=6.312$, $v_C(\infty)=5$, 
  $\tau_2=CR/2=0.5\times 10^{-3}=2\times 10^3$
  \[
  v_C(t)=5+(6.321-5)\,e^{-t/\tau_2}=5+1.321 e^{-2000\,t}
  \]
\end{itemize}
\end{comment}


\subsubsection*{Complete Response II -- Sinusoidal Input}

If the input voltage to the RC circuit considered previously is sinusoidal 
$v(t)=V_s \cos(\omega t+\psi)$, then the DE becomes
\[
v_R(t)+v_C(t)=\tau\frac{d}{dt} v_c(t)+v_c(t)=V_s \cos(\omega t+\psi)	
\]
The homogeneous solution is the same as before $v_h(t)=A e^{-t/\tau}$,
and the particular solution $v_p(t)$ as the steady state response to 
$v(t)$ can be found by the phasor method. The input is 
\[
v(t)=V_s \cos(\omega t)=Re[\dot{V} e^{j\omega t}]	
\]
where $\dot{V}=V_s\; e^{j\psi}$ is the phasor form of the voltage.
The steady state voltage across $C$ is (voltage divider)
\begin{eqnarray}
  \dot{V}_C&=&\dot{V} \frac{Z_C}{R+Z_C}
  =\dot{V} \frac{1/j\omega C}{R+1/j\omega C}=\frac{\dot{V}}{j\omega \tau+1}	
  =\frac{\dot{V}}{\sqrt{(\omega \tau)^2+1}\;e^{j\phi}} 
  \nonumber \\
  &=&\frac{\dot{V}\;e^{-j\phi}}{\sqrt{(\omega \tau)^2+1}} 
  =\frac{V_se^{j\psi}\;e^{-j\phi}}{\sqrt{(\omega \tau)^2+1}} 
  =\frac{V_se^{j(\psi-\phi)}}{\sqrt{(\omega \tau)^2+1}} 
\nonumber
\end{eqnarray}
where $\phi=\tan^{-1} \omega \tau$. In time domain the steady state 
voltage $v_p(t)$ is:
\begin{eqnarray}
  v_p(t)&=&Re\left[\dot{V}_C e^{j\omega t} \right]
  =Re\left[ \frac{V_s e^{j(\psi-\phi)} e^{j\omega t}}{\sqrt{(\omega \tau)^2+1}} \right]
  = \frac{V_s}{\sqrt{(\omega \tau)^2+1}} \cos(\omega t+\psi-\phi)
  \nonumber\\
  &=&|H(\omega)|V_s\cos(\omega t+\psi-\angle H(\omega))
  \nonumber
\end{eqnarray}
where $H(\omega)=Z_C/(Z_C+Z_R)$ is the {\em frequency response function 
(FRF)} of the system. Note that this steady state output is simply the 
input $v(t)=V_S\cos(\omega t+\psi)$ scaled by the magnitude of the FRF
$|H(\omega)|=1/\sqrt{(\omega\tau)^2+1}$ with a phase shift equal to the 
phase of the FRF $\angle H(\omega)=-\phi$.

The complete solution is then the sum of the homogeneous and particular
solutions:
\[
v_C(t)=v_h(t)+v_p(t)=
\frac{V_s}{\sqrt{(\omega \tau)^2+1}}\cos(\omega t+\psi-\phi)+A e^{-t/\tau} 
\]
From the initial condition $v_C(0)=V_0$, we have
\[
v_C(t)\bigg|_{t=0}=v_C(0)
=V_0=\frac{V_s}{\sqrt{(\omega \tau)^2+1}}\cos(\psi-\phi)+A 
\]
Solving for $A$ we get
\[
A=V_0-\frac{V_s}{\sqrt{(\omega \tau)^2+1}}\cos(\psi-\phi) 
\]
Substituting $A$ back to the expression of $v_C(t)$, we get 
\[
v_C(t)=\frac{V_s}{\sqrt{(\omega \tau)^2+1}}\cos(\omega t+\psi-\phi)+ 
\left[V_0-\frac{V_s}{\sqrt{(\omega \tau)^2+1}}\cos(\psi-\phi)\right] e^{-t/\tau}	
\]
The same result can also be obtained using the 
\htmladdnormallink{Laplace transform method}{../ch3_sub0/index.html}.

%http://ilin.asee.org/Conference2015/papers/Al-Olimat.pdf
Again we consider a short-cut method, by generalizing the result above to 
\[
f(t)=f_{\infty}(t)+[f(0)-f_{\infty}(0)]e^{-t/\tau} 
\]
in terms of three essential components
\begin{enumerate}
\item $f(0)$: the initial value (same as before);
\item $f_{\infty}(t)$: the steady state response, and
  $f_{\infty}(0)=f_{\infty}(t)\big|_{t=0}$ is $f_{\infty}(t)$ evaluated 
  at $t=0$;
\item $\tau$: the time constant of the system (same as before).
\end{enumerate}
Note that when the input $V_s$ is a constant, the steady state response
$f(\infty)$ is a constant, but when the input $V_s\cos(\omega t+\psi)$
is sinusoidal, the steady state response $f_{\infty}(t)$ is a function of 
time $t$, but its evaluation at $t=0$ $f_{\infty}(0)=f_{\infty}(t)\big|_{t=0}$ 
is still a constant. We see that the complete response is composed of 
the steady state response and the exponential decay of the difference 
between the initial value $f(0)$ and the steady state response evaluated
at $t=0$.

If the initial voltage on $C$ is zero $V_0=0$, then
\[
v_C(t)=\frac{V_s}{\sqrt{(\omega \tau)^2+1}}[\cos(\omega t+\psi-\phi) 
-\cos(\psi-\phi) e^{-t/\tau}]	
\]

Note that the initial magnitude of the transient component at $t=0^+$
varies depending on the angle $\psi-\phi$. 
\begin{itemize}
\item If $\psi-\phi=\pm 90^\circ$, then $\cos(\psi-\phi)=0$, and the 
  transient component disappears altogether.
\item If $\psi-\phi=0^\circ$ or $180^\circ$, then $\cos(\psi-\phi)=\pm 1$,
  i.e., the magnitude of the transient component reaches maximum (either 
  positive or negative), and if $\tau$ value is large and therefore the 
  transient component decays slowly, the magnitude of the initial voltage
  $v_C(t)$ could be close to three times the peak of the steady state. 
\item In all other cases, the amplitude of the transient component is
  between 0 in the first case and the maximum value in the second case.
\end{itemize}

The three cases for $\psi-\phi$ to be $0^\circ$, $90^\circ$, and $180^\circ$
are shown below:

\htmladdimg{../figures/first_order_response.gif}
\htmladdimg{../figures/first_order_response_0.gif}
\htmladdimg{../figures/first_order_response_90.gif}
\htmladdimg{../figures/first_order_response_180.gif}

{\bf Example 2:}

An electromagnet, modeled by a resistor $R=20\Omega$ and $L=0.3H$,
is powered by sinusoidal voltage of $120V$ and $60Hz$. Find the current
through the circuit when the switch is closed at $t=0$ when the phase
angle happens to be $\psi=10^\circ$, i.e., $v(t)=120\sqrt{2}\;
\cos(6.28\times 60 t+10^\circ)$.

\begin{itemize}
\item Find initial value: $i(0)=0$. 
\item Find impedance of circuit:
\[ Z=R+j\omega L=20+j6.28\times 60 \times 0.3=20+j113=114.8\angle{80^\circ}	\]
\item Find steady state value $i_\infty(t)$ by phasor method:
\[
\dot{V}=120 \angle{10^\circ},\;\;\;\;\dot{I}=\frac{\dot{V}}{Z}
=\frac{120\angle{10^\circ}}{114.8\angle{80^\circ}}
=1.05\angle{-70^\circ}	\]
\[ i_\infty(t)=1.05\sqrt{2}\;\cos(6.28\times 60 t -70^\circ) \]
\[ i_\infty(0)=1.05\sqrt{2}\;\cos(-70^\circ)
=1.05\sqrt{2}\times 0.342=0.51	\]
\item Find time constant $\tau=L/R=0.3/20=0.015$.
\item Find current
\[	i(t)=i_{\infty}(t)+[i(0)-i_{\infty}(0)]e^{-t/\tau}
      =1.05\sqrt{2}\;\cos(6.28\times 60 t -70^\circ)-0.51 e^{-t/0.015}	\]

\end{itemize}

\htmladdimg{../figures/electromagnet1.gif}



\subsection*{Second Order Systems}

\htmladdimg{../figures/RCLParallelSeries.png}

\begin{itemize}
\item The RCL series circuit (left) with an input $v(t)$ and output $i(t)$
  is described by the following equation:
  \[ 
  v_R(t)+v_L(t)+v_C(t)=R\,i(t)+L\frac{di(t)}{dt}+\frac{1}{C}\int i(t) dt=v_s(t)
  \]
  Taking derivative and dividing by $L$ on both sides we get a 2nd-order
  linear constant coefficient differential equation (LCCDE):
  \[
  i''(t)+\frac{R}{L}\,i'(t)+\frac{1}{LC}\,i(t)=\frac{1}{L}\dot{v}_s(t) 
  \]
  Alternatively, as $i(t)=C dv_C(t)/dt$, we have
  \[ 
  v_R(t)=R\;i(t)=R\,C\frac{d\,v_C(t)}{dt},\;\;\;\;\;\;
  v_L(t)=L\frac{d}{dt}i(t)=L\frac{d}{dt}\left[C\frac{d\,v_C(t)}{dt} \right]
  =LC\frac{d^2\,v_C(t)}{dt^2}
  \]
  the equation above can be written as a 2nd order ODE in terms of $v_C(t)$:
  \[ 
  v''_C(t)+\frac{R}{L} v'_C(t)+\frac{1}{LC}v_C(t)
  =\frac{1}{LC}v_s(t)
  \]
\item The RCL parallel circuit (right) with input $i(t)$ and output $v(t)$
  is described by the following equation:
  \[
  i_R(t)+i_C(t)+i_L(t)=\frac{v(t)}{R}+C\frac{dv(t)}{dt}+\frac{1}{L}\int v(t)\;dt 
  =i_s(t) 
  \]
  Taking derivative and dividing by $C$ on both sides we get a 2nd-order 
  LCCDE:
  \[
  v''(t)+\frac{1}{RC}\,v(t)+\frac{1}{LC}\,v(t)=\frac{1}{C}\dot{i}_a(t) 
  \]

\item Other RCL circuits (not pure series or parallel):

  \htmladdimg{../figures/RLCcircuits1.png}
  \[
  \frac{v_s-v}{R} = C\frac{dv}{dt}+\frac{1}{L} \int v\;dt,
  \;\;\;\;\;
  \frac{1}{L}\int (v_s-v)dt = \frac{v}{R}+C\frac{dv}{dt},
  \;\;\;\;\;
  C\frac{d}{dt} (v_s-v) = \frac{v}{R}+\frac{1}{L} \int v\;dt
  \]
  \[
  v''+\frac{1}{RC} v'+\frac{1}{LC}v=\frac{\dot{v}_s}{RC},
  \;\;\;\;\;\;\;
  v''+\frac{1}{RC} v'+\frac{1}{LC}v=\frac{1}{LC}v_s,
  \;\;\;\;\;\;\;
  v''+\frac{1}{RC} v'+\frac{1}{LC}v=v''_s
  \]
\end{itemize}

The dimensionality of the coefficient of the first order term is
frequency:
\[
\left[\frac{R}{L}\right]=\frac{[V][/[I]}{[VT]/[I]}=\frac{1}{[T]},
\;\;\;\;
\left[\frac{1}{RC}\right]=\frac{[I]}{[V]}\frac{[V]}{[I][T]}=\frac{1}{[T]}
\]
The dimensionality of the coefficient of the constant terms is
frequency squared:
\[
\left[\frac{1}{LC}\right]=\frac{1}{[VT]/[I]\;[IT]/[V]}=\frac{1}{[T]^2}
\]

In general, any 2nd-order LCCDE with input $x(t)$ and output $y(t)$
can be written in the {\em canonical form}
\[ 
y''(t)+2\zeta\omega_n\,y'(t)+\omega_n^2\, y(t)= x(t) 
\]
in terms of the two parameters:
\begin{itemize}
\item {\em damping coefficient} $\zeta$ (unitless)
\item {\em natural frequency} $\omega_n$ (frequency)
\end{itemize}
Comparing the canonical form with two equations above we see that
for both RLC series and parallel circuits:
\[
\omega_n=\frac{1}{\sqrt{LC}}
\]
and
\begin{itemize}
\item for RLC series circuit
  \[
  \frac{R}{L}=2\zeta_s\omega_n=2\zeta_s\frac{1}{\sqrt{LC}},\;\;\;\;\mbox{i.e.}\;\;\;\;\;
  \zeta_s=\frac{R}{2}\sqrt{\frac{C}{L}}
  \]
\item for RLC parallel circuit
  \[
  \frac{1}{RC}=2\zeta_p\omega_n=2\zeta_p\frac{1}{\sqrt{LC}},\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;
  \zeta_p=\frac{1}{2R}\sqrt{\frac{L}{C}}
  \]  
\end{itemize}
We also have:
\[
\zeta_p \zeta_s=\frac{1}{4},\;\;\;\;\;\zeta_p=\frac{1}{4\zeta_s},
\;\;\;\;\;\zeta_s=\frac{1}{4\zeta_p}
\]

Note the following dimensionalities:
\[ 
\left[\sqrt{\frac{L}{C}}\right]=\sqrt{\frac{[Henry]}{[Farad]}}
=\sqrt{\frac{[Volt]\;[second]}{[Ampere]}\frac{[Volt]}{[second]\;[Ampere]}}
=\frac{[Volt]}{[Ampere]}=[Ohm] 
\]

\[ 
\left[ \sqrt{LC} \right]=\sqrt{[Henry]\;[Farad]}
=\sqrt{\frac{[Volt]\;[second]}{[Ampere]}\frac{[Ampere]\;[second]}{[Volt]}}
=[second]
\]
We therefore see that $\zeta_s$ and $\zeta_p$ are unitless, and the
dimension of $\omega_n=1/\sqrt{LC}$ is $1/[second]$ as frequency.
\begin{comment}
  \[ 
  \left[\sqrt{\frac{L}{C}}\right]=\sqrt{\frac{H}{F}}
  =\sqrt{\frac{V\;s}{A}\;\;\frac{V}{s\;A}}=\frac{V}{A}=\Omega
  \]
  \[ 
  \left[\sqrt{LC}\right]=\sqrt{H\; F}=\sqrt{ \frac{V\;s}{A} \frac{A\;s}{V} }
  =s
  \]
\end{comment}



\subsubsection*{Particular Solution and Resonance}

If only the steady state response of a second order system is of interest, 
then we can ignore the homogeneous solution due to the initial condition 
and consider only the particular solution due to the input. To do so, we
convert the 2nd order DE into an algebraic equation in terms of the 
impedances of the components. In the following, we consider first the 
series system and then the parallel system.

{\bf Series system:} The overall impedance of the three elements is
\[ 
Z=R+j\omega L+\frac{1}{j\omega C}=R+j\left(\omega L-\frac{1}{\omega C}\right)
=|Z|e^{j\angle Z}	
\]
where 
\[ 
|Z|=\sqrt{R^2+\left(\omega L-\frac{1}{\omega C}\right)^2}
=\left\{ \begin{array}{rl} 
\infty & \omega=0\;\; (Z_C=\infty,\;\mbox{capacitive})\\ 
R & \omega=1/\sqrt{LC}\;\; (Z_C+Z_L=0,\;\mbox{resistive})\\
\infty & \omega \rightarrow \infty\;\; (Z_L=\infty,\;\mbox{inductive})
\end{array} \right. 
\]
\[
\angle Z=tan^{-1} \left(\frac{\omega L-1/\omega C}{R}\right)
=\left\{ \begin{array}{rl} -90^\circ & \omega=0\;\; (Z_L=0,\;\mbox{capacitive})\\ 
0^\circ & \omega=1/\sqrt{LC}\;\; (Z_C+Z_L=0,\;\mbox{resistive})\\
90^\circ & \omega \rightarrow \infty\;\; (Z_C=0,\;\mbox{inductive})
\end{array} \right. 
\]

\htmladdimg{../figures/impedanceRCL1.gif}

When the frequency is the same as the {\em natural frequency}
$\omega=\omega_n=1/\sqrt{LC}$, the impedances of the capacitor and 
the inductor have the same magnitude but opposite phase, and their 
vector sum is zero:
\[
Z_L=j\omega_nL=j\sqrt{\frac{L}{C}},\;\;\;\;\;\;
Z_C=\frac{1}{j\omega_nC}=-j\sqrt{\frac{L}{C}},\;\;\;\;\;
Z_L+Z_C=0
\]
and the current $\dot{I}=\dot{V}/Z=\dot{V}/R$ is maximized. Also, as
$\angle Z=0$, the current $\dot{I}$ and voltage $\dot{V}$ are in phase. 

Now the total impedance is real and minimized (admittance is maximized):
\[
Z=Z_R+Z_C+Z_L=Z_R=R 
\] 
The impedance $Z=Z_R+R_L+Z_C$ as a function of $\omega$ is shown below:

\htmladdimg{../figures/omega0c.gif}

The {\em quality factor} of this series RCL 2nd order system is defined as
\begin{eqnarray}
  Q_s&\stackrel{\triangle}{=}&\frac{\mbox{Magnitude of inductor/capacitor impedance at $\omega_n$}}{Resistance}
  \nonumber \\
  &=&\frac{|Z_L|}{R}=\frac{\omega_nL}{R}=\frac{L}{R\sqrt{LC}}
  =\frac{1}{R}\sqrt{\frac{L}{C}}=\frac{1}{2\zeta_s}
  \nonumber \\
  &=&\frac{|Z_C|}{R}=\frac{1}{\omega_nCR}=\frac{\sqrt{LC}}{RC}
  =\frac{1}{R}\sqrt{\frac{L}{C}}=\frac{1}{2\zeta_s}
  \nonumber
\end{eqnarray}

Consider the voltages across the three components at 
resonance when $\omega=\omega_n=1/\sqrt{LC}$:
\[
\dot{V}_R=\dot{I} Z_R =\frac{\dot{V}}{R} \;R=\dot{V}
\]
\[ 
\dot{V}_L=\dot{I} Z_L=\frac{\dot{V}}{R}\;j\omega_n L
=j\frac{\dot{V}}{R}\;\frac{L}{\sqrt{LC}}
=j\,\dot{V} \frac{1}{R}\sqrt{\frac{L}{C}}=jQ_s\dot{V}	
\]
\[ 
\dot{V}_C=\dot{I} Z_C=\frac{\dot{V}}{R}\;\frac{1}{j\omega_n C}
=-j\,\frac{\dot{V}}{R}\;\frac{\sqrt{LC}}{C}
=-j\,\dot{V}\;\frac{1}{R}\sqrt{\frac{L}{C}}=-jQ_s\dot{V}	
\]
In conclusion,
\begin{itemize}
\item The voltage across $R$ is equal to the source voltage
  $\dot{V}_R=\dot{V}$
\item The voltages across $L$ and $C$ have the same magnitude, which 
  is $Q_s$ times the input voltage $|\dot{V}_L|=|\dot{V}_C|=Q_s\dot{V}$
\item The voltage across $L$ and $C$ have opposite phases: 
  $\angle V_L=-\angle V_C$.
\end{itemize}
We see that $\dot{V}_L=-\dot{V}_C$, i.e., $V_L$ and $V_C$ have 
opposite polarities and they cancel each other.

\begin{comment}
and the admittances $Y=1/Z$ for different $Q$ ($R$) and $C$ are shown below.
The bandpass effect can be intuitively explained. When $\omega$ is high,
the inductor's impedance $\omega L$ is high, and when $\omega$ is low,
the capacitor's impedance $1/\omega C$ is high. When $\omega=\omega_n$
the overall impedance is the smallest. If the input is a voltage source 
$v(t)$, the current through the circuit will reach a maximum value when 
$\omega=\omega_n$.

\htmladdimg{../figures/omega0b.gif}
\htmladdimg{../figures/omega0a.gif}
\end{comment}

{\bf Example: } In a series RLC circuit, $R=5\Omega$, $L=4\;mH$ and
$C=0.1\;\mu F$. The natural frequency $\omega_n$ can be found to be
$\omega_n=1/\sqrt{LC}=1/\sqrt{4\times 10^{-3}\times 10^{-7}}=5\times 10^4$.
The quality factor is
\[	
Q_s=\frac{\omega_nL}{R}=\frac{(5\times 10^4)\times (4\times 10^{-3})}{5}
=40	
\]
or
\[
Q_s=\frac{1}{\omega_nCR}=\frac{1}{(5\times 10^4)\times 10^{-7}\times 5}
=40	
\]
If the input voltage is $V_{rms}=10V$ at the natural frequency, the current
is $I=V/R=10/5=2 A$, and the voltages across each of the elements are:
\begin{itemize}
\item $\dot{V}_R=R\dot{I}=V=10V$
\item $\dot{V}_L=j\omega L \dot{I}=j5\times 10^4\times 4\times 10^{-3} \times 2=j400V=jQ_sV$
\item $\dot{V}_C=\dot{I}/j\omega_nC=-j2/(5\times 10^4\times 0.1\times 10^{-6})=-j400V=-jQ_sV$
\end{itemize}
Note that although input voltage is $10V$, the voltage across L and C ($Q$ 
times the input) could be very high, but they are in opposite phase and 
therefore cancel each other).


{\bf Parallel system:} 

\htmladdimg{../figures/impedanceRCL2.gif}

The overall admittance of the three elements in parallel is
\[ 
Y=G+j\omega C+\frac{1}{j\omega L}=G+j\left(\omega C-\frac{1}{\omega L}\right)
=|Y|e^{j\angle Y}	
\]
where
\[
|Y|=\sqrt{G^2+\left(\omega C-\frac{1}{\omega L}\right)^2},\;\;\;\;
\angle Y=tan^{-1} \left(\frac{\omega C-1/\omega L}{G}\right) 
\]
In particular when $\omega=\omega_n=1/\sqrt{LC}$, we have 
$\omega C=1/\omega L$, and the total admittance is minimized
(impedance is maximized):
\[ 
Y=Y_R+Y_C+Y_L=G+j\left(\omega C-\frac{1}{\omega L}\right)=G 
\]
and the voltage $\dot{V}=\dot{I}/Y=\dot{I}/G$ is maximized. Also, as 
$\angle Y=0$, the voltage $\dot{V}$ and current $\dot{I}$ are in phase.

The {\em quality factor} $Q_p$ of this parallel RCL 2nd order system is 
defined as
\begin{eqnarray}
  Q_p&\stackrel{\triangle}{=}&
  \frac{\mbox{magnitude of inductor/capacitor susceptance at $\omega_n$}}{G}
  \nonumber \\
  &=&\frac{|Y_L|}{G}=\frac{1}{\omega_nLG}=\frac{\sqrt{LC}}{LG}
  =R\sqrt{\frac{C}{L}}=\frac{1}{2\zeta_p}
  \nonumber \\
  &=&\frac{|Y_C|}{G}=\frac{\omega_n C}{G}=\frac{C}{\sqrt{LC}G}
  =R\sqrt{\frac{C}{L}}=\frac{1}{2\zeta_p}
  \nonumber
\end{eqnarray}
We note that $Q_p$ of the parallel RCL circuit is the reciprocal of $Q_s$ of
the series RCL circuit:
\[ 
\frac{1}{Q_s}=Q_p,\;\;\;\;\;\;\frac{1}{Q_p}=Q_s
\]
When $\omega=\omega_n=1/\sqrt{LC}$, the voltage is 
$\dot{V}=\dot{I}/Y=\dot{I}/G=\dot{I}R$
and the currents through the three components are:
\begin{itemize}
\item 
\[
\dot{I}_R=\dot{V}Y_R=\dot{V}G=\frac{\dot I}{G} G=\dot{I},
\]
\item 
\[
\dot{I}_C=\dot{V} Y_C=\dot{I}R\;j\omega_n C=j\dot{I}R\frac{C}{\sqrt{LC}}
=j \dot{I} R\;\sqrt{\frac{C}{L}}=jQ\dot{I}	
\]
\item 
\[
\dot{I}_L=\dot{V} Y_L=\dot{I}R\;\frac{1}{j\omega_n L}
=-j\dot{I}R\frac{\sqrt{LC}}{L}=-j \dot{I} R\;\sqrt{\frac{C}{L}}=-jQ\dot{I}	
\]
\end{itemize}
We see that 
\begin{itemize}
\item The current through $R$ is equal to the source current: 
  $\dot{I}_R=\dot{I}$;
\item The currents through $L$ and $C$ have the same magnitude, 
  which is $Q_p$ times the input current: 
  $|\dot{I}_L|=|\dot{I}_C|=Q_p\dot{I}$
\item The currents through $L$ and $C$ have opposite phases:
  $\angle I_L=-\angle I_C$. 
\end{itemize}
We see that $\dot{I}_L=-\dot{I}_C$, i.e., $I_L$ and $I_C$ have 
opposite directions, they form a loop current through $L$ and $C$.

The concept of the quality factor $Q$ of a second order RCL circuit 
can be generalized to describe any second or higher order system. 
Specifically, the quality factor of a system is defined as the ratio
between the energy stored in the system and the energy dissipated by 
the system:
\[
Q=2\pi\frac{\mbox{Maximum energy stored}}{\mbox{Energy dissipated per cycle}}
\]
In the case of the series RCL circuit, this is the ratio between 
the energy stored in $C$ and $L$ (proportional to $\omega L$ and 
$1/\omega C$) and the energy dissipated by $R$ (proportional to
$R$) per period $T=1/f=2\pi/\omega$ at the natural frequency 
$\omega=\omega_n=1/\sqrt{LC}$. Consider the maximum energy stored
in $L$:
\[	
W_L=\int_0^T i(t)\; v(t) dt=\int_0^T i(t) \,L \frac{di(t)}{dt} dt
=L \int_0^{I_p} i \;di=\frac{1}{2}LI_p^2=LI^2_{rms}	
\]
and the maximum energy stored in $C$:
\[
W_C=\int_0^T v(t)\; i(t) dt=\int_0^T v(t) \,C \frac{dv(t)}{dt} dt
=C \int_0^{V_p} v \;dv=\frac{1}{2}CV_p^2=CV^2_{rms}	
\]
where $I_p=\sqrt{2}I_{rms}$ is the peak current through $L$, and
$V_p=\sqrt{2}V_{rms}$ is the peak voltage across $C$. 

At the natural frequency $\omega_n=1/\sqrt{LC}$, $|Z_C|=|Z_L|$, 
$|V_C|=|V_L|$, and the capacitor and the inductor store the same 
amount of energy:
\[
W_L=LI^2_{rms}=L \left( \frac{V_{rms}}{\omega_nL}\right)^2
=L\frac{V^2_{rms}LC}{L^2}=CV^2_{rms}=W_C 
\]
The energy $W_L=W_C$ is converted back and forth between magnetic 
energy in $L$ and electrical energy in $C$. The energy dissipated 
in $R$ per cycle $T_0=2\pi/\omega_n=1/f_0$ is:
\[
W_R=T_0\;P_R = T_0\;I^2_{rms} R 
\]
Following the general definition of the quality factor $Q$ above,
we have
\[
Q=2\pi\frac{W_L}{W_R}=2\pi\frac{LI^2_{rms}}{T_0I^2_{rms}R }
=2\pi f_0\frac{L}{R}=\frac{\omega_nL}{R}=\frac{1}{\omega_nCR}
\]
which is the same as the $Q$ previously defined.

The quality factor $Q$ and the damping coefficient $\zeta$ are inversely
related to each other:
\[
Q_p=\frac{1}{2\zeta_p},\;\;\;\;\;\;\;\mbox{and}\;\;\;\;\;\;\;
Q_s=\frac{1}{2\zeta_s}
\]
The quality factor can also be used to judge whether a second order system 
is under, critically or over damped. Qualitatively, a greater $Q$ or a smaller
$\zeta$ indicates that the system is energetic, active, and responsive, while 
on the other hand, a smaller $Q$ or a greater $\zeta$ indicates that the
system is sluggish, inactive, and irresponsive. 

\[
\begin{array}{c||c||c} \hline 
\zeta<1 & Q>0.5 & \mbox{under damped} \\\hline
\zeta=1 & Q=0.5 & \mbox{critically damped} \\\hline
\zeta>1 & Q<0.5 & \mbox{over damped} \\ \hline
\end{array}
\]

%\begin{tabular}{c|c|c} \hline 
%$\zeta<1$ & $Q>0.5$ & under damped \\
%$\zeta=1$ & $Q=0.5$ & critically damped \\
%$\zeta>1$ & $Q<0.5$ & over damped \\ \hline
%\end{tabular}

\subsubsection*{Homogeneous Solution}



The homogeneous solution of the 2nd order DE can be found
by solving the homogeneous equation:
\[
y''(t)+2\zeta\omega_n y'(t)+\omega_n^2 y(t)=x(t)=0
\]
where the right hand side of the DE for the input $x(t)=0$ is 
zero. Substituting the assumed solution $y(t)=Ae^{st}$ and its 
derivatives $\dot{y}(t)=s Ae^{st},\;y''(t)=s^2 Ae^{st}$ into
the DE we get
\[
(s^2+2\zeta\omega_n s+\omega_n^2)Ae^{st}=0 
\]
As we are not interested in a trivial solution, $Ae^{st}\ne 0$, and
we get an algebraic equation
\[ 
s^2+2\zeta\omega_n s+\omega_n^2=0 
\]
Solving this quadratic equation we get its two roots, the two 
eigenvalues of ${\bf A}$:
\[ 
s_{1,2}=\left\{\begin{array}{ll}
\left(-\zeta\pm\sqrt{\zeta^2-1}\right)\omega_n&|\zeta|> 1\\
-\zeta\omega_n=\pm\omega_n & |\zeta|=1\\
\left(-\zeta\pm j\sqrt{1-\zeta^2}\right)\omega_n=\omega_n e^{\mp j\phi} 
&|\zeta|< 1\end{array}\right.
\]
where
\[
\phi=\tan^{-1}\left(\frac{\sqrt{1-\zeta^2}}{\zeta}\right) 
\]
\htmladdimg{../figures/zetaphi.png}

These two roots $s_{1,2}$ are either two real numbers or a pair 
complex conjugate numbers, depending on whether its discriminant 
is greater and smaller then 0:
\[
\Delta=(2\zeta\omega_n)^2-4\omega_n^2=4\omega_n^2(\zeta^2-1)
\left\{\begin{array}{ll}\ge 0 & |\zeta|\ge 1\\< 0 & |\zeta|< 1\end{array}\right.
\]

\htmladdimg{../rootlocus2nd1.gif}

For a constant $\omega_n$ and a variable $\zeta$ that changes 
from $-\infty$ to $\infty$, the two roots $s_1$ (red) and $s_2$ 
(blue) can be represented as the root locus on the complex plane.


In particular, for the RCL circuit with all $R$, $C$, and $L$ values 
non-negative, we have $\zeta\ge 0$, i.e., we only need to consider the 
root locus on the left side of the complex plain.

Given the two roots $s_1$ and $s_2$, we can write the homogeneous 
solution as
\[
y_h(t)=C_1 e^{s_1t}+C_2 e^{s_2t} 
\]
where the two coefficients $C_1$ and $C_2$ can be found based on the 
two initial conditions $y(0)$ and $y'(0)$. If we assume $\dot{y}(0)=0$ 
but $y(0)=y_0$, then we get
\begin{eqnarray}
  y(0)&=&y_h(t)\bigg|_{t=0}=C_1+C_2=y_0  \nonumber \\
  \dot{y}(0)&=&\dot{y}_h(t)\bigg|_{t=0}=s_1C_1+s_2C_2=0 \nonumber
\end{eqnarray}
Solving these we get
\[
C_1=\frac{s_2}{s_2-s_1} y_0,\;\;\;\;\;\;\;\;C_2=\frac{s_1}{s_1-s_2} y_0 
\]
and the homogeneous solution becomes:
\[
y_h(t)=y_0 \left[ \frac{s_2 e^{s_1t}}{s_2-s_1}-\frac{s_1 e^{s_2t}}{s_2-s_1} \right]
=\frac{y_0}{s_2-s_1} (s_2 e^{s_1t}-s_1 e^{s_2t})
\]
Alternatively, the 2nd-order LCCODE in canonical form given above can 
also be solved if it is coverted into a 1st-order ODE system, as
shown \htmladdnormallink{here}{../ch3_sub3/index.html}.


The solution takes different forms depending on the value of the damping 
coefficient $\zeta$.
\begin{itemize}
\item {\bf Over-damped system ($\zeta>1$)}
  \begin{eqnarray}
    y_h(t)&=&y_0 \left[ \frac{s_2 e^{s_1t}}{s_2-s_1}+\frac{s_1 e^{s_2t}}{s_1-s_2} \right]
    \nonumber \\
    &=&y_0\left[\frac{-\zeta+\sqrt{\zeta^2-1}}{2\sqrt{\zeta^2-1}}e^{(-\zeta-\sqrt{\zeta^2-1})\omega_nt}
      -\frac{-\zeta-\sqrt{\zeta^2-1}}{2\sqrt{\zeta^2-1}}e^{(-\zeta+\sqrt{\zeta^2-1})\omega_nt}\right]
    \nonumber 
  \end{eqnarray}
  This is a sum of two exponentially decaying terms, without any overshoot 
  or oscillation. Note that when $t=0$, $y_h=y_0$. 

\item {\bf Critically damped system ($\zeta=1$)}

  Now we have
  \[ s_1=s_2=-\omega_n=s \]
  and the homogeneous solution takes following form:
  \begin{eqnarray}
    y_h(t)&=&C_1 e^{st}+C_2 t e^{st}=C_1 e^{-\omega_nt}+C_2 t e^{-\omega_nt} 
    \nonumber \\
    \dot{y}_h(t)&=&\frac{d}{dt}[C_1 e^{st}+C_2 t e^{st}]=C_1se^{st}+C_2(e^{st}+ste^{st})  
    \nonumber 
  \end{eqnarray}
  Applying the initial conditions to this response we get
  \begin{eqnarray}
    y(0)&=&C_1=y_0  \nonumber \\
    \dot{y}(0)&=&s C_1+C_2=0 \nonumber 
  \end{eqnarray}
  Solving this we get 
  \[ 
  C_1=y_0, \;\;\;\;\;\;\;C_2=y_0
  \]
  and the response is
  \[ y_h(t)=C_1 e^{st}+C_2 t e^{st}=y_0\left[ e^{-\omega_nt}+\omega_n t e^{-\omega_nt}\right] \]
  Again, there is no overshoot or oscillation.
\item {\bf Under-damped system ($0 \le \zeta < 1$)}
  \[ s_{1,2}=(-\zeta\pm j \sqrt{1-\zeta^2})\omega_n=-\zeta\omega_n\pm j\omega_d,\;\;\;\;\mbox{and}\;\;\;\;
  s_1-s_2=2j\omega_d  \]
  where $\omega_d$ is the {\em damped natural frequency} defined as:
  \[ \omega_d=\omega_n\sqrt{1-\zeta^2} \]
  The response is
  \begin{eqnarray}
    y_h(t)&=&y_0 \left[ \frac{s_2 e^{s_1t}}{s_2-s_1}+\frac{s_1 e^{s_2t}}{s_1-s_2} \right]
    \nonumber \\
    &=&y_0\left[ \frac{(-\zeta-j\sqrt{1-\zeta^2})\omega_n}{-2j\omega_n\sqrt{1-\zeta^2}} e^{(-\zeta\omega_n+j\omega_d)t}
                +\frac{(-\zeta+j\sqrt{1-\zeta^2})\omega_n}{-2j\omega_n\sqrt{1-\zeta^2}} e^{(-\zeta\omega_n-j\omega_d)t} \right]
    \nonumber \\
    &=&y_0\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}} \left(\frac{e^{j\phi}e^{j\omega_dt}-e^{-j\phi}e^{-j\omega_dt}}{2j}\right)
    =y_0\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}} \sin(\omega_dt+\phi)
    \nonumber
  \end{eqnarray}
  Here we have defined:
  \[ 
  \phi=\tan^{-1}\left( \frac{\sqrt{1-\zeta^2}}{\zeta} \right),\;\;\;\;\;
  \zeta+j\sqrt{1-\zeta^2}=e^{j\phi},\;\;\;\;\;\zeta-j\sqrt{1-\zeta^2}=e^{-j\phi}
  \]
\item {\bf Undamped system ($ \zeta =0$)}
  \[ s_1=j\omega_n,\;\;\;\;\;\;s_2=-j\omega_n \]
  \[ y_h(t)=y_0 \left[ \frac{s_2 e^{s_1t}}{s_2-s_1}+\frac{s_1 e^{s_2t}}{s_1-s_2} \right]
  =y_0\left(\frac{e^{j\omega_n}+e^{-j\omega_n}}{2}\right)=y_0\cos(\omega_nt) \]
  This result can also be obtained from the previous case:
  \[ \lim_{\zeta\leftarrow 0} \left(y_0\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}} \sin(\omega_dt+\phi) \right)
  =y_0\sin(\omega_nt+\frac{\pi}{2})=y_0\cos(\omega_nt) \]
\end{itemize}

The homogeneous responses of these four cases are plotted below. Note that in all cases,
$y(0)=y_0$ and $\dot{y}(0)=0$.

\htmladdimg{../figures/SecondOrder0.png}

%\htmladdimg{../e84Zeta.gif}

%\htmladdimg{../RCLimpulseresponses.gif}

\subsubsection*{Complete Solution with Step Input}

We next consider the complete solution (composed of both homogeneous and 
particular solutions) of the 2nd order DE
\[
y''(t)+2\zeta\omega_n y'(t)+\omega_n^2 y(t)=x(t) 
\]
with a unit step $x(t)=u(t)$ input and zero initial conditions 
$y(0)=\dot{y}(0)=0$. As the input is a constant for $t>0$, we can assume 
the particular solution to be a constant $y_p(t)=C$ with zero derivatives
$\dot{y}_p(t)=y''_p(t)=0$. Substituting these into the DE above, we
get $y_p(t)=C=1/\omega_n^2$, i.e., the steady state solution is:
\[
y_{ss}(t)=y_p(t)=y(\infty)=\frac{1}{\omega_n^2} 
\]
The complete response can be obtained as the sum of the homogeneous 
solution (same as that obtained previously) and particular solution, 
corresponding to the transient and steady state response, respectively:
\[
y(t)=y_h(t)+y_p(t)=C_1 e^{s_1t}+C_2 e^{s_2t}+\frac{1}{\omega_n^2} 
\]
The two coefficients $C_1$ and $C_2$ can be obtained based on the two 
zero initial conditions:
\begin{eqnarray}
  y(0)&=&y(t)\bigg|_{t=0}=C_1+C_2+\frac{1}{\omega_n^2}=0 
  \nonumber \\
  \dot{y}(0)&=&\dot{y}(t)\bigg|_{t=0}=C_1s_1+C_2s_2=0 
  \nonumber
\end{eqnarray}
Solving these equations we get:
\[
C_1=\frac{s_2}{\omega_n^2(s_1-s_2)}=\frac{-s_2}{\omega_n^2(s_2-s_1)},
\;\;\;\;\;\;C_2=\frac{s_1}{\omega_n^2(s_2-s_1)} 
\]
Now the complete solution becomes:
\[
y(t)=\frac{1}{\omega_n^2}\left[1-\left(\frac{s_2e^{s_1t}}{s_2-s_1}
  -\frac{s_1e^{s_2t}}{s_2-s_1}\right)\right] 
=\frac{1}{\omega_n^2}\left[1-\frac{s_2e^{s_1t}-s_1e^{s_1t}}{s_2-s_1}\right]
\]
The two roots $s_1$ and $s_2$ take different forms depending on 
whether the discriminant $\Delta=4\omega_n^2(\zeta^2-1)$ is greater
or smaller than 0, i.e., whether $\zeta$ is greater or smaller then 1.
Here we only consider the case when $0 < \zeta < 1$, i.e., $\Delta<0$,
for an under-damped second order system. The two roots are
\[
s_{1,2}=\omega_n \; (-\zeta\pm j\sqrt{1-\zeta^2})=-\zeta \omega_n\pm j\omega_d,
\;\;\;\;\mbox{and}\;\;\;\;s_2-s_1=-2j\omega_d 
\]
where $\omega_d$ is the damped natural frequency:
\[
\omega_d=\omega_n \sqrt{1-\zeta^2} 
\]
Finally the complete solution of the non-homogeneous DE is:
\begin{eqnarray}
  y(t)&=&\frac{1}{\omega_n^2}\left[1-\left(\frac{s_2}{s_2-s_1}e^{s_1t}-\frac{s_1}{s_2-s_1}e^{s_2t}\right)\right]
  \nonumber \\
  &=&\frac{1}{\omega_n^2}\left[ 1-
    \left(\frac{\zeta+j\sqrt{1-\zeta^2}}{2j\sqrt{1-\zeta^2}} e^{(-\zeta\omega_n+j\omega_d)t} 
    -\frac{\zeta-j\sqrt{1-\zeta^2}}{2j\sqrt{1-\zeta^2}} e^{(-\zeta\omega_n-j\omega_d)t} \right) \right]
  \nonumber \\
  &=&\frac{1}{\omega_n^2}\left[ 1-\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}}
    \left(\frac{\zeta+j\sqrt{1-\zeta^2}}{2j} e^{ j\omega_dt} 
    -\frac{\zeta-j\sqrt{1-\zeta^2}}{2j} e^{-j\omega_dt} \right) \right]
  \nonumber \\
  &=&\frac{1}{\omega_n^2}\left[ 1-\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}}
    \left(\frac{ e^{j\phi} e^{ j\omega_dt}-e^{-j\phi} e^{-j\omega_dt} }{2j} \right) \right]
  \nonumber \\
  &=&\frac{1}{\omega_n^2}\left[1-\frac{e^{-\zeta\omega_nt}}{\sqrt{1-\zeta^2}}
    \sin(\omega_dt+\phi) \right]
  \nonumber 
\end{eqnarray}
where 
\[ \phi=\tan^{-1}\left( \frac{\sqrt{1-\zeta^2}}{\zeta} \right),\;\;\;\;\mbox{and}\;\;\;\;
\sin \phi=\sqrt{1-\zeta^2},\;\;\;\;\cos \phi=\zeta  \]

\htmladdimg{../figures/zetaphi.png}

In particular, if $\zeta=0$, we have
\[
y(t)=\frac{1}{\omega_n^2}\left[1-\sin(\omega_n t+\pi/2)\right]
=\frac{1}{\omega_n^2}\left[1-\cos(\omega_n t)\right]
\]

The plots below shows an example with $f_n=1, \omega_n=2\pi$. Note the critical 
damped case when $\zeta=1$. An overshoot will occur for any $\zeta<1$.

The step response is plotted below. Note that $y(0)=0$ and $\dot{y}(0)=0$.

\htmladdimg{../figures/secondstep.png}

\htmladdimg{../figures/secondstep1.png}


{\bf Example} 

Consider the response $y(t)=v_C(t)$ of an undamped 2nd order RCL system.

\begin{itemize}
\item Find the response $y(t)$ of the RLC circuit to a step input $x(t)=Vu(t)$.
  The general solution is the sum of the homogeneous solution 
  $A\sin\omega_nt+B\cos\omega_nt$ and the particular solution $V$:
  \[ y(t)=V+A\sin(\omega_nt)+B\cos(\omega_nt),\;\;\;\;\;\;\;t>0 \]
  Consider two different sets of initial conditions:
  \begin{itemize}
  \item Zero initial conditions $y(0)=\dot{y}(0)=0$. We have $y(0)=V+B=0$ 
    and $\dot{y}(0)=A\omega_n=0$, and
    \[ y(t)=V+A\sin(\omega_nt)+B\cos(\omega_nt)=V[1-\cos(\omega_nt)] \]
  \item $y(0)=V$, $\dot{y}=0$. We have $y(0)=V+B=V$ and $\dot{y}(0)=A\omega_n=0$, 
    i.e., $A=B=0$ and
    \[ y(t)=V+A\sin(\omega_nt)+B\cos(\omega_nt)=V \]
  \end{itemize}
  

\item Find the system's response to a square impulse 
  \[
  x(t)=\left\{ \begin{array}{ll}1 & 0\le t< t_0 \\0 & \mbox{else} 
  \end{array} \right. 
  \]
  As $x(t)=u(t)-u(t-t_0)$, the response is
  \[
  y(t)=[1-\cos(\omega_nt)]u(t)-[1-\cos(\omega_n(t-t_0))]u(t-t_0) 
  \]
  When $t>t_0$, we have
  \[
  y(t)=\cos(\omega_n(t-t_0))-\cos(\omega_nt) 
  \]
  We further consider two special cases. 
  \begin{itemize}
  \item When $t_0=T=2\pi/\omega_n$, we have 
    \begin{eqnarray}
      y(t)&=&[1-\cos(\omega_nt)]u(t)-[1-\cos(\omega_n(t-T))]u(t-T)
      \nonumber \\
      &=&\left\{\begin{array}{cl} 1-\cos(\omega_nt) & 0<t<T \\ 0 & \mbox{else}
      \end{array} \right. 
      \nonumber 
    \end{eqnarray}
    This is a one period of a sinusoid.
  \item When $t_0=T/2=\pi/\omega_n$, we have
    \begin{eqnarray}
      y(t)&=&[1-\cos(\omega_nt)]u(t)-[1-\cos(\omega_n(t-T/2))]u(t-T/2)
      \nonumber \\
      &=&[1-\cos(\omega_nt)]u(t)-[1+\cos(\omega_nt)]u(t-T/2)
      \nonumber \\
      &=&\left\{\begin{array}{cl}1-\cos(\omega_nt) & 0<t<T/2 \\
      -2\cos(\omega_nt) & t>T/2 \end{array} \right.
      \nonumber 
    \end{eqnarray}
    This is a pure sinusoid after $t>T/2$.
  \end{itemize}

\item Find the impulse response $h(t)$. The input $x(t)$ is an impulse which
  can be written as
  \[ x(t)=\delta(t)=\lim_{t_0\rightarrow 0}\left\{ \begin{array}{cl}
    1/t_0 & 0\le t< t_0 \\0 & \mbox{else} \end{array}\right. \]
  When $t_0\rightarrow 0$, we have first order approximations 
  $\cos(\omega_nt_0)\approx 1$ and $\sin(\omega_nt_0)\approx \omega_nt_0$, 
  and we get
  \[ \cos(\omega_n(t-t_0))=\cos(\omega_nt)\;\cos(\omega_nt_0)+\sin(\omega_nt)\;
  \sin(\omega_nt_0)  \approx\cos(\omega_nt)+\sin(\omega_nt)\,\omega_nt_0 \]
  Substituting this into $y(t)=\cos(\omega_n(t-t_0))-\cos(\omega_nt)$
  we get the impulse response 
  \[ y(t)=\omega_n\sin(\omega_nt) \]
  
\item It is often desirable for a second order system to reach a set steady 
  state value without overshoot. This can be achieved by driving the system 
  by an impulse $\delta(t)/\omega_n$ with response $\sin(\omega_nt)$, followed 
  by a step $u(t-T/4)$ with response 
  \[ [1-\cos(\omega_n(t-T/4))]u(t-T/4)=[1-\cos(\omega_nt-\pi/2)]u(t-T/4)
  =[1-\sin(\omega_nt)]u(t-T/4) \]
  The total response is
  \[ y(t)=\sin(\omega_nt)u(t)+[1-\sin(\omega_nt)]u(t-T/4)
  =\left\{\begin{array}{cl} \sin(\omega_nt) & 0<t<T/4 \\
  1 & t>T/4\end{array} \right. \]
  We see that after $y(t)$ reaches the first peak of $1$ at $t=T/4$, it will
  stay at the constant value $1$ as the two responses cancel each other for
  $t>T/4$.

\item Alternatively, the steady state value $v=1$ can be achieved without
  overshoot by applying an input $x(t)=[u(t)-u(t-T/2)]/2$. The response to 
  $u(t)/2$ is 
  \[ \frac{1}{2}[1-\cos(\omega_nt)]u(t) \]
  while the response to $u(t-T/2)/2$ is  
  \[ \frac{1}{2}[1-\cos(\omega_n(t-T/2))]u(t-T/2)
  =\frac{1}{2}[1-\cos(\omega_nt-\pi)]u(t-T/2)
  =\frac{1}{2}[1+\cos(\omega_nt)]u(t-T/2) \]
  The overall response is the difference between the two individual responses:
  \[ y(t)=\left\{\begin{array}{cl}
     [1-\cos\omega_nt]/2 & 0<t<T/2 \\ 1 & t>T/2 \end{array} \right. 
  \]
  i.e., the response is $y(t)=1$ for all $t>T/2$.

\item It is desirable for a second order system to reach a steady state value
  $y(t)=1$ within a time delay $t_0$ without overshoot. We first consider 
  driving the system with a positive square pulse of value $V>0$ followed
  by a negative one of $(1-a)V<0$:
  \[ 
  x(t)=\left\{\begin{array}{cl} 
  V & (0<t<t_0/2) \\ (1-a)V & (t_0/2<t<t_0)
  \end{array}\right.  =V \left[u(t)-a u(t-t_0/2)\right]  
  \]
  The response for $t_0/2<t<t_0$ is:
  \[ y(t)=V\left[ 1-\cos(\omega_nt)-a[1-\cos(\omega_n(t-t_0/2))]\right] \]
  In order for the output to be a constant $y(t)=1$ for $t>t_0$, we need to 
  have the input $x(t)=1$ for $t>t_0$, and set the initial conditions at $t=t_0$
  to be $y(t_0)=1$ and $\dot{y}(t_0)=0$. To do so, we let
  \[ 
  \frac{dy(t)}{dt}\bigg|_{t=t_0}=V\omega_n\left[ \sin(\omega_nt)
    -a\sin(\omega_n(t-t_0/2))\right]_{t=t_0}
  =V\omega_n\left[ \sin(\omega_nt_0)-a\sin(\omega_nt_0/2)\right]=0 
  \]
  Based on the trigonometric identity 
  $\sin(\omega_nt_0)=2\sin(\omega_nt_0/2)\cos(\omega_nt_0/2)$, the equation above 
  can be written as
  \[
  2\cos(\omega_nt_0/2) =a 
  \]
  Substituting this into the desired initial condition $y(t_0)=1$, we get
  \[
  y(t_0)=V\left[ 1-\cos(\omega_nt_0)-2\cos(\omega_nt_0/2)
    [1-\cos(\omega_n(t_0/2))]\right] 
  =2V(1-\cos(\omega_nt_0/2) =4V\sin^2(\omega_nt_0/4)=1 
  \]
  where we have used the trigonometric identities
  $2\cos^2(\omega_nt_0/2)=1+\cos(\omega_nt_0)$ and
  $2\sin^2(\omega_nt_0/4)=1-\cos(\omega_nt_0/2)$. Solving this for $V$ we get
  \[
  V=\frac{1}{4\sin^2(\omega_nt_0/4)} 
  \]
  As now we have the initial conditions $y(t_0)=1$ and $\dot{y}(t_0)=0$ as 
  needed. If we set $x(t)=1$ for $t>t_0$, so that the output will be at 
  constant $y(t)=1$ when $t>t_0$.

\end{itemize}


\subsubsection*{Responses to Impulse Train}

{\bf Example 1}

Consider the steady state response of a first order RC circuit with the
parameter $\tau$ to a square impulse train of period $T$:
\[
x(t+T)=x(t)=\left\{ \begin{array}{cl}1&0<t<T_0\\0&T_0<t<T\end{array}\right.
\]
where $T_0$ is the on-time and $T_1=T-T_0$ is off-time of the impulse train.
Consider the response $y(t)=v_C(t)$ during both the on and off periods:
\begin{itemize}
\item The on-time response can be found based on the assumed initial condition 
  $y(t)\big|_{t=0}=V_0$:
  \[ y(t)=1+(V_0-1)e^{-t/\tau},\;\;\;\;\;\;\;\;(0<t<T_0) \]
  In particular, $y(t)\big|_{t=T_0}=y(T_0)=1+(V_0-1)e^{-T_0/\tau}=V_1$  
\item The off-time response can be found based on the initial condition
  $y(T_0)=V_1$ to be
  \[ 
  y(t)=0+(V_1-0)e^{-(t-T_0)/\tau}=V_1 e^{-(t-T_0)/\tau},\;\;\;\;\;\;(T_0<t<T) 
  \]
  In particular, $y(T)=y(0)=V_1 e^{-(T-T_0)/\tau}=V_1 e^{-T_1/\tau}=V_0$
\end{itemize}
The two voltages $V_0$ and $V_1$ can then be found by solving these two 
simultaneous equations:
\[ 
\left\{\begin{array}{l} V_0=V_1 e^{-T_1/\tau}\\V_1=1+(V_0-1)e^{-T_0/\tau}\end{array}\right. 
\]
Substituting the first equation into the second one we can find $V_1$ and then
$V_0$:
\[
V_1=\frac{1-e^{-T_0/\tau}}{1-e^{-T/\tau}},\;\;\;\;\;\;\;\;
V_0=\frac{e^{-T_1/\tau}-e^{-T/\tau}}{1-e^{-T/\tau}} 
\]
Consider some special cases:
\begin{itemize}
\item When $T_0\gg\tau$ and $T_1\gg\tau$, all exponential terms become zero 
  and we have $V_0=0$ and $V_1=1$, i.e., the capacitor is fully charged and
  then fully discharged.
\item When $T_0\ll\tau$ and $T_1\ll\tau$, all exponential terms can be 
  approximated by $e^{-x}\approx 1-x$, and we have:
  \[ V_1=\frac{1-e^{-T_0/\tau}}{1-e^{-T/\tau}}\approx\frac{T_0}{T},  \;\;\;\;\;\;\;\;
  V_0=\frac{e^{-T_1/\tau}-e^{-T/\tau}}{1-e^{-T/\tau}}\approx\frac{T-T_1}{T}=\frac{T_0}{T} 
  \]
  which is the average value of the impulse train.

\item when $T_0=T_1=T/2$, we have
  \[ 
  1-e^{-T/\tau}=(1+e^{-T_0/\tau})(1-e^{-T_0/\tau}) 
  \]
  and
  \[ 
  V_1=\frac{1-e^{-T_0/\tau}}{1-e^{-T/\tau}}=\frac{1}{1+e^{-T_0/\tau}},
  \;\;\;\;\;\;\;\;
  V_0=\frac{e^{-T_1/\tau}-e^{-T/\tau}}{1-e^{-T/\tau}}=\frac{e^{-T_0/\tau}}{1+e^{-T_0/\tau}},
  \;\;\;\;\;\;V_0+V_1=1 
  \]
\end{itemize}

\htmladdimg{../figures/ImpulsetrainResponse1a.gif}

Here $T_0=T_1=T/2=1$, $\tau=0.5$.


{\bf Example 2} 

Consider the steady state response of an undamped second order system with
parameters $\zeta=0$ and $\omega_n$ to a symmetric square impulse train of
period $2T_0$:
\[
x(t+2T_0)=x(t)=\left\{ \begin{array}{cl}1&0<t<T_0\\0&T_0<t<2T_0\end{array}\right.
\]
where $T_0$ is both the on and off-time of the impulse train, which can also
be written as:
\[
x(t)=u(t)-u(t-T_0)+u(t-2T_0)-u(t-3T_0)+u(t-4T_0)- \cdots 
\]
The response of the 2nd order system can be obtained based on its step
response $y(t)=1-\cos(\omega_nt)$ (with some constant coefficient which 
is neglected):
\begin{itemize}
\item
  \[
  y(t)=1-\cos\omega_nt,\;\;\;\;\;\;\;\;\;\;\;\;\;\;(0<t<T_0) 
  \]
\item 
  \[
  y(t)=(1-\cos\omega_nt)-(1-\cos\omega_n(t-T_0))
  =-\cos\omega_nt+\cos\omega_n(t-T_0),\;\;\;\;\;\;\;\;\;\;\;\;\;\;(T_0<t<2T_0) 
  \]
\item
  \begin{eqnarray}
    y(t)&=&(1-\cos\omega_nt)-(1-\cos\omega_n(t-T_0))+(1-\cos\omega_n(t-2T_0))
    \nonumber \\
    &=&1-\cos\omega_n(t-2T_0)+\cos\omega_n(t-T_0)-\cos\omega_nt,
    \;\;\;\;\;\;\;\;\;\;\;\;\;\;(2T_0<t<3T_0)
    \nonumber 
  \end{eqnarray}
\item 
  \begin{eqnarray} 
    y(t)&=&(1-\cos\omega_nt)-(1-\cos\omega_n(t-T_0))+(1-\cos\omega_n(t-2T_0))
    -(1-\cos\omega_nt(t-3T_0))
    \nonumber \\
    &=&-\cos\omega_nt+\cos\omega_n(t-T_0)-\cos\omega_n(t-2T_0)+\cos\omega_n(t-3T_0),
    \;\;\;\;\;\;\;\;\;\;\;\;\;\;(3T_0<t<4T_0)
    \nonumber 
  \end{eqnarray}
\end{itemize}

We now consider two special cases:
\begin{itemize}
\item If $T_0=T=2\pi/\omega_n$ is the same as the natural period of
  the 2nd order system, then $\cos\omega_n(t-kT_0)=\cos\omega_nt$ and we have
  the following for all integer $k$:
  \begin{itemize}
  \item 
    \[
    y(t)=1-\cos\omega_nt,\;\;\;\;\;\;\;2kT_0<t<(2k+1)T_0 
    \]
  \item
    \[
    y(t)=0,\;\;\;\;\;\;\;\;\;\;\;\;(2k-1)T_0<t<2kT_0 
    \]
  \end{itemize}
  We see that as $t\rightarrow\infty$, more terms will be included in 
  $y(t)$, which is zero when an even number of terms are included, but
  $1-\cos(\omega_nt)$ when an odd number of terms are included.
  
  \htmladdimg{../figures/ImpulsetrainResponse2a.gif}

\item If $T_0=T/2=\pi/\omega_n$, the period $2T_0$ of the impulse train is 
  the same as the natural period $T=2\pi/\omega_n$ of the 2nd system, 
  \begin{itemize}
  \item 
    \[
    y(t)=1-\cos\omega_nt,\;\;\;\;\;\;\;\;\;\;\;\;\;\;(0<t<T_0) 
    \]
  \item
    \[
    y(t)=\cos\omega_n(t-T/2)-\cos\omega_nt=-2\cos\omega_nt,
    \;\;\;\;\;\;\;\;\;\;\;\;\;\;(T_0<t<2T_0) 
    \]
  \item
    \[
    y(t)=1-\cos\omega_n(t-T)+\cos\omega_n(t-T/2)-\cos\omega_nt
    =1-3\cos\omega_nt,\;\;\;\;\;\;\;\;\;\;\;\;\;\;(2T_0<t<3T_0) 
    \]
  \item
    \[
    y(t)=\cos\omega_n(t-T/2)-\cos\omega_nt+\cos\omega_n(t-3T/2)-\cos\omega_n(t-T)=-4\cos\omega_nt,\;\;\;\;\;\;\;\;\;\;\;\;\;\;(3T_0<t<4T_0)
    \]
  \end{itemize}
  This is a sinusoid growing linearly.

  \htmladdimg{../figures/ImpulsetrainResponse2b.gif}

\end{itemize}



\subsection*{Solving RLC Circuits by Laplace Transform}

In general, the relationship of the currents and voltages 
in an AC circuit are described by linear constant coefficient
ordinary differential equations (LCCODEs). But if only the 
steady state behavior of circuit is of interested, the circuit
can be described by linear algebraic equations in the s-domain 
by Laplace transform method. 

{\bf Example:} A low-pass filter composed of two inductors $L$
and a capacitor $C$ is inserted between the power supply and the
appliance modeled by resistor $R$ to filter out possible spikes
(due to surges in the power line or lightning). Such spikes can 
be modeled as a square impulse of certain height, e.g., $100=10^2$
Volt and certain duration, e.g., $10 \;\mu s=10^{-5}\;sec$, which 
can be mathematically represented by a delta function as the input
$v_s(t)=10^{-3}\delta(t)$, and we want to find out the output voltage
$v_R(t)$ across the load resistor $R$ as the response to the impulse
input. 

\htmladdimg{../figures/LCLfilterCircuit.png}

{\bf Time domain:} We use node-voltage method applied
to the middle node $v_C$ and the output node $v_R$:

KCL to node $v_C(t)$: $i_{L1}+i_C+i_{L2}=0$, where
\[
i_{L1}=\frac{1}{L_1}\int_{-\infty}^t (v_C-v_S)d\tau,\;\;\;
i_{L2}=\frac{1}{L_2}\int_{-\infty}^t (v_C-v_R)d\tau,\;\;\;
i_C=C\frac{dv_C}{dt}
\]
\[
\frac{d}{dt}(i_{L1}+i_{L2}+i_{L2})
=\frac{v_C-v_S}{L_1}+\frac{v_C-v_R}{L_2}+\frac{d}{dt}i_C=0
\]
KCL to node $v_R(t)$: $i_{L2}+i_R=0$, where
\[
i_{L2}=\frac{1}{L_2}\int_{-\infty}^t (v_R-v_C)d\tau,\;\;\;
i_R=\frac{v_R}{R}
\]
\[
\frac{d}{dt}(i_{L2}+i_{L2})=\frac{v_R-v_C}{L_2}+\frac{\dot{v}_R}{R}=0
\]
These differential equations can be combined to for a first
order differential equation system:
\[
\frac{d}{dt}\left[\begin{array}{c}v_R\\v_C\\i_C\end{array}\right]
=\left[\begin{array}{ccc}-R/L_2&R/L_2&0\\0 & 0 & 1/C\\1/L_2&-(1/L_1+1/L_2)&0
\end{array}\right]
\left[\begin{array}{c}v_R\\v_C\\i_C\end{array}\right]
+\left[\begin{array}{c}0\\0\\v_s/L_1\end{array}\right]
\]
This first order ODE system can be written in generic form:
\[
\dot{\bf y}={\bf Ay}+{\bf x}
\]
with a general solution:
\[
{\bf y}=e^{{\bf A}t}{\bf y}_0+\int_0^t e^{{\bf A}(t-\tau)} {\bf x}(\tau)\;d\tau
\]
Given the zero initial condition ${\bf y}(0)={\bf 0}$ and an
input ${\bf x}(t)=[0,\;0,\;10^{-3}\delta(t)/L_1]^T$, we can get 
\[
v_R=[1\;0\;0]{\bf y}=e^{{\bf A}t}
\left[\begin{array}{c}0\\0\\10^{-3}/L_1\end{array}\right]
\]
where 
\[
e^{{\bf A}t}={\bf V}e^{{\bf\Lambda}t}{\bf V}^{-1}
\]
with ${\bf\Lambda}=diag(\lambda_1,\;\lambda_2,\;\lambda_3)$ and
${\bf V}=[{\bf v}_1,\;{\bf v}_2,\;{\bf v}_3]$ being the eigenvalue 
and eigenvector matrices of ${\bf A}$ satisfying 
${\bf Av}_i=\lambda_i{\bf v}_i,\;\;(i=1,2,3)$, i.e., 
${\bf A}={\bf V\Lambda V}^{-1}$.


\htmladdimg{../figures/LCLfilter.png}

{\bf s-domain:}
\[
\left\{
\begin{array}{l}
\frac{V_C-V_s}{sL}+\frac{V_C}{1/sC}+\frac{V_C-V_R}{sL}=0\\
\frac{V_R-V_C}{sL}+\frac{V_R}{R}=0
\end{array}\right.
\]
Solving the second equation for $V_R$, we get
\[
V_R=V_C\frac{R}{R+sL}
\]
Substituting into the first equation, we get
\[
[(R+sL)(1+LC s^2)+sL]V_C(s)=(R+sL)V_s(s)
\]
Solving for $V_C$ we get
\[
V_C(s)=\frac{R+sL}{(R+sL)(1+LCs^2)+sL}V_s
\]
and
\[
V_R(s)=V_C(s)\frac{R}{R+sL}=\frac{R}{(R+sL)(1+LCs^2)+sL}V_s
\]
The voltage $v_R(t)={\cal L}^{-1}[\;V_R(s)\;]$ can be found
by inverse Laplace transform.

\subsection*{Frequency Response Functions and Filtering}

A linear time-invariant (LTI) system with input $x(t)$ and output $y(t)$ 
can be described in frequency domain by their Fourier coefficients 
(Fourier transforms) $X(\omega)$ and $Y(\omega)$,  which are complex 
variables representing the magnitude and phase of each frequency component 
$\omega$ contained in the signal. In particular, when the signals contain 
only a single frequency component $\omega$, as assumed in the discussion 
for AC circuit analysis, the Fourier coefficients $X(\omega)$ and $Y(\omega)$ 
of the input and output are essentially the same as their phasor representations
$\dot{X}$ and $\dot{Y}$ (with the variable of frequency $e^{j\omega}$ dropped).

The ratio of the output $Y(\omega)$ and the input $X(\omega)$ both represented
in frequency domain (phasor form) is called the {\em frequency response function 
(FRF)}. 

\[
H(\omega)=\frac{Y(\omega)}{X(\omega)}=\frac{\dot{Y}}{\dot{X}}
\]

\subsubsection*{First-order system as a filter}

The first order RC and RL systems can be used as either a high-pass or
low-pass filter, depending on voltage across which component is treated
as the output, while the input voltage $v_0(t)$ is applied across both 
components connected in series. For example, if the voltage $v_R(t)$ 
across $R$ is treated as the output, the RC circuit is a high-pass filter 
and the RL circuit is a low-pass filter. The cut-off or corner frequency 
of such filters is $\omega_c=1/\tau$.

\begin{itemize}
\item {\bf RC circuit} 

  Treating the RC circuit as a voltage divider, the phasor representations of
  the voltage across $R$ and $C$ are
  \[
  \dot{V}_R=\dot{V}_0\frac{R}{R+1/j\omega C}=\dot{V}_0\frac{j\omega RC}{j\omega RC+1}
  =\dot{V}_0\frac{j\omega\tau}{j\omega\tau+1}
  \]
  and
  \[
  \dot{V}_C=\dot{V}_0\frac{1/j\omega_c}{R+1/j\omega C}
  =\dot{V}_0\frac{1}{1+j\omega RC}=\dot{V}_0\frac{1}{1+j\omega\tau}
  \]
  where $\tau=RC$ is the time constant of this RC first order system. The 
  FRFs and transfer functions of the systems are
  \[ 
  H_R(\omega)=\frac{\dot{V}_R}{\dot{V}_0}=\frac{j\omega\tau}{j\omega\tau+1}
  \]
  \[ 
  H_C(\omega)=\frac{\dot{V}_C}{\dot{V}_0}=\frac{1}{1+j\omega\tau}
  \]
  $H_R$ and $H_C$ are high-pass and low-pass filters, respectively. At the 
  cut-off frequency defined as $\omega_c=1/\tau=1/RC$, the magnitude of the 
  output attenuates to $1/\sqrt{2}$ of the peak magnitude, the output power 
  is half of the input power:
  \[
  |H_R(\omega)|=\left\{\begin{array}{cl}0&\omega=0\\
  1/\sqrt{2}&\omega=\omega_c=1/\tau\\1&\omega=\infty\end{array}\right.
  \;\;\;\;\;\;\;
  |H_C(\omega)|=\left\{\begin{array}{cl}1&\omega=0\\
  1/\sqrt{2}&\omega=\omega_c=1/\tau\\0&\omega=\infty\end{array}\right.
  \]

\item {\bf RL circuit}

  Treating the RL circuit as a voltage divider, the phasor representation of
  the voltage across $R$ can be found to be
  \[
  \dot{V}_R=\dot{V}_0\frac{R}{R+j\omega L}
  =\dot{V}_0\frac{1}{1+j\omega L/R}=\dot{V}_0\frac{1}{1+j\omega\tau}
  \]
  \[
  \dot{V}_L=\dot{V}_0\frac{j\omega L}{R+j\omega L}
  =\dot{V}_0\frac{j\omega}{R/L+j\omega}=\dot{V}_0\frac{j\omega}{j\omega+1/\tau}
  =\dot{V}_0\frac{j\omega\tau}{j\omega\tau+1}
  \]
  where $\tau=L/R$ is the time constant of this RL first order system. The 
  FRFs and transfer functions of the system are
  \[ 
  H_R(\omega)=\frac{\dot{V}_R}{\dot{V}_0}=\frac{1}{j\omega\tau+1}
  \]
  \[
  H_L(\omega)=\frac{\dot{V}_L}{\dot{V}_0}=\frac{j\omega\tau}{j\omega\tau+1}
  \]
  and
  \[
  |H_R(\omega)|=\left\{\begin{array}{cl}0&\omega=\infty\\
  1/\sqrt{2}&\omega=\omega_c=1/\tau\\1&\omega=0\end{array}\right.
  \]
  This system is a low-pass filter as it passes low frequencies but 
  attenuates high frequencies. 

\end{itemize}

The cut-off or corner frequency $\omega_c=1/\tau=L/R$ is defined as
the frequency at which the magnitude of the output attenuates to 
$|H(\omega_c)|=1/\sqrt{2}$ of the peak magnitude, unity in first 
order systems, and the output power is half of the peak power, 
the input power for first order systems. The gain of a system is
typically measured in decibel (dB) and plotted in Bode plots in 
terms of the log-magnitude of the FRF defined as $ 20 \log_{10}|H(\omega)|$. 
At the cut-off frequency, we have
\[
20 \log_{10}(1/\sqrt{2})=-20\log_{10}\sqrt{2}=-10\log_{10}2=-3
\]
(For more discussion of the Bode plots, see
\htmladdnormallink{here}{http://fourier.eng.hmc.edu/e59/lectures/e59/node40.html}.)

\htmladdimg{../figures/E84FirstOrderFilter.png}


\subsubsection*{Second-order system as a filter}

Consider a second order circuit of the series combination of R, C, 
and L, connected to an input voltage source $v_0(t)$. We can treat 
any of the voltages $v_R(t)$, $v_C(t)$, and $v_L(t)$, across R, C, 
and L, respectively as the output. The second order system can be 
used as a band-pass (BP), high-pass (HP), or low-pass (LP) filter, 
if the voltage across R, L, or C is treated as the output. In general, 
the {\em resonant frequency} $\omega_r$ of a system is the frequency 
at which the magnitude of its frequency response function is maximized. 
In the following, we specifically consider the magnitude of the 
frequency response function (FRF) of these filters. In particular,
we will consider $|H(\omega)|$ when $\omega=0$, $\omega=\omega_r$, 
$\omega=\omega_n$, and $\omega=\infty$.

\begin{itemize}

\item {\bf 2nd-order Band-pas Filter}:

  If the voltage across $R$ is treated as the output, we have
  \[
  \dot{V}_R=\dot{V}_0\;\frac{Z_R}{Z_R+Z_C+Z_L}
  =\dot{V}_0\;\frac{R}{R+1/j\omega C+j\omega L}
  =\dot{V}_0\;\frac{R}{R+j(\omega L-1/\omega C)}
  \]
  The FRF of the system is
  \begin{eqnarray}
  H_R(\omega)&=&\frac{R}{R+j\omega L+1/j\omega C}
  \nonumber\\
  &=&\frac{j\omega R/L}{j\omega R/L+(j\omega)^2+1/LC}
  =\frac{j\omega 2\zeta \omega_n}{(j\omega)^2
    +j\omega 2\zeta \omega_n+\omega_n^2}	
  \nonumber
  \end{eqnarray}

  This is a band-pass filter. At the natural frequency 
  $\omega=\omega_n=1/\sqrt{LC}$, the imaginary part of the denominator
  $\omega_n L-1/\omega_n C$ is zero and $H_R(\omega_n)=1$ is the 
  maximum, i.e., the resonant frequency is the same as the natural 
  frequency $\omega_r=\omega_n=1/\sqrt{LC}$. When $\omega$ is either 
  lower or higher than $\omega_n$, $|H_R(\omega)|<|H_R(\omega_n)|$. In
  particular, we have:

  \begin{itemize}
  \item $|H_R(0)|=0$
  \item $|H_R(\omega_n)|=|H_R(\omega_r)|=1$
  \item $|H_R(\infty)|=0$
  \end{itemize}

  The {\em bandwidth} of a band-pass filter is defined as 
  \[ 
  \triangle \omega=\omega_2-\omega_1 
  \]
  where $\omega_1<\omega_r$ and $\omega_2>\omega_r$ are the two cut-off 
  frequencies at which
  \[ 
  |H(\omega_1)|=|H(\omega_2)|=\frac{1}{\sqrt{2}}=0.707,\;\;\;\;\;\mbox{or}
  \;\;\;\;\;\;|H(\omega_1)|^2=|H(\omega_2)|^2=\frac{1}{2}
  \]
  In other words, the power of the output is halved when compared to 
  that of the input. The cut-off frequency is therefore also called the 
  {\em half-power frequency}. To find the bandwidth of this 2nd order 
  system, we rewrite the FRF as:
  \[
  H_R(\omega)=\frac{R}{R+j\omega C+1/j\omega C}
  =\frac{1}{1+j(\omega L/R-1/\omega RC)}
  \]
  For $|H_R(\omega)|=1/\sqrt{2}$, we let the imaginary part of the 
  denominator be:
  \[
  \frac{\omega L}{R}-\frac{1}{\omega CR}=\pm 1
  \]
  Multiplying both sides by $\omega R/L$, we get two quadratic
  equations:
  \[
  \omega^2\pm \frac{R}{L}\omega-\frac{1}{LC}=\omega^2\pm 2\zeta\omega_n\omega-\omega_n^2=0
  \]
  with four roots:
  \[
  \omega=\frac{1}{2}\left(\mp 2\zeta\omega_n\pm\sqrt{4\zeta^2\omega_n^2+4\omega_n^2}\right)
  =\left(\mp\zeta\pm\sqrt{\zeta^2+1}\right)\omega_n
  \]
  Ignoring the negative roots (with no physical meaning) we get
  the two cut-off frequencies $\omega_1$ and $\omega_2$:
  \[
  \omega_{1,2}=\left(\sqrt{1+\zeta^2}\mp \zeta\right) \omega_n
  \]
  and the bandwidth is
  \[
  \triangle \omega=\omega_2-\omega_1=2\zeta \omega_n=\frac{\omega_n}{Q}
  =\frac{R}{L}
  \]
  This happens to be the coefficient of the first order term in the 
  canonical form of the second order system, which can now be written as:
  \[ 
  y''(t)+2\zeta\omega_n\,y'(t)+\omega_n^2\, y(t)
  =y''(t)+\triangle\omega\,y'(t)+\omega_n^2\, y(t)= x(t) 
  \]
  The equation $\triangle\omega=\omega_n/Q$ is of great importance as
  it directly relates the bandwidth $\Delta\omega$ and the natural 
  frequency $\omega_n$.

  The middle point between the two cut-off frequencies $\omega_1$ and 
  $\omega_2$ is 
  \[
  \omega_0=\frac{\omega_1+\omega_2}{2}
  =\omega_n \sqrt{1+\zeta^2}\;>\;\omega_n
  \] 
  which is greater than the resonant frequency $\omega_r=\omega_n$,
  and we have $\omega_2-\omega_n>\omega_n-\omega_1$.

  \htmladdimg{../figures/bandwidth1.png}

  \htmladdimg{../figures/bandwidth.png}

  If $Q=1/2\zeta \gg 1$ (typically $Q>10$, i.e., $\zeta<0.05$),
  we have $\sqrt{1+\zeta^2} =\sqrt{1+(1/2Q)^2} \approx 1$, 
  $\omega_0\approx\omega_n$, and
  \[
  \omega_{1,2}\approx \omega_n\mp \frac{\triangle\omega}{2}
  =\omega_n\mp\frac{2\zeta\omega_n}{2}=\omega_n(1\mp\zeta)
  \]
  \[
  H_{bp}(\omega)=\frac{j\omega 2\zeta \omega_n}{(j\omega)^2
    +j\omega 2\zeta \omega_n+\omega_n^2}	
  =\frac{j\omega \triangle \omega}
  {(j\omega)^2+\triangle \omega j\omega+\omega_n^2}
  =\frac{j\omega \triangle \omega}
  {\triangle \omega j\omega+\omega_n^2-\omega^2}
  \]

\item {\bf 2nd-order High-pass Filter:}

  If the voltage across $L$ is treated as the output, we have
  \begin{eqnarray}
  H_L(\omega)&=&H_{hp}(\omega)=\frac{j\omega L}{R+j\omega L+1/j\omega C}
  =\frac{j\omega L\;j\omega/C}{(R+j\omega L+1/j\omega C)j\omega/C}
  \nonumber\\
  &=&\frac{(j\omega)^2}{(j\omega)^2+j\omega 2\zeta \omega_n+\omega_n^2}
  =\frac{(j\omega)^2}{(j\omega)^2+\triangle \omega j\omega +\omega_n^2}
  =\frac{-\omega^2}{\triangle \omega j\omega +\omega_n^2-\omega^2}
  %\;\;\;\;\;\;H(s)=\frac{s^2}{s^2+\triangle\omega s +\omega_n^2}
  \nonumber
  \end{eqnarray}
  This is a high-pass filter as
  \begin{itemize}
  \item $|H(0)|=0$
  \item $|H(\omega_n)|=\omega_nL/R=Q$
  \item $|H(\infty)|=1$
  \end{itemize}
  To decide whether $H_L(\omega)$ peaks and, if so, to find the resonant
  frequency, we solve the following equation:
  \begin{eqnarray}
    \frac{d}{d\omega}|H_{hp}(\omega)|^2
    &=&\frac{d}{d\omega}\left[\frac{\omega^4}{(\omega_n^2-\omega^2)^2
        +4\zeta^2\omega^2\omega_n^2}\right]
    \nonumber\\
    &=&\frac{4\omega^3[(\omega_n^2-\omega^2)^2+4\zeta^2\omega^2\omega_n^2]
      -\omega^4[4\omega(\omega^2-\omega^2_n)+8\zeta^2\omega\omega_n^2]}{[(\omega_n^2-\omega^2)^2+4\zeta^2\omega^2\omega_n^2]^2}  =0
    \nonumber
  \end{eqnarray}
  i.e., the numerator is zero, or
  \[
  4\omega^3[(\omega_n^2-\omega^2)^2+4\zeta^2\omega^2\omega_n^2]
  =4\omega^5[\omega^2-\omega^2_n+2\zeta^2\omega_n^2]
  \]
  Solving this for $\omega$, we get the resonant frequency:
  \[
  \omega_r=\frac{\omega_n}{\sqrt{1-2\zeta^2}}>\omega_n
  \]
  We also have
  \[
  |H_L(\omega)|^2&=&\frac{\omega^4}{(2\zeta\omega_n\omega)^2+(\omega_n^2-\omega^2)^2}
  =\frac{\omega^4}{\omega^4-(1-2\zeta^2)2\omega_n^2\omega^2+\omega_n^4}
  \]
  Consider the following three cases:
  \begin{itemize}
  \item If $\zeta<1/\sqrt{2}$, $\omega_r$ is real and $|H_L(\omega)|$ 
    has a maximum. In particular,
    \[
    |H_{hp}(\omega_n)|^2=\frac{1}{4\zeta^2}\;<\;
    |H_{hp}(\omega_r)|^2=\frac{1}{4\zeta^2(1-\zeta^2)}
    \;>\; |H_{hp}(\infty)|=1
    \]
    If $\zeta$ is small, $\omega_r\approx\omega_n$. For example,
    $\zeta=0.05$, $\omega_r=1.0025\,\omega_n$. 

  \item If $\zeta=1/\sqrt{2}$, we have
    \[
    |H_{hp}(\omega_n)|^2=\frac{1}{2}\;<\; |H_{hp}(\omega_r)|^2\;=\;1
    \;=\;|H_{lp}(\infty)|
    \]
    i.e., $|H_{hp}(\omega_n)|=1/\sqrt{2}$, or $20\log |H_{hp}(\omega_n)|=-3\,dB$.
  \item If $\zeta>1/\sqrt{2}$, $\omega_r$ is imaginary, indicating
    there does not exist a frequency at which $H_L(\omega)$ peaks. 
  \end{itemize}

\item {\bf 2nd-order Low-pass Filter:}

  If the voltage across $C$ is treated as the output, we have
  \begin{eqnarray}
    H_C(\omega)&=&H_{lp}(\omega)=\frac{1/j\omega C}{R+j\omega L+1/j\omega C}
    =\frac{1/j\omega C\;j\omega/L}{(R+j\omega L+1/j\omega C)j\omega/L}
    \nonumber\\
    &=&\frac{\omega_n^2}{(j\omega)^2+j\omega 2\zeta \omega_n+\omega_n^2} 
    =\frac{\omega_n^2}{(j\omega)^2+\triangle \omega j\omega+\omega_n^2}
    =\frac{\omega_n^2}{\triangle \omega j\omega+\omega_n^2-\omega^2}
    %\;\;\;\;\;\;H(s)=\frac{\omega_n^2}{s^2+\triangle\omega s +\omega_n^2}
    \nonumber
  \end{eqnarray}
  This is a low-pass filter as
  \begin{itemize}
  \item $|H(0)|=1$
  \item $|H(\omega_n)|=1/\omega_nCR=Q$
  \item $|H(\infty)|=0$
  \end{itemize}
  To decide whether $H_L(\omega)$ peaks and, if so, to find the resonant
  frequency, we solve the following equation, we find the frequency that
  minimizes the magnitude of the denominator: 
  \begin{eqnarray}
    \frac{d}{d\omega}\bigg|(j\omega)^2+j\omega 2\zeta\omega_n+\omega^2\bigg|^2
    &=&\frac{d}{d\omega} [(\omega_n^2-\omega^2)^2+4\zeta^2\omega_n^2\omega^2]
    \nonumber\\
    &=&-4\omega(\omega_n^2-\omega^2)+8\zeta^2\omega_n^2\omega=0
    \nonumber
  \end{eqnarray}
  Solving for $\omega$ we get the resonant frequency of this system:
  \[
  \omega_r=\omega_n\sqrt{1-2\zeta^2}<\omega_n
  \]
  We also have
  \[
  |H_C(\omega)|^2=\frac{\omega_n^4}{(2\zeta\omega_n\omega)^2+(\omega_n^2-\omega^2)^2}
  =\frac{\omega_n^4}{\omega^4-(1-2\zeta^2)2\omega_n^2\omega^2+\omega_n^4}
  \]

  \begin{itemize}
  \item If $\zeta<1/\sqrt{2}=0.707$, $\omega_r$ is real and $|H_C(\omega)|$
    has a maximum. In particular,
    \[
    |H_{lp}(0)|\;<\;|H_{lp}(\omega_r)|^2=\frac{1}{4\zeta^2(1-\zeta^2)}
    \;>\; |H_{lp}(\omega_n)|^2=\frac{1}{4\zeta^2}
    \]
    If $\zeta$ is small, $\omega_r\approx\omega_n$. For example,
    $\zeta=0.05$, $\omega_r=0.9975\,\omega_n$. 

  \item If $\zeta=1/\sqrt{2}$, we have
    \[
    |H_{lp}(0)|\;=\;|H_{lp}(\omega_r)|^2=1>|H_{lp}(\omega_n)|^2=\frac{1}{2}
    \]
    i.e., $|H_{lp}(\omega_n)|=1/\sqrt{2}$, or $20\log |H_{lp}(\omega_n)|=-3\,dB$.
  \item If $\zeta>1/\sqrt{2}$, $\omega_r$ is imaginary, indicating
    there does not exist a frequency at which $H_C(\omega)$ peaks. 
  \end{itemize}


\end{itemize}

\htmladdimg{../figures/E84SecondOrderFilter.png}

At the natural frequency, the impedance of a series RCL circuit reaches
minimum, consequently the current reaches maximum and so does the voltage 
across the resistor. However, the voltage across the inductor reaches 
maximum at a frequency slightly higher than the natural frequency, and 
the voltage across the capacitor reaches maximum at a frequency slightly 
lower than the resonant frequency, as shown in the linear and log-scale 
plots below. (For Bode plots, see
\htmladdnormallink{here}{http://fourier.eng.hmc.edu/e59/lectures/e59/node40.html}.)

\htmladdimg{../figures/rcl_plots2.gif}
\htmladdimg{../figures/rcl_plots1.gif}

In summary,

\begin{itemize}
\item Low-pass filter:
  \[
  H_{lp}=\frac{\omega_n^2}{(j\omega)^2+\triangle \omega j\omega+\omega_n^2}
  \]
\item High-pass filter:
  \[
  H_{hp}=\frac{(j\omega)^2}{(j\omega)^2+\triangle \omega j\omega+\omega_n^2}
  \]
\item Band-pass filter:
  \[
  H_{bp}=\frac{\triangle\omega j\omega}{(j\omega)^2+\triangle \omega j\omega+\omega_n^2}
  \]
\item Band-stop filter:
  \[
  H_{bs}=\frac{\omega_n^2+(j\omega)^2}{(j\omega)^2+\triangle \omega j\omega+\omega_n^2}
  \]
\end{itemize}

For a parallel RCL circuit with current input, due to the duality between 
current and voltage, parallel and series configuration, the same derivation
of bandwidth can be carried out to obtain the same conclusions. 

While the phenomenon of resonance can be destructive in mechanical systems
(for example, the famous story of the
\htmladdnormallink{Angers bridge}{http://en.wikipedia.org/wiki/Angers_Bridge}),
and it therefore needs to be avoided, it can also be very useful in electrical
system such as in the tuning circuit in radio or TV broadcasting.


\begin{comment}

{\bf Summary:}
\begin{itemize}

\item The resonant frequency of both series and parallel RCL circuits is
  completely determined by $L$ and $C$: $\omega_n=1/\sqrt{LC}$, independent 
  of the resistance $R$ in the circuit.

\item At the resonant frequency $\omega=\omega_n$, the impedance $Z=1/Y$ of
  a series RCL circuit is real and minimized (admittance maximized), and the 
  current through the three components reaches maximum; the admittance $Y=1/Z$ 
  of a parallel RCL circuit is real and minimized (impedance maximized), and 
  the voltage across the three components reaches maximum. 

\item In series RCL with voltage input and parallel RCL with current input, 
  the quality factor $Q$ is proportional to the ratio between $L$ and $C$:
  \[ 
  Q_s=\frac{1}{R}\sqrt{\frac{L}{C}},\;\;\;\;Q_p=R\sqrt{\frac{C}{L}}=\frac{1}{Q_s} 
  \]

\item In series RCL, $Q_s$ is inversely proportional to $R$ (the larger $R$, 
  the smaller $Q_s$, and the wider bandwidth), while in parallel RCL, $Q_p$ 
  is proportional to $R$ (the larger $R$, the larger $Q_p$,
  and the narrower bandwidth).
\end{itemize}


  % R=0.0015, C=100.0, L=0.001
  % plot R/sqrt((x*L-1/x/C)**2+R*R),x*L/sqrt((x*L-1/x/C)**2+R*R),1/C/x/sqrt((x*L-1/x/C)**2+R*R

  See \htmladdnormallink{this website}{http://fourier.eng.hmc.edu/e80/active_filter/index.html} for more detailed discussions of second-order systems.

  % \item The quality factor $Q_s$ and $Q_p$ are derived under the assumption 
  % of either a voltage or a current input. Therefore when the input to a 
  % parallel (series) RCL circuit is a voltage (current) source, we should 
  % still use $Q_s$ ($Q_p$) in the calculation bandwidth. 
\end{comment}


{\bf Example:} 

\htmladdimg{../figures/LC_R.png}
%\htmladdimg{../figures/bandblock.gif}

The impedance of the parallel combination of $L$ and $C$ is:
\[ 
Z_{LC}=Z_C||Z_L=\frac{Z_LZ_C}{Z_L+Z_C}
=\frac{j\omega L/j\omega C}{j\omega L+1/j\omega C}
=\frac{j\omega L}{1-\omega^2 LC}
=\frac{j\omega L}{1-(\omega/\omega_n)^2 } 
\]
At the resonant frequency $\omega=\omega_n=1/\sqrt{LC}$, $Z_{LC}=\infty$
(open-circuit):
\[
|Z_{LC}|=\left\{\begin{array}{cc}0 & \omega=0\\\infty & \omega=\omega_n\\
0 & \omega=\infty\end{array}\right.
\]

\begin{itemize}
\item The FRF of the first circuit is
  \[
  H_{LC}=\frac{Z_{LC}}{Z_{LC}+R}=\frac{\frac{j\omega L}{1-(\omega/\omega_n)^2}}{
    \frac{j\omega L}{1-(\omega/\omega_n)^2 } +R}
  =\frac{j\omega L}{j\omega L+R(1-(\omega/\omega_n)^2)}
  =\frac{1}{1-j\frac{(1-(\omega/\omega_n)^2)}{\omega L/R}}
  \]
  When $\omega=\omega_n$, $Z_{LC}=\infty$, $H_{LC}=1$. In this case
  no current goes through $R$ and the voltage drop across it is zero, 
  then the output voltage is the same as the input voltage. Otherwise 
  either $\omega>\omega_n$ or $\omega<\omega_n$, $Z_{LC}$ is finite, the 
  voltage across $R$ is non-zero, the output voltage is reduced. This is
  a band-pass filter:
  \[ 
  |H_{BP}|=\bigg|\frac{Z_C||Z_L}{R+Z_C||Z_L}\bigg|
  =\left\{\begin{array}{cc}0&\omega\rightarrow 0\\
  1&\omega=\omega_n\\ 0&\omega\rightarrow\infty\end{array}\right.
  \]

\item The FRF of the second circuit is
  \[
  H_R=\frac{R}{Z_{LC}+R}=\frac{R}{\frac{j\omega L}{1-(\omega/\omega_n)^2}+R}
  =\frac{1}{\frac{j\omega L/R}{1-(\omega/\omega_n)^2 }+1}
  \]
  when $\omega=\omega_n$, $Z_{LC}=\infty$, $H_R=0$. In this case,
  the LC parallel branch is an open-circuit, the output voltage is 
  zero. Otherwise either $\omega>\omega_n$ or $\omega<\omega_n$, 
  $Z_{LC}$ is finite, the voltage is non-zero. The circuit is a 
  band-stop or band-block filter:
  \[ 
  |H_{BS}|=\bigg|\frac{R}{R+Z_C||Z_L}\bigg|
  =\left\{\begin{array}{cc}1&\omega\rightarrow 0\\
  0&\omega=\omega_n\\ 1&\omega\rightarrow\infty\end{array}\right.
  \]

\end{itemize}
The bandwidth is defined as $\Delta\omega=\omega_2-\omega_1$, the
difference between the two cut-off frequencies $\omega_1<\omega_n$ 
and $\omega_2>\omega_n$ at which $|H|=1/\sqrt{2}$. For both filters,
the cut-off frequencies can be found by solving
\[
1-\left(\frac{\omega}{\omega_n}\right)^2 =\pm \frac{\omega L}{R}
\]
i.e., the two filters always have the same bandwidth.

\htmladdimg{../figures/BPBS.png}

{\bf Homework:} Find the bandwidth of each of the two filters as 
a function of $R$, $C$ and $L$. Determine whether the peak frequency
$\omage_n$ is lower or higher than the center of the passing/stop
band. Design a band-pass and a band-stop filter so that the peak
frequency is $\omega_n=1000$ and the bandwidth is $\Delta\omega=100$.


\begin{comment}
\end{comment}


{\bf Solution:}

\[
1-\omega^2LC=\pm \omega L/R,\;\;\;\;\;
\omega^2\pm\frac{1}{RC}\omega-\frac{1}{LC}=0
\]
Solving these two quadratic equations and take the positive roots
of each, we get
\[
\omega_{1,2}=\frac{1}{2}\left(\sqrt{\frac{1}{R^2C^2}+\frac{4}{LC}}\pm
\frac{1}{RC}\right)
\]
The bandwidth is
\[
\Delta\omega=\omega_2-\omega_1=\frac{1}{RC}
\]
The center of the bandwidth is greater than peak frequency:
\[
\frac{\omega_1+\omega_2}{2}=\frac{1}{2}\sqrt{\frac{1}{R^2C^2}+\frac{4}{LC}}
>\frac{1}{\sqrt{LC}}=\omega_n
\]

$R=100$, $L=10^{-2}\;H$, $C=10^{-4}\;F$.
\[
\omega_n=\frac{1}{\sqrt{LC}}=\frac{1}{\sqrt{10^{-6}}}=10^3,
\;\;\;\;\;
\Delta\omega=\frac{1}{RC}=\frac{1}{10^{-2}}=100
\]


\subsubsection*{Radio/TV Broadcasting and the Tuning Circuit}

{\bf Broadcasting and Frequency Allocation}

\begin{itemize}
\item The AM radio frequency range is from 535 kHz to 1605 kHz with 10 kHz
  frequency spacing or bandwidth, i.e., the highest signal frequency allowed 
  is about 5 kHz (while the upper limit of the audible frequencies is 20 kHz). 
\item The FM radio frequency range (VHF) is from 88 MHz to 108 MHz with 
  0.2 MHz=200 kHz frequency spacing, corresponding to a much wider
  bandwidth that makes high fidelity and stereo broadcasting possible. 
\item The TV broadcasting is also in MHz frequency range with a much wider 
  spacing of 6 MHz, needed to carry video as well as audio signals. 
  \begin{itemize}
  \item VHF: 54 MHz to 210 MHz (not continuous, for channels 2 to 13) 
  \item UHF: 470 MHz to 884 MHz (not continuous, for channels 14 to 83)
  \end{itemize}
\end{itemize}

The Federal Communications Commission (FCC) has very specific frequency allocation 
regulations, see the \htmladdnormallink{FCC frequency allocation chart}{http://www.ntia.doc.gov/osmhome/allochrt.pdf}.



{\bf Example 1:}

Resonant circuit is widely used in radio and TV receivers to select a 
desired station from many stations available. The tuning circuit shown 
in the figure below is a series RCL circuit composed of an inductor 
$L$, a resistor $R$ (of the inductor) and variable capacitor $C$, which
is adjustable to match the resonant frequency of the circuit to the 
frequency of the desired radio station. The voltage across $C$ is to 
be amplified by the subsequent circuits.

If $L=80\mu H$, $R=8\Omega$, find the value of $C$ for this circuit to 
resonate at $f=400\;kHz$, also find the bandwidth.

\htmladdimg{../figures/tuning.gif}

{\bf Solution:}
\[
\omega_n=\frac{1}{\sqrt{LC}},\;\;\;\;
C=\frac{1}{\omega_n^2 L}=\frac{1}{(2\pi 400\times 10^3)^2\times 80\times 10^{-6}}
=20nF	\]
The quality factor is
\[
Q=\frac{\omega_n L}{R}=\frac{2\pi 400\times 10^3\times 80\times 10^{-6}}{8}=25.13
\]
The bandwidth is
\[ 
\triangle f=\frac{f_0}{Q}=\frac{400\times 10^3}{25.13}=15.9\;kHz
\]
or 
\[ 
\triangle \omega= 2\pi\triangle f=\frac{\omega_n}{Q}=\frac{R}{L}=10^5 
\]

{\bf Example 2:} 

Assume $L=0.3\; mH,\;\;R=16\;\Omega$, and the frequency of the desired 
station is 640 kHz, find the value of $C$ and the bandwidth of the tuning 
circuit. Moreover, if the induced voltage in the circuit is $e=2\;\mu V$
(rms), find the current (rms) in the resonant circuit, and the output 
voltage (rms) across the capacitor.

{\bf Solution:} At the desired resonant frequency $f=640\;kHz$, the 
reactance of the inductor is
\[
X_L=\omega L=2\pi f L
=2\times 3.14\times 640\times 10^3\times 0.3\times 10^{-3}=1206\;\Omega 
\]
and the quality factor $Q$ of this circuit is 
\[
Q=\frac{X_L}{R}=\frac{\omega L}{R}=\frac{1206}{16}\approx 75
\]
The bandwidth is:
\[
\triangle f =\frac{f_0}{Q}=\frac{640}{75}\approx 8.53\;kHz 
\]
The resonant frequency can be expressed as:
\[
f_0=\frac{\omega_0}{2\pi}=\frac{1}{2\pi\sqrt{LC}}=640\;kHz	
\]
Solving this we get
\[
C=\frac{1}{(2\pi f_0)^2L}=206\times 10^{-12}F=206\;pF	
\]
The current in circuit is
\[
I_{rms}=e/R=2\times 10^{-6}/16=0.125\times 10^{-6}\; A =0.125\;\mu A
\]
The voltage across $R$ is
\[
V_R=I_{rms} R=0.125\times 16\times 10^{-6}=2\times 10^{-6}\;V=0.002\;mV
\]
The output voltage across $C$ is
\[
V_C = V_L=I_{rms} X_L=0.125\times 10^{-6}\times 1206=150\times 10^{-6}\;V
=150\;\mu V =0.150\;mV=Q\,V_R
\]
which is $Q=75$ times the voltage $V_R=2\times 10^{-6}$ across $R$ 
(same as the voltage source).


{\bf Example} 

In reality, all inductors have a non-zero resistance, therefore a 
parallel resonance circuit should be modeled as shown in the figure.

\htmladdimg{../figures/parallelRCL.gif}

The admittance is:
\begin{eqnarray}
  Y(\omega)&=&\frac{1}{R+j\omega L}+j\omega C
  =\frac{R-j\omega L+j\omega C(R^2+\omega^2L^2)}{R^2+\omega^2L^2}
  \nonumber \\
  &=&\frac{1}{R^2+\omega^2L^2}[R-j(\omega L-\omega C(R^2+\omega^2L^2))]
  \nonumber
\end{eqnarray}
As frequency $\omega$ appears in the real part $Re[Y(\omega)]$ as well 
as in the imaginary part $Im[Y(\omega)]$, the frequency that minimizes 
$|Y(\omega)|$ has to be found by solving
\[
\frac{d}{d\omega} \; |Y(\omega)| =0 	
\]
However, when the quality factor $Q=\omega_n L/R$ associated with the
non-ideal inductor is large enough (e.g., $Q > 20$), all previous discussed 
relations for ideal inductors still hold approximately, and the resonant 
frequency $\omega_n$ can still be found approximately by the previous 
approach by letting $Im[Y(\omega)]=0$: 
\[	\omega_n L=\omega_n C(R^2+\omega_n^2L^2),\;\;\;\;\Longrightarrow
	\;\;\;\;\;\omega_n=\sqrt{\frac{1}{LC}-\left(\frac{R}{L}\right)^2}	\]
For $\omega_n$ to be real, we must have
\[	\frac{1}{LC} > (\frac{R}{L})^2, \;\;\;\;\;\;\mbox{i,e,}
	\;\;\;\;\;\;R<\sqrt{\frac{L}{C}}	\]
Typically we have $R \ll \sqrt{L/C}$, and the resonant frequency is
\[
\omega_n=\sqrt{\frac{1}{LC}-\left(\frac{R}{L}\right)^2}\approx \frac{1}{\sqrt{LC}}
\]

{\bf Note: } For the same reason, when considering the transfer function
of a series RCL circuit when the output is the voltage across either $C$
or $L$, the peak frequency $\omega_p$ is not exactly the same as the 
resonant frequency $\omega_n$, which only minimizes the denominator, but
the numerator is still a function of $\omega$. Only when the output is 
the voltage across $R$ (i.e., the numerator is $R$, a constant, not a 
function of $\omega$), will the resonant frequency $\omega_n$ be the same 
as the peak frequency.

% \htmladdnormallink{another example}{../ch3_sub1/index.html}

{\bf Amplitude, Phase, and Frequency Modulations}

In radio or TV broadcast, the audio or video signal $s(t)$ to be transmitted 
is used to modulate the amplitude, phase, or frequency of the carrier signal 
$c(t)=\cos(\omega_c t)$ with {\em carrier frequency} $\omega_c=2\pi f_C$, which
is much higher than the highest frequency component of the signal $s(t)$. The 
modulated signal $x(t)$ is then transmitted.

\begin{itemize}
\item {\em Amplitude Modulation (AM)}

  The amplitude of the carrier is modulated by the signal $s(t)$ and becomes 
  time variant:
  \[ 
  x(t)=\cos(\omega_c t)\,[1+k_a s(t)]
  \]  
  where $0<k_a<1$ is the amplitude modulation index, and we assume the 
  amplitude of the signal is no greater than 1. For example, if the signal
  is sinusoidal $s(t)=\cos(\omega_s t)$, then the modulated signal is:
  \[ 
  x(t)=\cos(\omega_ct)[1+\cos(\omega_st)]
  =\cos(\omega_ct)+\frac{1}{2}[\cos(\omega_c+\omega_s)t+\cos(\omega_c-\omega_s)t] 
  \]
  In order to transmit all signal frequencies up to the highest frequency
  component $\omega_{max}$ in the signal, a bandwidth of 
  $\triangle\omega=(\omega_c+\omega_{max})-(\omega_c-\omega_{max})=2\omega_{max}$ 
  centered around the carrier (or central) frequency $\omega_c$ is required.  

\item {\em Phase Modulation (PM)}
  
  The phase of the carrier is modulated by the signal $s(t)$ and becomes
  time variant:
  \[
  x(t)=\cos(\omega_ct+k_p s(t))
  \]
  where $k_p$ is the phase modulation index. For example, if the signal is 
  sinusoidal $s(t)=\cos(\omega_s t)$, then the modulated signal is:
  \[ 
  x(t)=\cos(\omega_ct+k_p \cos(\omega_st))
  \]
  where $k_p$ is the phase modulation index. The phase angle of the carrier 
  is modulated to vary within the range of $(-k_p,\;k_p)$.

\item {\em Frequency Modulation (FM)}  
  
  The frequency of the carrier is modulated by the signal $s(t)$ and becomes
  time variant:
  \[
  \omega(t)=\omega_c+k_f s(t)
  \]
  where $k_f$ is the frequency modulation index. As $\omega(t) =d\phi(t)/dt$,
  the angle is also time variant:
  \[
  \phi(t)=\int_0^t\omega(\tau)d\tau=\int_0^t ( \omega_c+k_f s(\tau)) d\tau
  =\omega_c t+k_f \int_0^t s(\tau)d\tau
  \]
  and the modulated signal is:
  \[ 
  x(t)=\cos(\phi(t))=\cos\left(\omega_c t+k_f \int_0^t s(\tau)d\tau\right)
  \]
  For example, if the signal is sinusoidal $s(t)=\cos(\omega_s t)$, then
  the modulated signal is:
  \[ 
  x(t)=\cos\left(\omega_c t+k_f \int_0^t \cos(\omega_s \tau)d\tau\right)
  =\cos\left(\omega_c t+\frac{k_f}{\omega_s} \sin(\omega_s t)\right)
  \]

  \htmladdimg{../figures/AMFMmodulation.png}

\end{itemize}

The amplitude-modulated signal can be demodulated to recovered the signal
$s(t)$ from the transmitted signal by RF amplification, rectification, 
low-pass filtering, and audio signal amplification.

%\htmladdimg{../figures/AMdemodulation.png}
  
%\htmladdimg{../figures/Zach.png}

In any of the three case above, it requires a certain bandwidth around the
carrier frequency $\omega_c$ to transmit the modulated signal. Consequently, 
the $Q$ value of the tuner of the receiver needs to be very carefully chosen.
It needs to be high enough for good selectivity between different radio 
stations, but, on the other hand, it cannot be too high in order to have a 
bandwidth wide enough to contain all frequency components in the signal.

In 
\htmladdnormallink{digital broadcasting}
{https://en.wikipedia.org/wiki/Digital_broadcasting},
the information to be broadcast is first converted into digital signal,
which is then used to 
\htmladdnormallink{modulate}
{https://en.wikipedia.org/wiki/Modulation#Fundamental_digital_modulation_methods}
the phase, amplitude or frequency of the carrier signal at certain radio 
frequency:
\begin{itemize}
\item Phase-shift keying (PSK)
\item Amplitude-shift keying (ASK)
\item Frequency-shift keying (FSK)
\end{itemize}


\subsection*{Real and Reactive Power and Power Factor}

\htmladdimg{../figures/powerfactor.gif}

All loads of a power plant can be modeled by a two-terminal network of
passive elements (resistors, inductors, capacitors, without any energy 
sources) with a total complex impedance 
\[
Z=R+jX=|Z|e^{j\angle Z},\;\;\;\;\;\;\;
\left\{\begin{array}{ll}|Z|=\sqrt{R^2+X^2}\\\angle Z=\tan^{-1}(X/R)
\end{array}\right.
\]
As the loads are typically inductive (e.g., electric motors, transformers), 
i.e., $X=\omega L$, the phase angle $\phi$ of the impedance is positive. 
We are concerned with the energy consumption (by $R$) and storage (in $L$)
in the load. Let the input voltage to the load network be:
\[
v(t)=\sqrt{2}V_{rms} \cos(\omega t),\;\;\;\;\dot{V}=\sqrt{2}V_{rms}\angle 0 
\]
then the current through the power transmission line and load can be found:
\[
\dot{I}=\frac{\dot{V}}{Z}=\frac{\sqrt{2}V_{rms}}{|Z|\angle \phi}
=\sqrt{2}I_{rms}\angle(-\phi),\;\;\;\;i(t)=\sqrt{2}I_{rms} \cos(\omega t-\phi)  
\]
where $I_{rms}=V_{rms}/|Z|$ is the RMS or effective value of the current.
Note that the current is lagging the voltage by an angle $\phi$.

Consider the {\em instantaneous power} of the load defined as the product
of the voltage and current:
\begin{eqnarray}
  p_{in}(t) &=&
  v(t)\;i(t)=\sqrt{2}V_{rms}\cos(\omega t)\;\sqrt{2}I_{rms}\cos(\omega t-\phi)
  \nonumber \\
  &=&2V_{rms}I_{rms}\;\cos(\omega t)\;[\cos(\omega t)\cos\phi
    +\sin(\omega t)\sin\phi ]	\nonumber \\
  &=&V_{rms}I_{rms} \left[\cos\phi\, \left(2\cos^2(\omega t)\right)
  +\sin\phi\,\left(2\cos(\omega t)\sin(\omega t)\right) \right] \nonumber \\
  &=&V_{rms}I_{rms} \;\left[ \cos\phi\; p(t) + \sin\phi\; q(t) \right] \nonumber \\
  &=& S \;\left[\cos\phi\; p(t) + \sin\phi\; q(t) \right] 	
  =P\; p(t)+Q\; q(t)
  \nonumber 
\end{eqnarray}
where
\[
p(t)=2\cos^2(\omega t)=1+\cos 2\omega t,
\;\;\;\;\;\;
\frac{1}{T}\int_T p(t)dt&=&\frac{1}{T}\int_T [1+cos(2\omega t)] dt=1	
\]
\[
q(t)=2\cos(\omega t)\sin(\omega t)=\sin 2\omega t,
\;\;\;\;\;\;
\frac{1}{T}\int_T q(t)dt&=&\frac{1}{T}\int_T \sin(2\omega t) dt=0	
\]
and we have defined 
\begin{itemize}
\item {\em Apparent Power} (in volt-amperes): $S=V_{rms}I_{rms}$
\item {\em Real power} (in Watts): $P=S\cos\phi$ as the 
\item {\em Reactive power} (in {\em volt-ampere reactive or 
  {\em VAR}}): $Q=S\sin\phi$
\end{itemize}

As shown in the plots below, the instantaneous power $p_{in}(t)$ can be both 
positive (energy consumed by the load) and negative (energy released by the
load), and it can be represented as either a product of $v(t)$ and $i(t)$, 
or a weighted sum $p(t)$ and $q(t)$.


\htmladdimg{../figures/instantaneouspower0.gif}
%\htmladdimg{../figures/instantaneouspower1.gif}

Consider the {\em average power} over one period $T=2\pi/\omega$:
\begin{eqnarray}
  P_{average}&=&\frac{1}{T}\int_T p_{in}(t)dt
  =\frac{1}{T}\int_T  \left[P\; p(t) + Q\; q(t) \right] dt
  \nonumber \\
  &=&S\cos\phi\;\frac{1}{T}\int_T p(t)dt+S\sin\phi\;\frac{1}{T}\int_T q(t)dt
  \nonumber \\
  &=&P\;1+Q\;0=P 
  \nonumber
\end{eqnarray}
We see that
\begin{itemize}
\item The real power $P=S\cos\phi$ represents the average power dissipation 
  by the load over one period $T$;
\item The reactive power $Q=S\sin\phi$ is not consumed but converted back 
  and forth between the energy source and the energy storing (inductive)
  elements in the load.
\end{itemize}
The apparent power $S=V_{rms}I_{rms}$ can be considered as the magnitude of 
a complex product of $\dot{V}=V_{rms}\angle 0$ and 
$\overline{\dot{I}}=\overline{I_{rms}\angle(-\phi)}=I_{rms}\angle\phi$:
\[
\dot{V}\overline{\dot{I}}=V_{rms}\angle 0\; I_{rms}\angle \phi=V_{rms}I_{rms}\angle \phi
=S(\cos\phi+j\;\sin\phi)=P+jQ	
\]
On the other hand, as $\dot{V}=Z\dot{I}=(R+jX)\dot{I}$, the above can 
also be written as:
\[
\dot{V}\overline{\dot{I}}=Z\dot{I}\overline{\dot{I}}
=(R+jX)\dot{I}\overline{\dot{I}}=RI^2_{rms}+jX I^2_{rms}	
\]
Comparing the two expressions of $\dot{V}\overline{\dot{I}}$ above, we get:
\[ 
\left\{ \begin{array}{l}P=I^2_{rms}R=S\;\cos\phi \\
Q=I^2_{rms}X=S\;\sin\phi \end{array} \right. 
\]
We see that the real power $P=I^2_{rms}R$ is dissipated by the resistive
component $R$ of the load, while the reactive power $Q=I^2_{rms}X$ is stored 
in and released from the reactive component $L$ of the load. 

\htmladdimg{../figures/ComplexPower.png}

%The power consumed by an electrical motor is not reflected by the RL 
%circuit shown above. A more complete model of an electrical motor can be
%found \htmladdnormallink{here}{../MotorModel/MotorModel.html}.

{\bf Improvement of Power Factor}

The {\em Power factor} is defined as
\[
\lambda\stackrel{\triangle}{=}\cos \phi < 1
\]
To increase the efficiency of the power transmission system, i.e., to 
deliver the real power $P$ to the load with minimum reactive power $Q$ 
(thereby minimum current and power dissipation along the transmission 
line), it is desirable to maximize the power factor $\lambda$ by reducing 
$\phi$. Specifically, we can include a 
\htmladdnormallink{\em shunt capacitor}{https://www.google.com/search?q=shunt+capacitor&rlz=1C5CHFA_enUS505US508&espv=2&biw=921&bih=969&source=lnms&tbm=isch&sa=X&ei=3RlRVMK1DJCCoQTvtYKIBg&ved=0CAcQ_AUoAg&dpr=1.5}
$C$ to cancel the inductive effect in the system, thereby reducing $\phi$ 
and increasing $\lambda$. 

The most straight forward way is to add the shunt capacitor 
$C=1/\omega L$ in series with the inductive load, so that the 
inductive reactance $j\omega L$ is completely canceled by the 
capacitive reactance $1/j\omega C=-j\omega L$.

\htmladdimg{../figures/ShuntCapacitor0.png}

However, we also note that at resonance, the voltages across $L$ and 
$C$ are $Q$ times the voltage across $R$, which is the same as the 
source voltage (see \htmladdnormallink{this page}{node11.html}):
\[
\dot{V}_L=jQ\dot{V}_R,\;\;\;\;\;\dot{V}_C=-jQ\dot{V}_R
\]
the voltage across the inductive load $R+j\omega L$ becomes 
$\dot{V}_{RL}=\dot{V}_L+\dot{V}_R=jQ\dot{V}+\dot{V}=(1+jQ)\dot{V}$, 
which could be much higher than the expected source voltage $\dot{V}$ 
(without capacitor $C$) if $Q$ is large. Consequently, improper 
operation of the load or even damage may result.

The right way to compensate for the inductive impedance of the circuit
is to include the shunt capacitor $C$ in parallel to the inductive load 
so that it still gets the expected voltage.

\htmladdimg{../figures/ShuntCapacitor1.png}

Now the overall load becomes 
\begin{eqnarray}
  Z_{total}&=&Z_{RL}||Z_C=(R+j\omega L)\; || \;(1/j\omega C)
  \nonumber\\
  &=&\frac{(R+j\omega L)/j\omega C}{(R+j\omega L)+1/j\omega C}
  =\frac{R+j\omega L}{j\omega CR-\omega^2 LC+1}	
  \nonumber
\end{eqnarray}
For the new phase angle $\phi=\angle Z_{total}$ to be zero, the phases 
of the numerator and denominator need to be the same, i.e.,
\[
\tan^{-1}\left(\frac{\omega L}{R}\right)
=\tan^{-1}\left(\frac{\omega RC}{1-\omega^2 LC}\right),
\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;\;
\frac{\omega L}{R}=\frac{\omega RC}{1-\omega^2 LC}	
\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;\;
L-\omega^2 LC=R^2C
\]
Solving this equation for $C$ we get the desired capacitance:
\[
C_p=\frac{L}{R^2+\omega^2 L^2} =\frac{1}{R^2/L+\omega^2 L}<\frac{1}{\omega^2L}
=C_s
\]
%  or equivalently
%  \[ X_C=X_L+\frac{R^2}{X_L} \]
Now the voltage across the inductive load is still the same as the voltage
source as expected, and another benefit is that the required capacitance $C_p$
is smaller than the capacitance $C_s=1/\omega^2 L$ required for the series 
approach.

\htmladdnormallink{Power factor correction}{http://www.rapidpower.net/power-factor-correction}

\htmladdnormallink{Shunt capacitors}
{https://www.google.com/search?q=shunt+capacitor&rlz=1C5CHFA_enUS505US508&source=lnms&tbm=isch&sa=X&ved=0ahUKEwiS0YPWorTeAhWIFTQIHYKIBbwQ_AUIDygC&biw=729&bih=844}

%\htmladdnormallink{Power factor correction capacitors}{http://www.electrotekltd.com}

To reduce the cost of a large capacitance needed for the phase angle of 
the load to be reduced to zero $\phi=0$ so that $\lambda=\cos\phi=1$, it 
is acceptable for the improved power factor to be less than 1, e.g., 0.95. 
In this case, the phase angle of the load is
\[
\phi=\angle Z'=\tan^{-1}\left(\frac{\omega L}{R}\right)-\tan^{-1}\left(\frac{\omega RC}{1-\omega^2 LC}\right)=\cos^{-1}\; 0.9=18.2^\circ 	
\]
Solving this equation for $C$ we get the required capacitance. As now we have
\[
\tan^{-1}\left(\frac{\omega L}{R}\right)>\tan^{-1}\left(\frac{\omega RC}{1-\omega^2 LC}\right) 
\]
i.e.,
\[
\frac{\omega L}{R}>\frac{\omega RC}{1-\omega^2 LC}	
\]
we get an even smaller capacitance which is more practically implementable:
\[
C<\frac{L}{R^2+\omega^2 L^2}=\frac{1}{R^2/L+\omega^2L} 
\]



\subsection*{Load/Source Matching for Maximum Power}

{\bf Maximize power delivery in AC systems}

Previously we considered the maximization of the power received by a
resistive load $R_L$. This problem can be generalized to AC circuit containing
$C$ and $L$, as well as $R$. Consider a voltage source composed of an ideal 
voltage source $\dot{V}_0=V_{rms}\angle 0^\circ$ in series with an internal 
impedance $Z_0=R_0+jX_0$, and a load impedance $Z_L=R_L+jX_L$. The load current
is:
\[
\dot{I}=\frac{\dot{V}_0}{Z_0+Z_L}=\frac{\dot{V}_0}{(R_0+R_L)+j(X_0+X_L)}  
\]
And we have:
\[  |\dot{I}|^2=I^2_{rms}=\frac{|\dot{V}_0|^2}{|Z_0+Z_L|^2}
  =\frac{V^2_{rms}}{(R_0+R_L)^2+(X_0+X_L)^2} \]
The real power consumed by the load is:
\[
P_L=I_{rms}^2 R_L =\frac{V^2_{rms}R_L}{(R_0+R_L)^2+(X_0+X_L)^2}
=\frac{V^2_{rms}R_L}{|Z_0+Z_L|^2}
\]
The denominator is the squared magnitude of a complex variable
$Z_0+Z_L=(R_0+R_L)+j(X_0+X_L)$, which is minimized if the imaginary part 
$X_0+X_L$ is zero, i.e., $X_0=-X_L$ (while the real part $R_0+R_L>0$ is 
always positive). Now $P_L$ becomes:
\[
P_L=I_{rms}^2 R_L=\frac{V^2_{rms}R_L}{(R_0+R_L)^2} 
\]
This is the power delivered to the load resistance $R_L$, which is maximized
if it matches the internal resistance of the source $R_L=R_0$, as discussed 
before. Combining these two requirements $X_L=-X_0$ and $R_L=R_0$, we conclude
that if $Z_L=R_L+jX_l=R_0-jX_0=Z_0^*$, i.e., the load impedance $Z_L$ is the 
complex conjugate of the internal impedance $Z_0$, the load receives maximum
power:
\[
P_L=\frac{V^2_{rms}R_L}{(R_0+R_L)^2}=\frac{V_{rms}^2}{4R_0} 
\]

{\bf Example:}
Find load impedance $Z_L$ so that it receives maximum power from the rest 
of the circuit. Find this maximum power $P_L$ and load current $\dot{I}_L$.

\htmladdimg{../figures/ch3Ex1.gif}

Assume voltage source $V_0=200 V$, current source $I_0=j\;10 A$, and the 
impedances of $R$, $L$, and $C$ are respectively $10\;\Omega$, 
$j\;10\;\Omega$, and $-j\;10\;\Omega$. To solve this circuit, we can use 
either Thevenin's voltage source or Norton's current source method.

\begin{itemize}
\item Find $Z_N=Z_T$: turn off both voltage and current sources, find 
  $Z_{RL}=Z_L+Z_R=10+j10$ and the internal (Thevenin or Norton) impedance:
  \[ 
  Z_N=Z_T=Z_{RL}||Z_C=\frac{Z_{RC}Z_C}{Z_{RC}+Z_C}
  =\frac{-j10(10+j10)}{10+j10-j10}=10(1-j)=R_0+jX_0
  \]
  where $R_0=10\;\Omega$, $X_0=-10\;\Omega$.
\item Find open-circuit voltage $\dot{V}_T=\dot{V}_{oc}$ across load port 
  by superposition principle. Due to voltage source alone:
  \[
  \dot{V}'_{oc}=V_0\frac{Z_C}{Z_{RL}+Z_C}
  =200\frac{-j10}{(10+j10)-j10}=-200j 
  \]
  Due to current source alone:
  \[ 
  \dot{V}''_{oc}=I_0\;Z_{RL}||Z_C
  =j10\frac{(10+j10)(-j10)}{(10+j10)-j10}=100+100j 
  \]
  Now we have
  \[
  \dot{V}_T=\dot{V}_{oc}=\dot{V}'_{oc}+\dot{V}''_{oc}=-200j+100+100j=100(1-j)
  =100\sqrt{2}\angle(-45^\circ) 
  \]
\item Find short-circuit current $\dot{I}_N=\dot{I}_{sc}$ through load port
  by superposition principle:
  \[ 
  \dot{I}_N=I_0+\frac{V_0}{Z_{RL}}
  =10j+\frac{200}{10+10j}=10j+\frac{20(1-j)}{(1+j)(1-j)}=10 
  \]
\end{itemize}
The relationship between the Norton current and Thevenin voltage can be
verified:
\[
\dot{I}_N Z_N=10\times10(1-j)=100(1-j)=100\sqrt{2}\angle(-45^\circ)=\dot{V}_T  
\]
For the load to receive maximum power, it needs to be
\[
Z_L=Z_T^*=Z_N^*=R_0-jX_0=10(1+j) 
\]
The maximum power delivered to load is:
\[
P_L=\frac{V^2_{rms}}{4R_0}=\frac{(100\sqrt{2})^2}{4\times 10}=500\;W 
\]
The current through the load is:
\[ 
\dot{I}=\frac{\dot{V}}{2R_0}=\frac{100\sqrt{2}\angle(-45^\circ)}{20}
=5\sqrt{2}\angle (-45^\circ) 
\]

{\bf Geometric mean method}

The load resistance $R_L$ will receive maximum power only if it matches the 
internal resistance $R_0$ of the voltage source, $R_L=R_0$. However, when
$R_L\ne R_0$, the resistance match can still be achieved by inserting a 
matching circuit between the source and load as shown in the figure. 

The matching circuit is composed of two capacitors $C_1=C_2$ of the same 
impedance $-jX$ and an inductor $L$ of impedance $jX$. Alternatively, the 
two capacitors and the inductor in the matching circuit can be replaced by 
two inductors and a capacitor. If the frequency of the voltage source is 
$\omega=2\pi f$, then $X=\omega L=1/\omega C$, i.e., $LC=1/\omega^2$.

\htmladdimg{../figures/matchingcircuits.gif}

The total impedance of the new load composed of all four components $C_1=C_2$,
$L$ as well as $R_L$ is real (resistive):
\[ 
Z_L=-jX+jX || (R_L-jX)=-jX+\frac{jX(R_L-jX)}{R_L}=\frac{X^2}{R_L} 
\]
Or, in the alternative case, the impedance of the new load is the same:
\[
Z_L=jX+(-jX) || (R_L+jX)=jX+\frac{-jX(R_L+jX)}{R_L}=\frac{X^2}{R_L} 
\]
For this load impedance $Z_L$ to match the internal resistance $R_0$ of the 
source, we have
\[
Z_L=\frac{X^2}{R_L}=R_0,\;\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;\;\;X=\sqrt{R_0R_L} 
\]
i.e., the reactance $X$ is the geometric mean of the source and load resistances
$R_0$ and $R_L$. Note that the matching circuit consumes no real power as it 
does not have any resistance. We can verify that the power consumed by $R_L$ is 
$P_L=V^2/4R_0$.

This method can be generalized to any AC circuit composed of a voltage 
source with an internal impedance $Z_0=R_0+jX_0$ and load impedance 
$Z_L=R_L+jX_L$ in the following two steps:
\begin{itemize}
\item First we replace the impedance $-jX$ of capacitor $C_2$ in series 
  with the load by $-j(X+X_L)$, so that the additional reactance $-X_L$ 
  cancels the load reactance $X_L$, and the impedance in the load branch
  is $R_L-jX$.
\item Next we replace the impedance $-jX$ of capacitor $C_1$ in series 
  with the source by $-j(X+X_0)$, so that the additional reactance $-jX_0$
  cancels the source reactance $X_0$, and the impedance in the source
  branch is $R_0-jX$.
\item We can show that the impedance of the equivalent load composed 
  of $-j(X+X_0)$, $jX$, and $-j(X+X_L)$ of the matching circuit and 
  $Z_L=R_L+jX_L$ of the load is indeed the complex conjugate of the
  internal impedance $Z_L=R_0+jX_0$ of the source:
  \[ 
  Z_L=-j(X+X_0)+jX || (R_L-jX)=-j(X+X_0)+\frac{jX(R_L-jX)}{R_L}
  =\frac{X^2}{R_L}-jX_0=R_0-jX_0 =Z^*_0 
  \]
  i.e., now the load-source resistance match is achieved. 
\end{itemize}

As this method requires a fixed reactance $X$, it is valid for single
frequency $\omega=1/\sqrt{LC}$.

{\bf Example:} An audio amplification circuit with an output voltage $V_0$
and internal resistance $R_0=200\;\Omega$ is used to drive a speaker with 
$R_L=8\;\Omega$. 
The power received by the speaker is:
\[ P_L=I^2R_L=\frac{V_0^2}{(R_0+R_L)^2}R_L=V_0^2\frac{8}{208^2} \]
The power consumed by the internal resistance $R_0$ is:
\[ P_0=I^2R_0=\frac{V_0^2}{(R_0+R_L)^2}R_0=V_0^2\frac{200}{208^2} \]
The total power delivered is:
\[ P_T=P_L+P_0=\frac{V_0^2}{R_0 || R_L} =V_0^2\frac{208}{208^2} \]
The speaker gets only $P_L/P_T=8/208=3.8\%$ of the total power, while the 
remaining $P_0/P_T=200/208=96.2\%$ of the power is consumed internally. 

To maximize the power delivered to the speaker, we add a matching circuit 
composed of $C_1=C_2$ with impedance $Z_C=-jX$ and $L$ with impedance 
$X_L=jX$. When $X=\sqrt{R_0R_L}=\sqrt{1600}=40$, the resistance of the new
load $R'_L=200\;\Omega$ matches the internal resistance $R_0$ of the source,
and the speaker receives maximum power of $P_L=V_0^2/4R_0=V^2/800$ (half of
the total power $P_T=V^2/2R_0=V^2/400$), 6.76 times the power without
the matching circuit. 

As the frequency in the system is not constant, the matching is achieved
only at one particular frequency, typically chosen to be the middle of
the frequency range. 

{\bf Matching resistances by a transformer}

An ideal transformer can be used to match the load $R_L$ to the internal 
resistance $R_0$ of the source. Recall the following relations for an ideal 
transformer
\[
P_1=V_1I_1=P_2=V_2I_2,\;\;\;\;\mbox{i.e.}\;\;\;\;
\frac{I_2}{I_1}=\frac{V_1}{V_2}=\frac{n_1}{n_2}=r	
\]
where $r=n_1/n_2$ is the turn ratio. As $V_2=V_1/r$ and $I_2=rI_1$, we have 
\[ 
R_L=\frac{V_2}{I_2}=\frac{V_1/r}{rI_1}=\frac{1}{r^2}\frac{V_1}{I_1}
=\frac{R'_L}{r^2}
\]
where we have defined $R'_L=V_1/I_1$, which is related to the real load by
$R'_L=r^2 R_L$. For the load to receive maximum power $P_L=P'_L$, we need to 
match the equivalent load resistance $R'_L$ to match $R_0$:
\[ 
R_0=R'_L=r^2 R_L,\;\;\;\;\;\mbox{i.e.}\;\;\;\;\;
r=\frac{n_1}{n_2}=\sqrt{\frac{R_0}{R_L}} 
\]
%Note that this method does not work for load of complex impedance.

\htmladdimg{../figures/transformerexample.gif}

{\bf Example:} In the previous example with $R_0=200\;\Omega$, 
$R_L=8\;\Omega$, a transformer with turn ratio of 
$r=\sqrt{R_0/R_L}=\sqrt{200/8}=5$ can be used to match the load
$R_L=8$ to internal resistance $R_0=200$.



{\bf Example:} $R_0=1000\Omega$, $R_L=10\Omega$, and the voltage 
source is $V=12V$. Find the turn ratio of the transformer so that 
the load resistor will get maximum power from the voltage source.

When the load resistor receives maximum power if its resistance 
is equal to the internal resistance of the voltage source. 
\begin{itemize}
\item Convert load resistance on the secondary side $R_L=10\Omega$ to 
	$R'_L=r^2\; R_L=10\; r^2$ on the primary side.
\item Match $R'_L=10\;r^2$ to $R_0$, i.e., $10\; r^2=1000\Omega$
\item Find turn ratio $r=n_1/n_2=10$.
\item Find power consumption on $R'_L$: 
	\[ P=\frac{V}{4R'_L}=36/1000=0.036W	\]
\item The power consumed by real load $R_L$ is the same, due to ideal 
transformer.
\end{itemize}


\subsection*{Summary}

\begin{itemize}
\item {\bf Phasor Representation:}
\[	v(t)=V\;\cos(\omega t +\phi),\;\;\;\;\;\; \dot{V}=V_{rms}\angle{\phi} \]
\[	i(t)=I\;\cos(\omega t +\psi),\;\;\;\;\;\; \dot{I}=I_{rms}\angle{\psi} \]
\item {\bf KVL and KCL:}
\[	\sum_k \dot{V}_k=0,\;\;\;\;\;\;\;\;\sum_k \dot{I}_k=0	\]
\item {\bf Ohm's Law:}
\[	Z=\frac{\dot{V}}{\dot{I}}=\frac{V_{rms}}{I_{rms}}\angle{(\phi-\psi)} \]
\item {\bf Impedance and Admittance:}
\[	Z=R+jX,\;\;\;\;\;\;\;
\mbox{{\bf impedance}}=\mbox{{\bf resistance}}+j\;\mbox{{\bf reactance}} \]
\[	Y=G+jB,\;\;\;\;\;\;\;
\mbox{{\bf admittance}}=\mbox{{\bf conductance}}+j\;\mbox{{\bf susceptance}} \]
\[ Y=\frac{1}{Z}=\frac{1}{R+jX}=\frac{R}{R^2+X^2}+j\;\frac{-X}{R^2+X^2}=G+jB \]
\item {\bf Complete Response:} The three components:
	\begin{itemize}
	\item Initial value $f(0)$ for DC input or $f_0(t)$ for AC input.
	\item steady state response $f(\infty)$ for DC input or $f_\infty(t)$ for 
	  AC input
	\item Time constant $\tau$ 
	\end{itemize}
	The complete response is:
\[ f(t)=f(\infty)+[f(0)-f(\infty)]\;e^{-t/\tau},\;\;\;\;\mbox{or}
	\;\;\;\;f(t)=f_\infty(t)+[f_0)-f_\infty(0)]\;e^{-t/\tau}	\]
	Find $\tau$:
	\begin{itemize}
	\item remove C or L in question from circuit
	\item short voltage sources and open current sources
	\item find equivalent $R$
	\item find $\tau=RC$ or $\tau=L/R$
	\end{itemize}
\item {\bf Series Resonance:}
\[	Z=R+j\omega L+\frac{1}{j\omega C}=R+j(\omega L-\frac{1}{\omega C})
	=R+jX	 \]
	if $\omega=\omega_n=1/\sqrt{LC}$, then $X=\omega L-1/\omega C=0$, 
	and $Z=R$ is minimized.

	{\bf Quality factor:} 
\[	Q=\frac{\omega_n L}{R}=\frac{1}{\omega_n RC}=\frac{1}{R}\sqrt{\frac{L}{C}} \]

\[	\dot{V}_R=\dot{V},\;\;\;\;\dot{V}_L=jQ\dot{V},\;\;\;\;\;\dot{V}_C=-jQ\dot{V} \]

\item {\bf Parallel Resonance:}
\[	Y=G+j\omega C+\frac{1}{j\omega L}=G+j\left(\omega C-\frac{1}{\omega L}\right)
	=G+jB	 \]
	if $\omega=\omega_n=1/\sqrt{LC}$, then $B=\omega L-1/\omega C=0$, 
	and $Y=G$ is minimized.

	{\bf Quality factor:} 
\[	Q=\frac{\omega_n C}{G}=\frac{1}{\omega_n LG}=\frac{1}{G}\sqrt{\frac{C}{L}} \]

\[	\dot{I}_R=\dot{I},\;\;\;\;\dot{I}_C=jQ\dot{I},\;\;\;\;\;\dot{I}_L=-jQ\dot{I} \]
\item {\bf Band-pass filtering:}

	Half-power point: frequencies $\omega_1<\omega_n$ and $\omega_2>\omega_n$
	at which signal power reduced to half of the peak level at $\omega=\omega_n$.
	Correspondingly, the voltage (or current) is reduced to $1/\sqrt{2}=0.707$
	of the peak level.

	Bandwidth: \[ \triangle \omega=\omega_2-\omega_1=\frac{\omega_n}{Q} \]

\item {\bf AC Power:}
\begin{itemize}
\item Phase difference between $v(t)$ and $i(t)$:
	\[ \dot{I}=\frac{\dot{V}}{Z}=\frac{V_{rms}\angle 0}{|Z|\angle{\phi}}
		=I_{rms}\angle{-\phi}	\]
\item Instantaneous power:	
	\[ p(t)=v(t) i(t)=2V_{rms}I_{rms}\cos(\omega t)\cos(\omega t-\phi) \]
\item Average power:
	\[ P_{average}=\frac{1}{T}\int_T p(t) dt=V_{rms}I_{rms} \cos \phi \]
\item Apparent power: $ S=V_{rms} I_{rms}$
\item Real power: $P=S \; \cos\phi=V_{rms} I_{rms} \cos \phi$
\item Reactive power: $Q=S \; \sin\phi=V_{rms} I_{rms} \sin \phi$
\item Power factor $0 < \lambda=\cos \phi < 1$
\item Shunt capacitor to improve power factor (close to 1)
\end{itemize}

\item {\bf Two-port networks:}
\begin{itemize}
\item Z-model:
\[ \left[ \begin{array}{l} V_1 \\ V_2\end{array} \right]
	={\bf Z}\left[ \begin{array}{l} I_1 \\ I_2\end{array} \right] \]
\item Y-model:
\[ \left[ \begin{array}{l} I_1 \\ I_2\end{array} \right]
	={\bf A}\left[ \begin{array}{l} V_1 \\ V_2\end{array} \right] \]
\item A-model:
\[ \left[ \begin{array}{l} V_1 \\ I_1\end{array} \right]
	={\bf Z}\left[ \begin{array}{l} V_1 \\ -I_2\end{array} \right] \]
\item H-model:
\[ \left[ \begin{array}{l} V_1 \\ I_2\end{array} \right]
	={\bf H}\left[ \begin{array}{l} I_1 \\ V_2\end{array} \right] \]
\end{itemize}
How to find these parameters? Open circuit to let $I=0$, or short circuit to
let $V=0$.
\item Principle of reciprocity: $Z_{12}=Z_{21}$, $Y_{12}=Y_{21}$.

\item Conversion between Z-model and Y-model: ${\bf Z}^{-1}={\bf Y}$.

\item Conversion between Z-model and T-network:
\[ Z_{11}=Z_1+Z_3,\;\;\;\;\;Z_{22}=Z_2+Z_3,\;\;\;\;\;Z_{12}=Z_{21}=Z_3	\]
\[ Z_1=Z_{11}-Z_{12},\;\;\;\;Z_2=Z_{22}-Z_{21},\;\;\;\;Z_3=Z_{12}=Z_{21} \]

\item Conversion between Y-model and Pi-network:

\[ Y_{11}=Y_1+Y_3,\;\;\;\;\;Y_{22}=Y_2+Y_3,\;\;\;\;\;Y_{12}=Y_{21}=-Y_3	\]
\[ Y_1=Y_{11}+Y_{12},\;\;\;\;Y_2=Y_{22}+Y_{21},\;\;\;\;Y_3=-Y_{12}=-Y_{21} \]

\item {\bf Ideal Transformer:}

\[	\frac{V_2}{V_1}=\frac{I_2}{I_1}=\frac{n_1}{n_2},\;\;\;\;\;
	\frac{Z_2}{Z_1}=\frac{n^2_2}{n^2_1}	\]
\end{itemize}

\subsection*{Review of Complex Arithmetic} 

A complex number can be represented in two different formats in either
the Euclidean and polar coordinate system:
\begin{itemize}
\item {\bf Euclidean representation:} 

  $z=x+jy$ where $x$ and $y$ are the real (horizontal) and imaginary 
  (vertical) part of complex variable $z$, respectively.
\item {\bf Polar representation:} 

  $z = |z|\;e^{j\angle z}$, or simply $z=|z|\;\angle z$, where $|z|$ and
  $\angle z$ are the magnitude and phase angle, respectively.
\end{itemize}

\htmladdimg{../figures/complex_number.gif}

The two representations can be converted from one to the other:
\begin{itemize}
\item From $(x,y)$ to $(|z|,\angle z)$:
  \[
  \left\{ \begin{array}{ll} |z|=\sqrt{x^2+y^2} & \mbox{magnitude}\\
    \angle z=tan^{-1} (y/x) & \mbox{phase angle}
  \end{array} \right. 
  \]
\item From $(|z|,\angle z)$ to $(x,y)$:
  \[ 
  z=|z|\;e^{j\angle z}=|z|(\cos\angle z+j\;\sin\angle z)=x+jy 
  \]
  due to Euler identity, i.e.,
  \[
  \left\{ \begin{array}{ll} x=|z|\;\cos\angle z & \mbox{real part}\\
    y=|z|\;\sin\angle z & \mbox{imaginary part}
  \end{array} \right. 
  \]
\end{itemize}

The arithmetic operations of two complex numbers $z=x+jy=|z|\;e^{j\angle z}$ 
and $w=u+jv=|w|\;e^{j\psi}$ are listed below:
\begin{itemize}
\item {\bf Add/Subtract:} 
  \[	z+w=(x+u)+j(y+v),\;\;\;\;z-w=(x-u)+j(y-v)	\]

\item {\bf Multiply:}
  \[ z\;w=(x+jy)(u+jv)=(xu-yv)+j(xv+yu)=|z|\;|w|\;e^{j(\angle z+\angle w)} \]

\item {\bf Divide:}
  \[	\frac{z}{w}=\frac{x+jy}{u+jv}=\frac{(x+jy)(u-jv)}{(u+jv)(u-jv)}
	=\frac{(xu+yv)+j(yu-xv)}{u^2+v^2}
	=\frac{|z|}{|w|}\;e^{j(\angle z-\angle w)}	\]

\item {\bf Rotation:}

  When a complex number, a vector in complex plane, $z=|z|\;e^{j\angle z}$ is
  multiplied by $e^{j\alpha}$, it becomes $z\;e^{j\angle z}=|z|\;e^{j(\angle z+\alpha)}$, 
  i.e., rotated by an angle of $\alpha$. The rotation is counter-clock wise
  if $\alpha>0$, but clock-wise if $\alpha<0$. When the rotating angle is a 
  linear function of time $\alpha=\omega t$, then vector
  $z=|z|\;e^{j(\angle z+\omega t)}$ becomes a rotating vector with angular frequency
  $\omega$.

  In particular, As $e^{j\pi/2}=j$ and $e^{-j\pi/2}=-j$, they can be considered 
  as $90^\circ$ rotation factors. Any complex number multiplied by $j$ or $-j$ 
  will be rotated counter clockwise or clockwise by 90 degrees.

\item {\bf Complex Conjugate:}

  The complex conjugate of $z=x+jy=|z|e^{j\angle z}$ is 
  $z^*=x-jy=|z|e^{-j\angle z} $. In general, $z^*$ can be obtained by
  negating every $j$ in the expression of $z$ (replacing $j$ by $-j$). 
  The magnitude of a complex number $z=x+jy$ can be found by:
  \[	
  \sqrt{zz^*}=\sqrt{(x+jy)(x-jy)}=\sqrt{x^2+y^2}=|z|
  \]

\item {\bf Reciprocal:}
  \[	|z^{-1}|=\frac{1}{|z|}=\frac{1}{\sqrt{x^2+y^2}},\;\;\;\;
	\angle\left(z^{-1}\right)=\angle\left(\frac{1}{z}\right)
        =0-\angle{z}=-\angle z	\]

\end{itemize}

{\bf Addition/Subtraction of Sinusoids:}

Consider the addition/subtraction of two sinusoids of the same frequency 
$\omega$:
\[ \left\{ \begin{array}{l} x_1(t)=A_1\cos(\omega t+\phi_1)\\
  x_2(t)=A_2\cos(\omega t+\phi_2) \end{array} \right. \]
As the frequency of the sum is obviously the same as $\omega$, we can write
the sum as:
\[ x(t)=x_1(t)+x_2(t)=A\cos(\omega t+\phi) \]
and we need to find $A$ and $\phi$ in terms of $A_1$, $A_2$, $\phi_1$ and 
$\phi_2$.
\begin{eqnarray}
  x(t)&=&x_1(t)+x_2(t)=A_1\cos(\omega t+\phi_1)+A_2\cos(\omega t+\phi_2)
  \nonumber \\
  &=&A_1\cos\omega t\cos\phi_1-A_1\sin\omega t\sin\phi_1
  +A_2\cos\omega t\cos\phi_2-A_2\sin\omega t\sin\phi_2
  \nonumber \\
  &=&(A_1\cos\phi_1+A_2\cos\phi_2)\cos\omega t
  -(A_1\sin\phi_1+A_2\sin\phi_2)\sin\omega t
  \nonumber \\
  &=&A\cos\phi\cos\omega t-A\sin\phi\sin\omega t
  \nonumber \\
  &=&A_r\cos\omega t-A_j\sin\omega t
  \nonumber \\
  &=&A \cos(\omega t+\phi) 
  \nonumber
\end{eqnarray}
where we have used the trigonometric identity 
$\cos(\alpha+\beta)=\cos\alpha\cos\beta-\sin\alpha\sin\beta$
and assumed
\[ 
\left\{ \begin{array}{l} A_r=A\cos\phi =A_1 \cos\phi_1+A_2 \cos\phi_2\\
  A_j=A\sin\phi =A_1\sin\phi_1+A_2\sin\phi_2\end{array} \right. 
\;\;\;\;\;\mbox{and}\;\;\;\;\;
\left\{ \begin{array}{l} A=\sqrt{A^2_r+A^2_j}\\
  \phi=\tan^{-1} (A_j/A_r) \end{array} \right. 
\]
Here $(A_r\,A_j)$ and $(A,\,\phi)$ are respectively the Cartesian and polar 
representations of the same vector in the complex plane $A_r+j\;A_j=A e^{j\phi}$.



\section*{Appendix}

\subsection*{Logarithmic and Complex operations}

Assume $w=u+jv=|w|\angle w=|w|e^{j\angle w}$, and $z=x+jy=|z|\angle z=|z|e^{j\angle z}$. 
\begin{itemize}
  \item 
    \[  \left\{ \begin{array}{l}
      |w|=\sqrt{u^2+v^2},\;\;\;\;\angle w=\tan^{-1}\left( v/v \right) \\
      |z|=\sqrt{x^2+y^2},\;\;\;\;\angle z=\tan^{-1}\left( y/x \right) \end{array} \right. \]
  \item 
    \[ w z=(u+jv)(x+jy)=|w|e^{j\angle w}\;|z|e^{j\angle z} \]
    \[ \left| wz \right| =|w||z|,\;\;\;\;\;
    e^{j\angle w} e^{j\angle z}=e^{j(\angle w+\angle z)},
    \;\;\;\mbox{or}\;\;\;\;
    \angle \left( wz \right) =\angle w+\angle z \]
  \item 
    \[ \frac{w}{z}=\frac{u+jv}{x+jy}=\frac{|w|e^{j\angle w}}{|z|e^{j\angle z}} \]
    \[ \left| \frac{w}{z} \right| =\frac{|w|}{|z|},\;\;\;\;\;
    \frac{e^{j\angle w}}{e^{j\angle z}}=e^{j(\angle w-\angle z)},\;\;\;\mbox{or}\;\;\;
    \angle \left( \frac{w}{z} \right)=\angle w-\angle z  \]
\end{itemize}

\begin{itemize}
  \item \[ \log \;(ab)=\log a+\log b \]
  \item \[ \log \;(a/b)=\log a-\log b \]
  \item \[ \log \;(a^n)=n\;\log a \]
  \item \[ \log \;(a^{-n})=-n\;\log a \]
\end{itemize}

\subsection*{Impedance}

In DC circuits the relationships of various voltages and currents are described 
by a set of linear algebraic equations, while in AC circuits they are described
by a set of linear differential equations. 

The resistance $R$ of a resistor is defined by Ohm's law as the ratio of voltage 
$v$ across a resistor and current $i$ through the resistor: $ R=v/i$.
This concept is generalized to that of impedance $Z$ of any element (L, C, as
well R) in AC circuits, defined as the frequency response function of the element
with the current through the element as the input and the voltage across the element
as the output:
\[
Z=\frac{V}{I}=\frac{v_m e^{j\phi}}{i_m e^{j\psi}}=\frac{v_m}{i_m} e^{j(\phi-\psi)} 
\]
This is the generalized Ohm's law, which represents impedance $Z$ as the ration 
of the phasor voltage $V$ across an element and the phasor current $I$ through it.
In other words, impedance $Z$ represents (a) the phase difference between $V$ and 
$I$ as well as (b) the ratio of their amplitudes.


\begin{itemize}
\item Inductor $L$: Assume the current through $L$ is $I e^{j\omega t}$, 
  then the voltage across L is:
  \[ V e^{j\omega t}=L\frac{d}{dt} [I e^{j\omega t}]=j\omega L I e^{j\omega t}
  \;\;\;\;\mbox{i.e.}\;\;\;\;\;\;Z_L=\frac{V}{I}=\frac{j\omega LI}{I}=j\omega L \]
\item Capacitor $C$: Assume the voltage across $C$ is $V e^{j\omega t}$, 
  then the current through C is
  \[ I e^{j\omega t}=C\frac{d}{dt} [V e^{j\omega t}]=j\omega C V e^{j\omega t}
  \;\;\;\;\mbox{i.e.}\;\;\;\;\;\;Z_C=\frac{V}{I}=\frac{V}{j\omega CV}=\frac{1}{j\omega C} \]
\item Resistor $R$: the voltage across R and current through R are in phase, therefore:
  \[ Z_R=\frac{V}{I}=\frac{v_me^{j\phi}}{i_me^{j\phi}}=\frac{v_m}{i_m}=R \]
\end{itemize}

All familiar laws such as Ohm's law, KCL and KCL, current divider and voltage
divider, can be generalized and applied to the analysis of AC circuit containing
elements such as L, C as well as R.

\subsection*{Decibel (dB)}

The bel (B) is a unit of measurement for the ratio of a physical quantity 
(power, intensity, magnitude, etc.) and a specified or implied reference 
level in base-10 logarithm. As it is a ratio of two quantities with the same 
unit, it is dimensionless. 

For example, consider a power amplifier with input signal power $P_{in}=100\; mW$ 
and output signal power $P_{out}=10\;W$, then the power gain of the amplifier is 
$P_{out}/P_{in}=100$, which can be more concisely expressed in base-10 log scale:
\[
L_B=\log_{10} \frac{P_{out}}{P_{in}}=\log_{10} \frac{10}{0.1} =\log_{10} 100 =2\; bel(B)
\]
The unit bel (B) was first used in early 1920's in honor of 
\htmladdnormallink{Alexander Bell (1847 -- 1922)}{http://en.wikipedia.org/wiki/Alexander_Graham_Bell},
a telecommunication pioneer and founder of the Bell System (the Bell Labs).

As bel (B) is often too big a unit (a gain of 100 is only 2 B), a smaller
unit of decibel (dB), 1/10 of the unit bel (B), is more widely used instead. 
Now the power gain above can be expressed as:
\[ L_B=\log_{10}\frac{P_{out}}{P_{in}}=\log_{10} 100 =2\;B=20\;dB,
\;\;\;\;\mbox{or}\;\;\;\;\;
L_{dB}=10 \log_{10}\frac{P_{out}}{P_{in}}=20\;dB \]
Similarly a 1,000 fold power gain is expressed as:
\[ 
L_B=\log_{10}\frac{P_{out}}{P_{in}}=\log_{10} 1000 =3\;B=30\;dB,
\;\;\;\;\mbox{or}\;\;\;\;
L_{dB}=10 \log_{10}\frac{P_{out}}{P_{in}}=30\;dB 
\]
Given the input power $P_{in}$ and the power gain in decibel, e.g., 
$L_{dB}=30\;dB$, the output power can be obtained as:
\[
\frac{P_{out}}{P_{in}}=10^{L_{dB}/10}=10^{30/10}=10^3,
\;\;\;\;\mbox{i.e.}\;\;\;\;P_{out} =10^3\;P_{in}=1,000\;P_{in} 
\]

As another example, the sound level is measured in decibel, in terms of the ratio
of the sound intensity (power per area, e.g., $W/m^2$) and the threshold of human 
hearing ($10^{-12}\; W/m^2$) as the reference. The human hearing has a large range 
from 0 dB (threshold) to 140 dB (military jet takeoff, $10^{14}$ times the threshold, 
i.e., $10^2\; W/m^2$). 160 dB sound level will cause instant membrane/eardrum 
perforation.

In general, power (and energy) is always proportional to the amplitude of certain
quantity squared (e.g., $P=V^2/R=I^2 R$, $E=mv^2/2$, $E=kx^2/2$). Therefore a 
different definition is used for ratios between two amplitudes, for example, the
output and input voltages $V_{out}$ and $V_{in}$ of a voltage amplifier, we have:
\[ L_{dB}=10 \log_{10} \frac{V^2_{out}}{V^2_{in}}
=20 \log_{10} \frac{V_{out}}{V_{in}}\;dB \]
If the input to a voltage amplifier is 10 mV and the output voltage is 1 V, then the
voltage gain in terms of decibel is:
\[ 20 \log_{10} \frac{V_{out}}{V_{in}}=20 \log_{10} \frac{1,000}{10}=40\; dB \]
If the output voltage is 10 V, then
\[ 20 \log_{10} \frac{V_{out}}{V_{in}}=20 \log_{10} \frac{10,000}{10}=60\; dB \]
We see that the difference of one order of magnitude in the gain corresponds to 20 dB.

Given the input voltage $V_{in}$ and the voltage gain in decibel, e.g., $L_{dB}=60\;dB$, 
the output voltage can be obtained as:
\[ \frac{V_{out}}{V_{in}}=10^{L_{dB}/20}=10^{60/20}=10^3,
\;\;\;\;\mbox{i.e.,}\;\;\;\;\; V_{out}=10^3 V_{in}=1,000 V_{in} \]

A related issue is the half power point. Recall that for a second order system, when
$\zeta$ is small (e.g., $\zeta<0.2$), the magnitude $|H(j\omega)|$ of the frequency 
response function has a peak at $\omega=\omega_p\approx \omega_n$. The bandwidth of 
the peak is defined as the difference between two cut-off frequencies $\omega_1$ 
and $\omega_2$ ($\omega_1<\omega_n < \omega_2$) at which 
\[ |H(j\omega_1)|^2=|H(j\omega_2)|^2=\frac{1}{2} |H(j\omega_p)|^2\;\;\;\mbox{i.e.,}\;\;\;\;
   | H(j\omega_{1,2}) |=0.707\; | H(j\omega_p) | \]
The ratio between the half-power point and the peak in decibel is
\[ 20 \log_{10} \left( \frac{ |H(j\omega_{1,2})|}{| H(j\omega_p) |} \right)
=20 \log_{10} 0.707=-3.01\;dB \approx -3\;dB \]

\subsection*{Bode Plots}

The Bode plot is named after 
\htmladdnormallink{Hendrik Wade Bode (1905 -- 1982)}{http://en.wikipedia.org/wiki/Hendrik_Wade_Bode}, an American engineer and scientist, of Dutch ancestry,
a pioneer of modern control theory and electronic telecommunications. 

The {\bf frequency response function (FRF)} is a complex function of the 
frequency $\omega=2\pi f$ that describes the response of a system to input of
different frequencies:
\[ H(j\omega)=|H(j\omega)|e^{j\angle H(j\omega)}=|H(j\omega)| \angle H(j\omega) \]

The {\bf Bode plot} presents both the magnitude $|H(j\omega)|$ and phase 
angle $\angle H(j\omega)$ of $H(j\omega)$ as functions of frequency in 
logarithmic scale. (Zero frequency is at $-\infty$ as $10^{-\infty}=0$.)
Moreover, the magnitude $| H(j\omega) |$ is also represented in logarithmic
scale in decibel (dB), and is called log magnitude.
A Bode plot is composed of two parts:
\begin{itemize}
  \item The log magnitude (Lm) of $|H(j\omega)|$ with unit decibel (dB):
  \[ Lm\; H(j\omega)=20 \;log_{10} |H(j\omega)|\;dB \]
  \item The phase plot $\angle H(j\omega)$ with either in radian or degree.
\end{itemize}
The logarithmic scale of the frequency is composed of several ``decades'' each 
for a range of frequencies from $\omega$ to $10 \omega$, independent of the 
specific frequency $\omega$.

Bede plots have the following advantages:
\begin{itemize}
  \item Due to the logarithmic scale in frequency, large frequency range of 
    several orders of magnitude can be represented;

  \item Convenient straight line asymptotes can be used to approximate the plots;

  \item The behavior of the system in terms of the magnitude, even
    approaching zero, can be clearly described.
    
  \item Due to the logarithmic scale of the magnitude of the FRF, multiplications 
    and divisions of FRFs can be represented as addition and subtractions in the 
    plot (while the phases are always added/subtracted):
    \[ \left\{ \begin{array}{ll}
      Lm(H_1H_2)=Lm\;H_1+Lm\;H_2,&\;\;\;\;\angle (H_1H_2)=\angle H_1+\angle H_2\\
      Lm(H_1/H_2)=Lm\;H_1-Lm\;H_2,&\;\;\;\;\angle (H_1/H_2)=\angle H_1-\angle H_2\\
      Lm \;H^n=n\;Lm \;H,&\;\;\;\;\angle H^n=n\;\angle H \\
      Lm (1/H)=-Lm\;H,&\;\;\;\;\angle (1/H)=-\angle H \end{array} \right. \]
\end{itemize}

All FRFs of interest in this course can be considered as a combination of 
some components or building blocks, including:
\begin{itemize}
  \item Constant gain $k$;
  \item Integral/derivative factors $(j\omega)$
  \item Delay factor: $e^{\pm j\omega \tau}$;
  \item First-order factor $(1+j\omega\tau)$;
  \item Second-order factor 
    $(j\omega)^2+2\zeta\omega_n\omage j+\omega_n^2
    =(\omega_n^2-\omega^2)+j\,2\zeta\omega_n$
\end{itemize}
Given the Bode plot of any building block $H(j\omega)$, we can obtain the plots
of any combination of them.

We will first consider each of such components at a time, and then consider 
their combinations. In particular, we will study the first order system:
\[ H(j\omega)=\frac{N(j\omega)}{1+j\omega \tau} \]
and the second order system:
\[ H(j\omega)=\frac{N(j\omega)}{(j\omega)^2+2\zeta\omega_n j\omega +\omega_n^2}
=\frac{N(j\omega)}{(\omega_n^2-\omega^2)+j\;(2\zeta\omega_n \omega) }\]

\subsection*{Bode Plots of Components}

\begin{enumerate}
\item {\bf Constant gain $k$}

  \[ \left\{ \begin{array}{l}
    \mbox{If $k>0, \;\;\;\;k=|k|e^{j0}, \;\;Lm\;k=20 \;\log_{10}|k|,\;\;\angle k=0$} \\
    \mbox{If $k<0, \;\;\;\;k=-|k|=|k|e^{j\pi}, \;\;Lm\;k=20\;\log_{10}|k|,\;\;\angle k=\pi$} 
    \end{array} \right. \]

\item Delay factor: $e^{\pm j\omega \tau}$
  \[ Lm \;e^{ j\omega \tau}=20\;\log_{10} |e^{ j\omega \tau}|=20\;\log_{10} 1=0,\;\;\;\;
  \angle e^{ j\omega \tau} =\pm \omega \tau \]

\item {\bf Derivative factor $j\omega=\omega\; e^{j\pi/2}$:}
  \[ Lm\; (j\omega)=20\; log_{10} \omega\;dB,\;\;\;\;\;\angle(j\omega)=\frac{\pi}{2} \]
  In particular:
  \begin{itemize}
  \item When $\omega=1$, $Lm \;(1) =20\; \log_{10} 1=0\;dB$
  \item If a frequency $\omega$ becomes ten times higher, then
    \[ Lm\; (j10\omega)=20\; \log_{10} 10\omega=20 \;\log_{10} 10+20\;\log_{10}\omega 
    =20+Lm(j\omega) \]
    The Lm plot of $j\omega$ is a straight line with a slop of 20 dB/dec that goes
    through a zero-crossing at $\omega=1$.

  \end{itemize}

  Also consider two additional cases related to $j\omega$. First, 
  $(j\omega)^{\pm m}=\omega^{\pm m} e^{\pm j m\pi/2}$
  \[ Lm(j\omega)^{\pm m}=\pm m\;Lm(j\omega),\;\;\;\;\;\angle(j\omega)^{\pm m}=\pm m\pi/2\]
  The slop of the Lm plot is $\pm 20m/dec$. For example, when $m=2$, we have:
  \[ Lm\; (j\omega)^2=40\log_{10}\omega,\;\;\;\;\;\angle\;(j\omega)^2=\pi \]

  Second, the plots of $j\omega\tau$ are similar to those of $j\omega$, except the
  zero-crossing occurs at $\omega\tau=1$, i.e., $\omega=1/\tau$.

\item {\bf Integral factor $1/j\omega=(j\omega)^{-1}$:}

  \[ Lm \;(j\omega)^{-1}=-Lm\;(j\omega)=-20\;log_{10} \omega\;dB,
  \;\;\;\;\angle\; (j\omega)^{-1}=-\angle(j\omega)=-\frac{\pi}{2} \]
  The Lm plot of $1/j\omega$ is a straight line with a slop of -20 dB/dec that goes
  through a zero-crossing at $\omega=1$.

\item {\bf First order factor in numerator $1+j\omega\tau$}
  \[ 1+j\omega \tau=\sqrt{1+(\omega \tau)^2}\;e^{j\tan^{-1}(\omega \tau)}
  =\sqrt{1+(\omega \tau)^2}\;\angle \tan^{-1}(\omega \tau) \]
  \[ Lm(1+j\omega \tau)=20\;\log_{10}\sqrt{1+(\omega \tau)^2}
  =20\;\log_{10}(1+(\omega \tau)^2)^{1/2}=10\;\log_{10}(1+(\omega \tau)^2) \]
  \[ \angle(1+j\omega \tau)=\tan^{-1}(\omega\tau) \]
  Consider the following three cases:
  \begin{itemize}
  \item $\omega\tau=1$, i.e., $\omega_c=1/\tau$ is the corner frequency, we have
    \[ Lm(1+j)=20\;\log_{10} \sqrt{1^2+1^2}=20\;\log_{10} 0.707\approx 3.01\;dB,\;\;\;\;\;
    \angle(1+j)=\frac{\pi}{4} \]
  \item $\omega\tau \ll 1$ (e.g., $\omega\tau\le 10$):
    \[ Lm(1+j\omega \tau)\approx10\;\log_{10}(1)=0,\;\;\;\;\;
    \angle(1+j\omega \tau)\approx \angle(1)=0 \]
  \item $\omega\tau \gg 1$ (e.g., $\omega\tau\ge 10$):
    \[ Lm(1+j\omega \tau)\approx 20\;\log_{10}(\omega \tau),\;\;\;\;
    \angle(1+j\omega \tau)\approx \angle(j\omega \tau)=\frac{\pi}{2} \]
  \end{itemize}
  The straight-line asymptote of $Lm(1+j\omega\tau)$ has zero slope when $\omega\tau<1$
  but a slope 20 dB/dec when $\omage\tau>1$. The straight-line asymptote of 
  $\angle(1+j\omega\tau)$ is zero when $\omega\tay<0.1$, $\pi/2$ when $\omega\tau>10$, 
  but with a slope $45^\circ/dec$ in between.

\item {\bf First order factor in denominator $1/(1+j\omega\tau)=(1+j\omega\tau)^{-1}$}
  \[ Lm\;(1+j\omega\tau)^{-1}=-Lm(1+j\omega\tau)
  =-10\;\log_{10}(1+(\omega \tau)^2) \]
  \[ \angle\;(1+j\omega \tau)^{-1}=-\angle(1+j\omega \tau)
  =-\tan^{-1}(\omega\tau) \]
  Both the Lm and phase plots of $1/(1+j\omega\tau)$ is simply the negative 
  version of $(1+j\omega\tau)$. 

  The figure below shows the plots of two first order systems corner frequencies 
  $\omega_1=100$ and $\omega_2=1000$, together with the plots of their product, a 
  second order system.

\htmladdimg{../figures/bodeplot1storder.gif}

\item {\bf Second-order factor}

  \[ H(j\omega)=\frac{1}{(j\omega)^2+2\zeta\omega_n j\omega+\omega_n^2}
  =\frac{1}{(\omega^2_n-\omega^2)+2\zeta\omega_n j\omega}
  =\frac{\frac{1}{\omega_n^2}}{1-(\frac{\omega}{\omega_n})^2+j\,2\zeta\frac{\omega}{\omega_n}} \]
  The denominator is a 2nd order polynomial for variable $j\omega$. Consider the
  following two cases:

  First, if $\Delta=b^2-4ac=(2\zeta\omega_n)^2-4\omega_n^2=4\omega^2_n(\zeta^2-1)\ge 0$
  i.e., if $\zeta\ge 1$, the denominator has two real and negative roots:
  \[ p_{1,2}=(-\zeta\pm\sqrt{\zeta^2-1})\omega_n < 0 \]
  and $H(j\omega)$ can be written as a product of two first order FRFs:
  \[ H(j\omega)=\frac{1}{(j\omega-p_1)(j\omega-p_2)} 
  =\frac{1/p_1p_2}{(j\omega/p_1-1)(j\omega/p_2-1)} 
  =\frac{\tau_1}{1+j\omega\tau_1}\;\frac{\tau_2}{1+j\omega\tau_2}
  =H_1(j\omega)H_2(j\omega) \]
  where $\tau_1=-1/p_1>0$ and $\tau_2=-1/p_2>0$ are the two time constant of the two
  first order systems. Now the second order factor is the product of two first order 
  factors and
  \[ Lm\;(H_1 H_2)=Lm\; H_1+Lm\; H_2,\;\;\;\;\angle (H_1 H_2)=\angle H_1+\angle H_2 \]
  with corner frequencies at $\omega_{c1}=1/\tau_1=p_1$ and $\omega_{c1}=1/\tau_2=p_2$.

  Second, if $0<\zeta<1$, i.e., the two roots are complex. We consider the numerator 
  and the denominator separately. The numerator is just a constant with zero phase and
  log-magnitude of $20\log_{10} \omega_n^{-}2=-40\log_{10} \omega_n$. Next consider the
  rest of the function:
  \[ |H(j\omega)|=[(1-(\frac{\omega}{\omega_n})^2)^2+(2\zeta\frac{\omega}{\omega_n})^2]^{-1/2}\]
  We have
  \begin{eqnarray}
    && Lm\;H(j\omega)=20\log_{10} |H(j\omega)|
    =-10\;\log_{10}[\; (1-(\frac{\omega}{\omega_n})^2)^2+(2\zeta\frac{\omega}{\omega_n})^2\;]
    \nonumber 
  \end{eqnarray}
  \[ \angle H(j\omega)=-\tan^{-1}\frac{2\zeta\omega/\omega_n}{1-(\omega/\omega_n)^2} \]
  Consider three cases:
  \begin{itemize}
  \item $\omega/\omega_n=1$:
    Now $H(j\omega)=1/j2\zeta=-j/2\zeta$ and 
    \[ Lm\;H(j\omega)=-20\;\log_{10} 2\zeta,\;\;\;\;\;\angle H(j\omega)=-\frac{\pi}{2} \]
  \item $\omega/\omega_n\ll 1$, i.e., $\omega \ll \omega_n$:
    \[ Lm\;H(j\omega) \approx -10\;\log_{10} (1)=0,\;\;\;\;\;\angle H(j\omega)=0^\circ \]
  \item $\omega/\omega_n\gg 1$, i.e., $\omega \ll \omega_n$:
    \[ Lm\;H(j\omega)\approx-10\;\log_{10}[\; (\frac{\omega}{\omega_n})^4 ]
    =-40 \;\log_{10} \frac{\omega}{\omega_n}    \]
    This is a straight line with slop of -40 dB per decade.
    \[ \angle H(j\omega) \approx -\tan^{-1} (-2\zeta \omega_n/\omega)
    \approx -\tan^{-1} (-0)=-\pi=-180^\circ \]
  \end{itemize}

\end{enumerate}

\htmladdimg{../figures/bodeplotzeta.gif}

  The magnitude of the second-order factor is
  \[ |H(j\omega)|
  =\frac{1}{\sqrt{(1-\frac{\omega^2}{\omega_n^2})^2+4\zeta^2 \frac{\omega^2}{\omega_n^2}}}
  =\frac{1}{\sqrt{(1-u)^2+4\zeta^2 u}} \]
  where $u=(\omega/\omega_n)^2$. When $u=1$ i.e., $\omega=\omega_n$, we have
  \[ | H(j\omega_n) |=\frac{1}{2\zeta}=Q \]
  However, the peak of $|H(j\omega)|$ is not at $\omega_n$, but at the resonant frequency 
  $\omega_p$, which can be found by taking derivative of the magnitude of the denominator 
  with respect to $u$ and setting it to zero:
  \[ \frac{d}{du}[u^2+(4\zeta^2-2)u+1]=2u+4\zeta^2-2=0 \]
  Solving it, we get:
  \[ u=\frac{\omega^2}{\omega_n^2}=1-2\zeta^2,\;\;\;\mbox{i.e.,}
  \;\;\;\;\omega=\omega_n\sqrt{1-2\zeta^2} < \omega_n \]
  At this peak frequency $\omega_p=\omega_n\sqrt{1-2\zeta^2}$, the peak is:
  \[ | H(j\omega_p) |=\frac{1}{2\zeta\sqrt{1-\zeta^2}} > \frac{1}{2\zeta}=| H(j\omega_n) | \]
  Note that if $\zeta^2>1/2$, i.e., $\zeta>0.707$, the result is complex indicating there 
  is no peak.


\subsection*{Bode Plots of first and Second Order Systems}
{\bf First order circuits}

\htmladdimg{../figures/RC.gif}

\begin{itemize}
\item Voltage $V_C$ across C is treated as output. According to voltage
  divider rule, we have:
\[  H_C(j\omega)=\frac{V_C}{V_{in}}=\frac{Z_C}{Z_R+Z_C}
    =\frac{1/j\omega C}{R+1/j\omega C} 
    =\frac{1}{j\omega RC+1}=\frac{1}{j\omega \tau+1} \]
    where $\tau=RC$.
\item Voltage $V_R$ across R is treated as output:
  \[ H_R(j\omega)=\frac{V_R}{V_{in}}=\frac{Z_R}{Z_R+Z_C}
    =\frac{R}{R+1/j\omega C}=\frac{j\omega RC}{j\omega RC+1} 
    =\frac{j\omega \tau}{j\omega \tau+1} \]
\end{itemize}
As $H_R(j\omega)$ can be written as:
\[ H_R(j\omega)= \frac{1}{j\omega \tau+1} j\omega \tau  \]
The first term is just $H_C(j\omega)$. Now the log-magnitude is:
\[ Lm\;H_R(j\omega)
=20\log_{10} \left| \frac{1}{j\omega \tau+1}\right|+20\log_{10} \left| j\omega \tau \right| 
=Lm\; H_C(j\omega) +20\log_{10} (\omega\tau) \]
The first term is the same as $H_C(j\omega)$ and the second plot is a straight line
with slope of 20 dB/dec. at $\omega=\omega_c=1/\tau$, the first term is -3 dB and the  
second is 0 dB.  The phase plot is:
\[ \angle H_R(j\omega)=\angle \left(\frac{1}{j\omega \tau+1}\right)+\angle j\omega \tau  
=\angle H_C(j\omega)+\frac{\pi}{2} \]
In the plots below, $\tau=0.01$, $\omega_C=100$ rad/sec.

\htmladdimg{../figures/bodeplot1storder1.gif}

Define $\omega_c=1/\tau=1/RC$ as the cut-off frequency, then when $\omega=\omega_c$, 
we have $\omega\tau=1$, and $|H_R(j\omega)|=|H_C(j\omega)|=1/\sqrt{2}$, i.e., $\omega_c$
is the half-power point, where $|H(j\omega)|$ is -3 dB.

{\bf Second order circuits}

\htmladdimg{../figures/RCL.gif}

\begin{itemize}
\item Voltage $V_C$ across C is treated as output:
  \begin{eqnarray}
    H_C(j\omega)&=&\frac{V_C}{V_{in}}=\frac{Z_C}{Z_L+Z_R+Z_C}
    =\frac{1/j\omega C}{j\omega L+R+1/j\omega C}
    =\frac{1}{(j\omega)^2 LC+j\omega RC+1}
    \nonumber \\
    &=&\frac{1/LC}{(j\omega)^2 +j\omega R/L+1/LC}
    =\frac{\omega_n^2}{(j\omega)^2 +2\zeta\omega_n j\omega+\omega^2_n} 
    =\frac{1}{(1-\frac{\omega^2}{\omega_n^2})+j2\zeta\frac{\omega}{\omega_n}}
    \nonumber 
  \end{eqnarray}
  where 
  \[ \omega_n=\frac{1}{\sqrt{LC}},\;\;\;\;\zeta=\frac{R}{2}\sqrt{\frac{C}{L}} \]
  The magnitude is
  \[ |H_C(j\omega)|
  =\frac{1}{\sqrt{(1-\frac{\omega^2}{\omega_n^2})^2+4\zeta^2 \frac{\omega^2}{\omega_n^2}}}
  =\frac{1}{\sqrt{(1-u)^2+4\zeta^2 u}} \]
  where $u=(\omega/\omega_n)^2$. When $u=\omega/\omega_n=1$ or $\omega=\omega_n$, we have
  \[ | H(j\omega_n) |=\frac{1}{2\zeta}=Q \]
\item Voltage $V_R$ across R is treated as output:
  \begin{eqnarray}
    H_R(j\omega)&=&\frac{V_R}{V_{in}}=\frac{Z_R}{Z_L+Z_R+Z_C}
    =\frac{R}{j\omega L+R+1/j\omega C}
    =\frac{j\omega RC}{(j\omega)^2 LC+j\omega RC+1}
    \nonumber \\
    &=&\frac{j\omega R/L}{(j\omega)^2 +j\omega R/L+1/LC}
    =\frac{2\zeta\omega_nj\omega}{(j\omega)^2 +2\zeta\omega_n j\omega+\omega^2_n} 
    =H_C(j\omega) \;2\zeta \omega_n\;j \omega 
    \nonumber 
  \end{eqnarray}
  Now we have:
  \[ Lm\;H_R(j\omega)=Lm\; H_C(j\omega)+Lm\;(2\zeta\omega_n\;j\omega),\;\;\;\;
  \angle H_R(j\omega)=\angle H_C(j\omega)+\angle(2\zeta\omega_n\;j\omega) \]
  The log-magnitude of the second factor is a straight line with slope 20 dB/dec,
  and at $\omega=\omega_n$, its value is $20\log_{10} 2\zeta\omega_n^2$. The phase is 
  $90^\circ$ for all $\omega$.
  
  The denominator can be written as $R+j(\omega L-1/\omega C)$, which is minimized
  when the imaginary part is zero, i.e, $j\omega L=1/j\omega C$. In other words, when 
  $\omega=\omega_n=1/\sqrt{LC}$, $|H_R(j\omega)|$ reaches its peak value.
\item Voltage $V_L$ across L is treated as output:
  \begin{eqnarray}
    H_L(j\omega)&=&\frac{V_L}{V_{in}}=\frac{Z_L}{Z_L+Z_R+Z_C}
    =\frac{j\omega L}{j\omega L+R+1/j\omega C}
    =\frac{(j\omega)^2 LC}{(j\omega)^2 LC+j\omega RC+1}
    \nonumber \\
    &=&\frac{(j\omega)^2}{(j\omega)^2 +j\omega R/L+1/LC}
    =\frac{(j\omega)^2}{(j\omega)^2 +2\zeta\omega_n j\omega+\omega^2_n} 
    =H_C(j\omega) \;(j\omega_n)^2
    \nonumber 
  \end{eqnarray}
  Now we have:
  \[ Lm\;H_L(j\omega)=Lm\; H_C(j\omega)+Lm\;(j\omega)^2,\;\;\;\;
  \angle H_L(j\omega)=\angle H_C(j\omega)+\angle (j\omega)^2 \]
  The log-magnitude of the second factor is a straight line with slope 40 dB/dec,
  and at $\omega=\omega_n$, it's value is $20\log_{10} \omega_n^2$. The phase is
  $180^\circ$ for all $\omega$.
\end{itemize}

\htmladdimg{../figures/bodeplot2ndorderline.gif}

In the following plots, $\omega_n=100$ rad/sec and $\zeta=0.05$.
At $\omega=\omega_n$, $20\log_{10} (2\zeta\omega_n^2)=20\log_{10} 1000=60$ dB, and
$20\log_{10}(\omega_n^2)=20\log_{10} 10,000=80$ dB.

\htmladdimg{../figures/bodeplot2ndorder.gif}

{\bf Example, a Band-pass filter:}

\htmladdimg{../figures/opamp4b.gif}

\[ H(j\omega)=-\frac{Z_2(j\omega)}{Z_1(j\omega)}
=-\frac{R_2||1/j\omega C_2}{R_1+1/j\omega C_1}
=-\frac{R_2/(1+j\omega R_2C_2)}{(1+j\omega R_1C_1)/j\omega C_1}
=-\frac{j\omega \tau_3}{(1+j\omega \tau_1)(1+j\omega \tau_2)} \]
where $\tau_1=R_1C_1$, $\tau_2=R_2C_2$, $\tau_3=R_2C_1$.


\end{document}




\end{document}


	

	










