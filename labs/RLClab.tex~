
\documentstyle[12pt]{article}
\usepackage{html}
\begin{document}


\section*{Filter design and testing}

Read 
\htmladdnormallink{this page}{http://fourier.eng.hmc.edu/e84/lectures/ch3/node17.html}
to make sure you are prepared before carrying out the lab.

\begin{enumerate}

\item Consider the band-pass and band-stop filters shown below:

  \htmladdimg{../../lectures/figures/LC_R.png}
  
  Do the following for each of the filters:
  \begin{itemize}
  \item Find the two cut-off frequencies $\omega_1$ and $\omega_2$ at which
    $|H(\omega_{1,2})|=1/\sqrt{2}$ in terms of the three components $R$, $C$, 
    and $L$:
  \item Find the bandwidth (of the passing or stop band)
    $\Delta\omega=\omega_2-\omega_1$ in terms of the three components $R$, 
    $C$, and $L$.
  \item Generate the linear and Bode plots of $|H(\omega)|$ (no need for the 
    phase plots) in Matlab.
  \item Implement the filter with the available compoents R, L and C in the 
    lab so that $\omega_n\approx 6\;kHz$ and $\Delta\omega\approx 1\;kHz$. 
  \item Generate the linear and Bode plots of $|H(\omega)|$ of your circuit
    and compare with the simulation by Matlab. If there is any discrepancy,
    explain.
  \end{itemize}

  {\bf Solution:} 

  \begin{itemize}
\item The FRF of the first circuit is
  \[
  H_{LC}=\frac{Z_{LC}}{Z_{LC}+R}=\frac{\frac{j\omega L}{1-(\omega/\omega_n)^2}}{
    \frac{j\omega L}{1-(\omega/\omega_n)^2 } +R}
  =\frac{j\omega L}{j\omega L+R(1-(\omega/\omega_n)^2)}
  =\frac{1}{1-j\frac{(1-(\omega/\omega_n)^2)}{\omega L/R}}
  \]
  When $\omega=\omega_n$, $Z_{LC}=\infty$, no current goes through 
  $R$ and the voltage across it is zero the output voltage is the 
  same as the input voltage. Otherwise either $\omega>\omega_n$ or 
  $\omega<\omega_n$, $Z_{LC}$ is finite, the voltage across $R$ is 
  non-zero, the output voltage is reduced. This is a band-pass 
  filter:
  \[ 
  |H_{BP}|=\bigg|\frac{Z_C||Z_L}{R+Z_C||Z_L}\bigg|
  =\left\{\begin{array}{cc}0&\omega\rightarrow 0\\
  1&\omega=\omega_n\\ 0&\omega\rightarrow\infty\end{array}\right.
  \]

\item The FRF of the second circuit is
  \[
  H_R=\frac{R}{Z_{LC}+R}=\frac{R}{\frac{j\omega L}{1-(\omega/\omega_n)^2}+R}
  =\frac{1}{\frac{j\omega L/R}{1-(\omega/\omega_n)^2 }+1}
  \]
  when $\omega=\omega_n$, $Z_{LC}=\infty$, the LC parallel branch 
  is an open-circuit, the output voltage is zero. Otherwise either 
  $\omega>\omega_n$ or $\omega<\omega_n$, $Z_{LC}$ is finite, the
  voltage is non-zero. The circuit is a band-stop or band-block 
  filter:
  \[ 
  |H_{BS}|=\bigg|\frac{R}{R+Z_C||Z_L}\bigg|
  =\left\{\begin{array}{cc}1&\omega\rightarrow 0\\
  0&\omega=\omega_n\\ 1&\omega\rightarrow\infty\end{array}\right.
  \]

\end{itemize}
The bandwidth is defined as $\Delta\omega=\omega_2-\omega_1$, the
difference between the two cut-off frequencies $\omega_1<\omega_n$ 
and $\omega_2>\omega_n$ at which $|H|=1/\sqrt{2}$. For both filters,
the cut-off frequencies can be found by solving
\[
1-\left(\frac{\omega}{\omega_n}\right)^2 =\pm \frac{\omega L}{R}
\]
i.e., the two filters always have the same bandwidth.

\htmladdimg{../figures/BPBS.png}

  Choose $C=1\,\mu F$ and $L=2\,mH$ so that 
  $f_n=1/(2\pi\sqrt{LC})=6.016\,kHz$, choose $R=150\Omega$ so that
  $\Delta f=1/(2\pi RC)=1.06\,kHz$. 
  



\item Design an RLC series band-pass (BP) filter with the available components 
  in the lab so that the passing band is centered around 7.5 kHz and bandwidth
  is about 1.3 kHz. Derive its frequency response function (FRF) $H(\omega)$, 
  and use Matlab to generate a linear plot of its magnitude as a function of 
  frequency (up to 20 kHz), also make a Bode plot (from 0 to 100 kHz) using your
  own code. Feed 
  a sinusoidal signal $x(t)=\cos(2\pi ft)$ as the input to the filter and find the 
  gain at a set of discrete frequencies including the resonant frequency (e.g., $f=1, 
  2, 5, 7.5, 10, 20\; kHz$). Compare your results with your analysis and simulation.

  \begin{comment}
  {\bf Solution:} Use $C=0.1\,\mu F$, $L=4.7\,mH$ with internal resistance 
  $R_L=27\,\Omega$, and $R=10\,\Omega$, $\omega_n=1/\sqrt{LC}=4.6\times 10^4$,
  $Q=\omega_nL/(R+R_L)=5.86$, $\zeta=1/2Q=0.0853$, 
  $\Delta\,\omega=\omega_n/Q=7.87\times 10^3$, $f_n=\omega_n/2\pi=7.34\times 10^3$,
  $\Delta f=\Delta\omega/2\pi=7.34\;kHz$.
  \htmladdimg{../RLCfilterFig1.png}

  \end{comment}



\item Treat the same circuit as a low-pass (LP) filter (voltage across C as the output).
  Adjust $R$ properly so that $\zeta\ge 1/\sqrt{2}$, and the FRF does not peak. 
  Generate a linear and Bode plots of the magnitude of its FRF, same as what you did 
  before for the BP filter. Then feed a square wave signal as the input to the filter 
  and observe and describe the waveform of the output.


  \begin{comment}
  {\bf Solution:} Use $R=280\,\Omega$, $\zeta=(R_L+R)\sqrt{C/L}/2=0.708$
  \htmladdimg{../RLCfilterFig2.png}

  \end{comment}


\item Repeat the previous part when the same circuit is treated as a high-pass (HP) 
  filter (voltage across L as the output).

\item Build the band-pass and band-stop filters discussed in class 
  (example at the bottom of \htmladdnormallink{this page}{http://fourier.eng.hmc.edu/e84/lectures/ch3/node17.html}),
  using the same R, L and C in previous last two parts. Geernate the linear and Bode plots 
  as before. Feed a sinusoidal signal as the input to the filter and find the gain at a
  set of discrete frequencies (including the resonant frequency). Compare your results 
  with your analysis and simulation.

  \begin{comment}

  \htmladdimg{../RLCfilterFig3.png}
  \end{comment}


\end{enumerate}
\end{document}
  
